(function(a){var c=(function(o){var l={host:"",search:"",dataType:""};var n=o.host.toLowerCase();var m=n.indexOf(".test.")>-1||n.indexOf("my.csair.")>-1?"ec.test.csair.com":"b2c.csair.com";l.host=o.protocol+"//"+m;l.dataType=m===n?"json":"jsonp";l.search=decodeURI(location.search);return l})(a.location);var k=(function(l){if(!l){l={log:function(){}}}return function(m){l.log(m)}})(a.console);var b=(function(){var n={};var m=/^\s*|\s*$/g;var l=false;function o(){var q=document.cookie.split(";"),p=q.length,t,s,r;for(r=0;r<p;r++){t=q[r].split("=");s=t[0].replace(m,"");n[s]=t[1]}}return function(p,q){if(!l||q){o();l=true}return p&&n[p]}})();var j=(function(){if(!UI){throw"UI plugin required"}var p={USA:1,UnitedStates:1,Australia:1,NewZealand:1,Canada:1};var n={ITA:"ITA,ITA",IBE:"IBE|1A,IBE"};var l={};var m=UI.getCity;function q(s){if(!s){return""}var r=l[s];if(r){return r}var t=m(4,s);if(!t){return""}r=l[s]=t[7];return r}function o(t){var u=p;var r=t.length;var s;while(--r>=0){s=q(t[r]);if(u[s]){return"ITA"}}return"IBE"}return function(s,r){s(n.ITA)}})();var d=(function(){var o={en:1,zh:1},m={cn:"zh",gb:"en"};function l(p){if(p){if(o[p]){return p}p=m[p];if(p){return p}}}function n(r){var q=l(r);if(!q){var p=b("globalroute");if(p){q=l(p.split("_")[0])}}return q||"en"}return n})();var f=(function(){function p(q,r){if(r){if(window.open(q,r)!==null){return}}window.location.href=q}var o={IBE:function(r,t){var x=r.plan;var s=c.host+"/B2C40/modules/bookingnew/inter/flightSelectDirect.html?",z=[],q=x.trips,u=/(\d{4})(\d{2})(\d{2})/;switch(x.mode){case 0:z=["t=S","c1="+q[0][0],"c2="+q[0][1],"d1="+q[0][2].replace(u,"$1-$2-$3")];break;case 1:z=["t=R","c1="+q[0][0],"c2="+q[0][1],"d1="+q[0][2].replace(u,"$1-$2-$3"),"d2="+q[1][2].replace(u,"$1-$2-$3")];break;case 2:var y=[],w=q.length,v;for(v=0;v<w;v++){y[v]=q[v].join(":")}z=["t=M","fl="+y.join("|")];break;default:return false}z.push("at="+x.psg[0],"ct="+x.psg[1],"it="+x.psg[2]);if(x.preUrl){z.push("preUrl="+x.preUrl)}if(t){z.push("egs="+t)}p(s+z.join("&"),r.target)},ITA:(function(){return function(r,t,A){var x=r.plan;var s=c.host+"/ita/intl/"+(r.lang)+"/flights?",B=["flex=1","m="+x.mode,"p="+x.psg.join("")],q=x.trips,u;switch(x.mode){case 0:u="t="+q[0].join("-");break;case 1:u="t="+q[0].join("-")+"-"+q[1][2];break;case 2:var w=q.length,z=[],v;for(v=0;v<w;v++){z[v]=q[v].join("-")}u="t="+z.join(",");break;default:return false}B[3]=u;if(t){B.push("egs="+t)}var C=r.search;if(C){for(var y in C){if(C.hasOwnProperty(y)){B.push(y+"="+C[y])}}}p(s+B.join("&"),r.target)}})(),"1A":function(s,r,x){var v=s.plan;var w=v.trips,u=v.psg,q=v.mode===0?"1":"0",t={json:'{"depcity":"'+w[0][0]+'","arrcity":"'+w[0][1]+'","flightdate":"'+w[0][2]+(w[1]?w[1][2]:"")+'","adultnum":"'+u[0]+'","childnum":"'+u[1]+'","infantnum":"'+u[2]+'","cabinorder":"0","airline":"1","flytype":"0","international":"1","action":"0","segtype":"'+q+'","cache":"0","preUrl":"null","language":"'+s.lang+'"}'};$.ajax({url:c.host+"/B2C40/query/jaxb/inter1AQuery/query.ao",data:t,type:"POST",dataType:c.dataType,complete:function(A,y){var z=A&&A.responseJSON;if(z&&z.overSeaUrl){p(z.overSeaUrl,s.target);return}k(z);x&&x("jumping",false)}})}};var n=String.prototype.toLowerCase;var l=String.prototype.toUpperCase;function m(r,v,u){if(!r){throw {ex:"no engine"}}var t=l.call(r).split(",")[v===2?1:0].split("|");if(u){u=l.call(u);var q=t.length,s;while(--q>=0){s=t[q];if(s===u){return t[q+1]||""}}return""}return t[0]}return function(r,s){try{var u=m(r,s.plan.mode,s.current);var t=u&&o[u];if(!t){throw {step:"beforeJump",msg:"cannot find next site"}}s.callback&&s.callback("beforeJump",true);t(s,r,s.callback)}catch(q){k(q);s.callback&&s.callback(q.step,false)}}})();var i=(function(){var m={code:/^[A-Z]{3}$/,date:/^\d{8}$/};var n=(function(){var q=new Date();var p=[q.getFullYear(),("0"+(q.getMonth()+1)).slice(-2),("0"+q.getDate()).slice()].join("");q.setFullYear(q.getFullYear()+1);var o=[q.getFullYear(),("0"+(q.getMonth()+1)).slice(-2),("0"+q.getDate()).slice()].join("");return[p,o]})();var l={psg:function(r){if(!r||r.length<3){throw {ex:"lackPsgNums"}}var o=parseInt(r[0],10),q=parseInt(r[1],10),p=parseInt(r[2],10);if(o+q+p>9||2*o<q||o<p){throw {ex:"InvalidPsgNums"}}},city:function(p,o){if(p===o||!m.code.test(p)||!m.code.test(o)){throw {ex:"InvalidCityCode"}}},dates:function(s){var o=s.length,r=" ",q,p;for(q=0;q<o;q++){p=s[q][2];if(!p||!m.date.test(p)||p<n[0]||p>n[1]){throw {ex:"InvalidDate"}}if(r>p){throw {ex:"InvalidDates"}}r=p}}};return function(r){var u=r.trips,p=u.length,t,s,q,o;l.psg(r.psg);l.dates(u);switch(r.mode){case 0:if(p<1){throw {ex:"InvalidTripLength"}}t=u[0];l.city(t[0],t[1]);break;case 1:if(p<2){throw {ex:"InvalidTripLength"}}s=u[0],q=u[1];l.city(s[0],s[1]);l.city(q[0],q[1]);if(s[0]!==q[1]||s[1]!==q[0]){throw {ex:"InvalidRoundCityCode"}}break;case 2:if(p>5||p<2){throw {ex:"InvalidTripLength"}}o=u.length;while(--o>=0){t=u[o];l.city(t[0],t[1])}break;default:throw {ex:"InvalidTripMode"}}}})();function g(m){try{m.lang=d(m.lang);i(m.plan);j(function(n){if(n){f(n,m)}else{m.callback("getEngine",false)}},m)}catch(l){k(l);m.callback&&m.callback("validate",false)}}var e=a.define;if(e&&"function"===typeof e){e("switcher",[],function(){return g});a.switcher=g}else{var h;if(a.switcher){h=a.switcher}a.switcher=g;if(h){if(Object.prototype.toString.call(h)==="[object Array]"){g.apply(null,h)}else{g.call(null,h)}}}})(window);