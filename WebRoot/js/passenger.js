/*
 *
 * http://www.woothemes.com/flexslider/
 *
 * Copyright 2012 WooThemes
 * Free to use under the GPLv2 license.
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
 * Contributing author: Tyler Smith (@mbmufffin)
 */

/*
 * Poshy Tip jQuery plugin v1.2
 * http://vadikom.com/tools/poshy-tip-jquery-plugin-for-stylish-tooltips/
 * Copyright 2010-2013, Vasil Dinkov, http://vadikom.com/
 */

function SelectDateById(e,t,n,r){var i=document.getElementById(e);if(i==null)return!1;i.focus(),i.onclick!=null?i.onclick():i.click!=null?i.click():SelectDate(i,t,n,r)}function SelectDate(e,t,n,r,i){leftX=n==null?leftX:n,topY=r==null?topY:r,document.getElementById("ContainerPanel")==null&&InitContainerPanel();var s=new Date,o=s.getFullYear()-50,u=s.getFullYear()+50;cal=cal==null?new Calendar(o,u,i):cal,cal.DateMode=pickMode.second,t.indexOf("s")<0&&(cal.DateMode=pickMode.minute),t.indexOf("m")<0&&(cal.DateMode=pickMode.hour),t.indexOf("h")<0&&(cal.DateMode=pickMode.day),t.indexOf("d")<0&&(cal.DateMode=pickMode.month),t.indexOf("M")<0&&(cal.DateMode=pickMode.year),t.indexOf("y")<0&&(cal.DateMode=pickMode.second),cal.dateFormatStyleOld=cal.dateFormatStyle,cal.dateFormatStyle=t,cal.show(e)}function Calendar(e,t,n,r){this.beginYear=1950,this.endYear=2050,this.lang=0,this.dateFormatStyle="yyyy-MM-dd hh:mm:ss",e!=null&&t!=null&&(this.beginYear=e,this.endYear=t),n!=null&&(this.lang=n),r!=null&&(this.dateFormatStyle=r),this.dateControl=null,this.panel=this.getElementById("calendarPanel"),this.container=this.getElementById("ContainerPanel"),this.form=null,this.date=new Date,this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.day=this.date.getDate(),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.second=this.date.getSeconds(),this.colors={cur_word:"#FFFFFF",cur_bg:"#FFCCCC",sel_bg:"#7cbaec",sun_word:"#FF0000",sat_word:"#0000FF",td_word_light:"#333333",td_word_dark:"#CCCCCC",td_bg_out:"#fff",td_bg_over:"#7cbaec",tr_word:"#000",tr_bg:"#fff",input_border:"#098bc4",input_bg:"#EFEFEF"}}function InitContainerPanel(){var e='<div id="calendarPanel" style="position: absolute;display: none;z-index:9999; background-color: #FFFFFF;border: 1px solid #098bc4;width:185px;font-size:12px;"></div>';document.all&&(e+='<iframe style="position:absolute;z-index:2000;width:expression(this.previousSibling.offsetWidth);',e+="height:expression(this.previousSibling.offsetHeight);",e+="left:expression(this.previousSibling.offsetLeft);top:expression(this.previousSibling.offsetTop);",e+='display:expression(this.previousSibling.style.display);" scrolling="no" frameborder="no"></iframe>');var t=document.createElement("div");t.innerHTML=e,t.id="ContainerPanel",t.style.display="none",document.body.appendChild(t)}(function(e,t){function H(e){var t=e.length,n=w.type(e);return w.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function j(e){var t=B[e]={};return w.each(e.match(S)||[],function(e,n){t[n]=!0}),t}function q(e,n,r,i){if(w.acceptData(e)){var s,o,u=w.expando,a=e.nodeType,f=a?w.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||r!==t||"string"!=typeof n)return l||(l=a?e[u]=c.pop()||w.guid++:u),f[l]||(f[l]=a?{}:{toJSON:w.noop}),("object"==typeof n||"function"==typeof n)&&(i?f[l]=w.extend(f[l],n):f[l].data=w.extend(f[l].data,n)),o=f[l],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[w.camelCase(n)]=r),"string"==typeof n?(s=o[n],null==s&&(s=o[w.camelCase(n)])):s=o,s}}function R(e,t,n){if(w.acceptData(e)){var r,i,s=e.nodeType,o=s?w.cache:e,u=s?e[w.expando]:w.expando;if(o[u]){if(t&&(r=n?o[u]:o[u].data)){w.isArray(t)?t=t.concat(w.map(t,w.camelCase)):t in r?t=[t]:(t=w.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!z(r):!w.isEmptyObject(r))return}(n||(delete o[u].data,z(o[u])))&&(s?w.cleanData([e],!0):w.support.deleteExpando||o!=o.window?delete o[u]:o[u]=null)}}}function U(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(I,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:F.test(r)?w.parseJSON(r):r}catch(s){}w.data(e,n,r)}else r=t}return r}function z(e){var t;for(t in e)if(("data"!==t||!w.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function it(){return!0}function st(){return!1}function ot(){try{return o.activeElement}catch(e){}}function ct(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function ht(e,t,n){if(w.isFunction(t))return w.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return w.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ut.test(t))return w.filter(t,e,n);t=w.filter(t,e)}return w.grep(e,function(e){return w.inArray(e,t)>=0!==n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return w.nodeName(e,"table")&&w.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _t(e){return e.type=(null!==w.find.attr(e,"type"))+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)w._data(n,"globalEval",!t||w._data(t[r],"globalEval"))}function Ht(e,t){if(1===t.nodeType&&w.hasData(e)){var n,r,i,s=w._data(e),o=w._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)w.event.add(t,n,u[n][r])}o.data&&(o.data=w.extend({},o.data))}}function Bt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!w.support.noCloneEvent&&t[w.expando]){i=w._data(t);for(r in i.events)w.removeEvent(t,r,i.handle);t.removeAttribute(w.expando)}"script"===n&&t.text!==e.text?(_t(t).text=e.text,Dt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),w.support.html5Clone&&e.innerHTML&&!w.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&xt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;null!=(s=r[o]);o++)!n||w.nodeName(s,n)?u.push(s):w.merge(u,jt(s,n));return n===t||n&&w.nodeName(e,n)?w.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===w.css(e,"display")||!w.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=w._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(s[o]=w._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&"none"!==n||!i)&&w._data(r,"olddisplay",i?n:w.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=w.css(e,n+Zt[s],!0,i)),r?("content"===n&&(o-=w.css(e,"padding"+Zt[s],!0,i)),"margin"!==n&&(o-=w.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=w.css(e,"padding"+Zt[s],!0,i),"padding"!==n&&(o+=w.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Rt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Jt.test(i))return i;r=o&&(w.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=o,n=Qt[e];return n||(n=fn(e,t),"none"!==n&&n||(It=(It||w("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach()),Qt[e]=n),n}function fn(e,t){var n=w(t.createElement(e)).appendTo(t.body),r=w.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(w.isArray(t))w.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==w.type(t))r(e,t);else for(i in t)vn(e+"["+i+"]",t[i],n,r)}function _n(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(S)||[];if(w.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,n,r,i){function u(a){var f;return s[a]=!0,w.each(e[a]||[],function(e,a){var l=a(n,r,i);return"string"!=typeof l||o||s[l]?o?!(f=l):t:(n.dataTypes.unshift(l),u(l),!1)}),f}var s={},o=e===An;return u(n.dataTypes[0])||!s["*"]&&u("*")}function Pn(e,n){var r,i,s=w.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&w.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes;while("*"===f[0])f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}return o?(o!==f[0]&&f.unshift(o),r[o]):t}function Bn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=w.now()}function Zn(e,t,n){var r,i=(Gn[t]||[]).concat(Gn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function er(e,t,n){var r,i,s=0,o=Qn.length,u=w.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(tr(l,f.opts.specialEasing);o>s;s++)if(r=Qn[s].call(f,e,l,f.opts))return r;return w.map(l,Zn,f),w.isFunction(f.opts.start)&&f.opts.start.call(e,f),w.fx.timer(w.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(n in e)if(r=w.camelCase(n),i=t[r],s=e[n],w.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=w.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function nr(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&nn(e),p=w._data(e,"fxshow");n.queue||(u=w._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,w.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===w.css(e,"display")&&"none"===w.css(e,"float")&&(w.support.inlineBlockNeedsLayout&&"inline"!==an(e.nodeName)?c.zoom=1:c.display="inline-block")),n.overflow&&(c.overflow="hidden",w.support.shrinkWrapBlocks||f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],$n.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show"))continue;l[r]=p&&p[r]||w.style(e,r)}if(!w.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=w._data(e,"fxshow",{}),s&&(p.hidden=!h),h?w(e).show():f.done(function(){w(e).hide()}),f.done(function(){var t;w._removeData(e,"fxshow");for(t in l)w.style(e,t,l[t])});for(r in l)o=Zn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return w.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.location,o=e.document,u=o.documentElement,a=e.jQuery,f=e.$,l={},c=[],h="1.10.2",p=c.concat,d=c.push,v=c.slice,m=c.indexOf,g=l.toString,y=l.hasOwnProperty,b=h.trim,w=function(e,t){return new w.fn.init(e,t,r)},E=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,S=/\S+/g,x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,N=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,C=/^[\],:{}\s]*$/,k=/(?:^|:|,)(?:\s*\[)+/g,L=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,O=/^-ms-/,M=/-([\da-z])/gi,_=function(e,t){return t.toUpperCase()},D=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(P(),w.ready())},P=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",D,!1),e.removeEventListener("load",D,!1)):(o.detachEvent("onreadystatechange",D),e.detachEvent("onload",D))};w.fn=w.prototype={jquery:h,constructor:w,init:function(e,n,r){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof w?n[0]:n,w.merge(this,w.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),N.test(i[1])&&w.isPlainObject(n))for(i in n)w.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(s=o.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this))},selector:"",length:0,toArray:function(){return v.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return w.each(this,e,t)},ready:function(e){return w.ready.promise().done(e),this},slice:function(){return this.pushStack(v.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},w.fn.init.prototype=w.fn,w.extend=w.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||w.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(w.isPlainObject(r)||(n=w.isArray(r)))?(n?(n=!1,o=e&&w.isArray(e)?e:[]):o=e&&w.isPlainObject(e)?e:{},u[i]=w.extend(l,o,r)):r!==t&&(u[i]=r));return u},w.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===w&&(e.$=f),t&&e.jQuery===w&&(e.jQuery=a),w},isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){if(e===!0?!--w.readyWait:!w.isReady){if(!o.body)return setTimeout(w.ready);w.isReady=!0,e!==!0&&--w.readyWait>0||(n.resolveWith(o,[w]),w.fn.trigger&&w(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===w.type(e)},isArray:Array.isArray||function(e){return"array"===w.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[g.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==w.type(e)||e.nodeType||w.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(w.support.ownLast)for(n in e)return y.call(e,n);for(n in e);return n===t||y.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=N.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=w.buildFragment([e],t,i),i&&w(i).remove(),w.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=w.trim(n),n&&C.test(n.replace(L,"@").replace(A,"]").replace(k,"")))?Function("return "+n)():(w.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&w.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(O,"ms-").replace(M,_)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=H(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("﻿ ")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(x,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(H(Object(e))?w.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=H(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return p.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(s=e[n],n=e,e=s),w.isFunction(e)?(r=v.call(arguments,2),i=function(){return e.apply(n||this,r.concat(v.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===w.type(r)){s=!0;for(a in r)w.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,w.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),w.ready.promise=function(t){if(!n)if(n=w.Deferred(),"complete"===o.readyState)setTimeout(w.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",D,!1),e.addEventListener("load",D,!1);else{o.attachEvent("onreadystatechange",D),e.attachEvent("onload",D);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function s(){if(!w.isReady){try{r.doScroll("left")}catch(e){return setTimeout(s,50)}P(),w.ready()}}()}return n.promise(t)},w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),r=w(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,w;if((t?t.ownerDocument||t:E)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,w=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,w=l.join(",")}if(w)try{return H.apply(n,g.querySelectorAll(w)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=x++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=S+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=S+=null==x?1:Math.random()||.1;for(E&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}E&&(S=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),E&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return E&&(S=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(E.childNodes),E.childNodes),_[E.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:E,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(E,e)?-1:t===n||y(E,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===E?-1:a[i]===E?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[S,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),w.find=ot,w.expr=ot.selectors,w.expr[":"]=w.expr.pseudos,w.unique=ot.uniqueSort,w.text=ot.getText,w.isXMLDoc=ot.isXML,w.contains=ot.contains}(e);var B={};w.Callbacks=function(e){e="string"==typeof e?B[e]||j(e):w.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){for(r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;a&&s>o;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){w.each(t,function(t,n){var r=w.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&w.each(arguments,function(e,t){var r;while((r=w.inArray(t,a,r))>-1)a.splice(r,1),n&&(s>=r&&s--,o>=r&&o--)}),this},has:function(e){return e?w.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],s=0,this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return!a||i&&!f||(t=t||[],t=[e,t.slice?t.slice():t],n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},w.extend({Deferred:function(e){var t=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return w.Deferred(function(n){w.each(t,function(t,s){var o=s[0],u=w.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?w.extend(e,r):r}},i={};return r.pipe=r.then,w.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=v.call(arguments),r=n.length,i=1!==r||e&&w.isFunction(e.promise)?r:0,s=1===i?e:w.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?v.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&w.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),w.support=function(t){var n,r,s,u,a,f,l,c,h,p=o.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*")||[],r=p.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;u=o.createElement("select"),f=u.appendChild(o.createElement("option")),s=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==p.className,t.leadingWhitespace=3===p.firstChild.nodeType,t.tbody=!p.getElementsByTagName("tbody").length,t.htmlSerialize=!!p.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!s.value,t.optSelected=f.selected,t.enctype=!!o.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}s=o.createElement("input"),s.setAttribute("value",""),t.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),a=o.createDocumentFragment(),a.appendChild(s),t.appendChecked=s.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===p.style.backgroundClip;for(h in w(t))break;return t.ownLast="0"!==h,w(function(){var n,r,s,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=p.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&0===s[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",w.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===p.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(p,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(p,null)||{width:"4px"}).width,r=p.appendChild(o.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==p.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=s=r=null)}),n=u=a=f=r=s=null,t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;w.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?w.cache[e[w.expando]]:e[w.expando],!!e&&!z(e)},data:function(e,t,n){return q(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return q(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&w.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),w.fn.extend({data:function(e,n){var r,i,s=null,o=0,u=this[0];if(e===t){if(this.length&&(s=w.data(u),1===u.nodeType&&!w._data(u,"parsedAttrs"))){for(r=u.attributes;r.length>o;o++)i=r[o].name,0===i.indexOf("data-")&&(i=w.camelCase(i.slice(5)),U(u,i,s[i]));w._data(u,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){w.data(this,e)}):arguments.length>1?this.each(function(){w.data(this,e,n)}):u?U(u,e,w.data(u,e)):null},removeData:function(e){return this.each(function(){w.removeData(this,e)})}}),w.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=w._data(e,n),r&&(!i||w.isArray(r)?i=w._data(e,n,w.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),s=w._queueHooks(e,t),o=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return w._data(e,n)||w._data(e,n,{empty:w.Callbacks("once memory").add(function(){w._removeData(e,t+"queue"),w._removeData(e,n)})})}}),w.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?w.queue(this[0],e):n===t?this:this.each(function(){var t=w.queue(this,e,n);w._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},delay:function(e,t){return e=w.fx?w.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=w.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(u--)r=w._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var W,X,V=/[\t\r\n\f]/g,$=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,K=/^(?:a|area)$/i,Q=/^(?:checked|selected)$/i,G=w.support.getSetAttribute,Y=w.support.input;w.fn.extend({attr:function(e,t){return w.access(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})},prop:function(e,t){return w.access(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return e=w.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=w.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?w.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):w.isFunction(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,r=0,s=w(this),o=e.match(S)||[];while(t=o[r++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===i||"boolean"===n)&&(this.className&&w._data(this,"__className__",this.className),this.className=this.className||e===!1?"":w._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(V," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=w.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,w(this).val()):e,null==s?s="":"number"==typeof s?s+="":w.isArray(s)&&(s=w.map(s,function(e){return null==e?"":e+""})),r=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,s,"value")!==t||(this.value=s))});if(s)return r=w.valHooks[s.type]||w.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(w.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&w.nodeName(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=w.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=w.inArray(w(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,n,r){var s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?w.prop(e,n,r):(1===u&&w.isXMLDoc(e)||(n=n.toLowerCase(),s=w.attrHooks[n]||(w.expr.match.bool.test(n)?X:W)),r===t?s&&"get"in s&&null!==(o=s.get(e,n))?o:(o=w.find.attr(e,n),null==o?t:o):null!==r?s&&"set"in s&&(o=s.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):(w.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(S);if(s&&1===e.nodeType)while(n=s[i++])r=w.propFix[n]||n,w.expr.match.bool.test(n)?Y&&G||!Q.test(n)?e[r]=!1:e[w.camelCase("default-"+n)]=e[r]=!1:w.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!w.support.radioValue&&"radio"===t&&w.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!w.isXMLDoc(e),o&&(n=w.propFix[n]||n,s=w.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||K.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?w.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&w.propFix[n]||n,n):e[w.camelCase("default-"+n)]=e[n]=!0,n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,n){var r=w.expr.attrHandle[n]||w.find.attr;w.expr.attrHandle[n]=Y&&G||!Q.test(n)?function(e,n,i){var s=w.expr.attrHandle[n],o=i?t:(w.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return w.expr.attrHandle[n]=s,o}:function(e,n,r){return r?t:e[w.camelCase("default-"+n)]?n.toLowerCase():null}}),Y&&G||(w.attrHooks.value={set:function(e,n,r){return w.nodeName(e,"input")?(e.defaultValue=n,t):W&&W.set(e,n,r)}}),G||(W={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},w.expr.attrHandle.id=w.expr.attrHandle.name=w.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},w.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:W.set},w.attrHooks.contenteditable={set:function(e,t,n){W.set(e,""===t?!1:t,n)}},w.each(["width","height"],function(e,n){w.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),w.support.hrefNormalized||w.each(["href","src"],function(e,t){w.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),w.support.style||(w.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),w.support.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.support.enctype||(w.propFix.enctype="encoding"),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,n){return w.isArray(n)?e.checked=w.inArray(w(e).val(),n)>=0:t}},w.support.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;w.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=w._data(e);if(y){r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=w.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof w===i||e&&w.event.triggered===e.type?t:w.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(S)||[""],f=n.length;while(f--)u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort(),v&&(c=w.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=w.event.special[v]||{},p=w.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:m.join(".")},l),(d=a[v])||(d=a[v]=[],d.delegateCount=0,c.setup&&c.setup.call(e,s,m,h)!==!1||(e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h))),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),w.event.global[v]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=w.hasData(e)&&w._data(e);if(m&&(l=m.events)){t=(t||"").match(S)||[""],f=t.length;while(f--)if(u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=w.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],!i&&v!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||w.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[f],n,r,!0);w.isEmptyObject(l)&&(delete m.handle,w._removeData(e,"events"))}},trigger:function(n,r,i,s){var u,a,f,l,c,h,p,d=[i||o],v=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(f=h=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(v+w.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=0>v.indexOf(":")&&"on"+v,n=n[w.expando]?n:new w.Event(v,"object"==typeof n&&n),n.isTrigger=s?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:w.makeArray(r,[n]),c=w.event.special[v]||{},s||!c.trigger||c.trigger.apply(i,r)!==!1)){if(!s&&!c.noBubble&&!w.isWindow(i)){for(l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||o)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(w._data(f,"events")||{})[n.type]&&w._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&w.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();if(n.type=v,!s&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),r)===!1)&&w.acceptData(i)&&a&&i[v]&&!w.isWindow(i)){h=i[a],h&&(i[a]=null),w.event.triggered=v;try{i[v]()}catch(g){}w.event.triggered=t,h&&(i[a]=h)}return n.result}},dispatch:function(e){e=w.event.fix(e);var n,r,i,s,o,u=[],a=v.call(arguments),f=(w._data(this,"events")||{})[e.type]||[],l=w.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=w.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((w.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(f.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?w(r,this).index(f)>=0:w.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return n.length>a&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[w.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new w.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,u=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,s=i.documentElement,r=i.body,e.pageX=n.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||u===t||(e.which=1&u?1:2&u?3:4&u?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ot()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===ot()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return w.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?w.event.trigger(i,null,t):w.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},w.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},w.Event=function(e,n){return this instanceof w.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,n&&w.extend(this,n),this.timeStamp=e&&e.timeStamp||w.now(),this[w.expando]=!0,t):new w.Event(e,n)},w.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!w.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),w.support.submitBubbles||(w.event.special.submit={setup:function(){return w.nodeName(this,"form")?!1:(w.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=w.nodeName(n,"input")||w.nodeName(n,"button")?n.form:t;r&&!w._data(r,"submitBubbles")&&(w.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),w._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&w.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return w.nodeName(this,"form")?!1:(w.event.remove(this,"._submit"),t)}}),w.support.changeBubbles||(w.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(w.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),w.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),w.event.simulate("change",this,e,!0)})),!1):(w.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!w._data(t,"changeBubbles")&&(w.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||w.event.simulate("change",this.parentNode,e,!0)}),w._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return w.event.remove(this,"._change"),!Z.test(this.nodeName)}}),w.support.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){w.event.simulate(t,e.target,w.event.fix(e),!0)};w.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),w.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=st;else if(!i)return this;return 1===s&&(u=i,i=function(e){return w().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=w.guid++)),this.each(function(){w.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=st),this.each(function(){w.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?w.event.trigger(e,n,r,!0):t}});var ut=/^.[^:#\[\.,]*$/,at=/^(?:parents|prev(?:Until|All))/,ft=w.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;i>t;t++)if(w.contains(r[t],this))return!0}));for(t=0;i>t;t++)w.find(e,r[t],n);return n=this.pushStack(i>1?w.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=w(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(w.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e||[],!0))},filter:function(e){return this.pushStack(ht(this,e||[],!1))},is:function(e){return!!ht(this,"string"==typeof e&&ft.test(e)?w(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||"string"!=typeof e?w(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?w.unique(s):s)},index:function(e){return e?"string"==typeof e?w.inArray(this[0],w(e)):w.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?w(e,t):w.makeArray(e&&e.nodeType?[e]:e),r=w.merge(this.get(),n);return this.pushStack(w.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,n){return w.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,n){return w.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return w.dir(e,"previousSibling",n)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return w.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:w.merge([],e.childNodes)}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(lt[e]||(i=w.unique(i)),at.test(e)&&(i=i.reverse())),this.pushStack(i)}}),w.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],s=e[n];while(s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!w(s).is(r)))1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:w.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(o),Ot=At.appendChild(o.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,w.fn.extend({text:function(e){return w.access(this,function(e){return e===t?w.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?w.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||w.cleanData(jt(n)),n.parentNode&&(t&&w.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&w.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&w.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return w.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(vt,""):t;if(!("string"!=typeof e||St.test(e)||!w.support.htmlSerialize&&mt.test(e)||!w.support.leadingWhitespace&&gt.test(e)||Lt[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(yt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(w.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=w.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),w(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=p.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,d=e[0],v=w.isFunction(d);if(v||!(1>=l||"string"!=typeof d||w.support.checkClone)&&Tt.test(d))return this.each(function(r){var i=c.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(l&&(a=w.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=a.firstChild,1===a.childNodes.length&&(a=r),r)){for(o=w.map(jt(a,"script"),_t),s=o.length;l>f;f++)i=a,f!==h&&(i=w.clone(i,!0,!0),s&&w.merge(o,jt(i,"script"))),t.call(this[f],i,f);if(s)for(u=o[o.length-1].ownerDocument,w.map(o,Dt),f=0;s>f;f++)i=o[f],Nt.test(i.type||"")&&!w._data(i,"globalEval")&&w.contains(u,i)&&(i.src?w._evalUrl(i.src):w.globalEval((i.text||i.textContent||i.innerHTML||"").replace(kt,"")));a=r=null}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){var n,r=0,i=[],s=w(e),o=s.length-1;for(;o>=r;r++)n=r===o?this:this.clone(!0),w(s[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}}),w.extend({clone:function(e,t,n){var r,i,s,o,u,a=w.contains(e.ownerDocument,e);if(w.support.html5Clone||w.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild)),!(w.support.noCloneEvent&&w.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(r=jt(s),u=jt(e),o=0;null!=(i=u[o]);++o)r[o]&&Bt(i,r[o]);if(t)if(n)for(u=u||jt(e),r=r||jt(s),o=0;null!=(i=u[o]);o++)Ht(i,r[o]);else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;c>d;d++)if(s=e[d],s||0===s)if("object"===w.type(s))w.merge(p,s.nodeType?[s]:s);else if(Et.test(s)){u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;if(!w.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0])),!w.support.tbody){s="table"!==a||wt.test(s)?"<table>"!==l[1]||wt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)w.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}w.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}else p.push(t.createTextNode(s));u&&h.removeChild(u),w.support.appendChecked||w.grep(jt(p,"input"),Ft),d=0;while(s=p[d++])if((!r||-1===w.inArray(s,r))&&(o=w.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u),n)){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=w.expando,f=w.cache,l=w.support.deleteExpando,h=w.event.special;for(;null!=(n=e[u]);u++)if((t||w.acceptData(n))&&(s=n[a],o=s&&f[s])){if(o.events)for(r in o.events)h[r]?w.event.remove(n,r):w.removeEvent(n,r,o.handle);f[s]&&(delete f[s],l?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,c.push(s))}},_evalUrl:function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),w.fn.extend({wrapAll:function(e){if(w.isFunction(e))return this.each(function(t){w(this).wrapAll(e.call(this,t))});if(this[0]){var t=w(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return w.isFunction(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=w.isFunction(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=RegExp("^("+E+")(.*)$","i"),Jt=RegExp("^("+E+")(?!px)[a-z%]+$","i"),Kt=RegExp("^([+-])=("+E+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];w.fn.extend({css:function(e,n){return w.access(this,function(e,n,r){var i,s,o={},u=0;if(w.isArray(n)){for(s=qt(e),i=n.length;i>u;u++)o[n[u]]=w.css(e,n[u],!1,s);return o}return r!==t?w.style(e,n,r):w.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?w(this).show():w(this).hide()})}}),w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":w.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=w.camelCase(n),f=e.style;if(n=w.cssProps[a]||(w.cssProps[a]=tn(f,a)),u=w.cssHooks[n]||w.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(w.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||w.cssNumber[a]||(r+="px"),w.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=w.camelCase(n);return n=w.cssProps[a]||(w.cssProps[a]=tn(e.style,a)),u=w.cssHooks[n]||w.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),"normal"===o&&n in Yt&&(o=Yt[n]),""===r||r?(s=parseFloat(o),r===!0||w.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||w.contains(e.ownerDocument,e)||(a=w.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):o.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),w.each(["height","width"],function(e,n){w.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(w.css(e,"display"))?w.swap(e,Gt,function(){return un(e,n,i)}):un(e,n,i):t},set:function(e,t,r){var i=r&&qt(e);return sn(e,t,r?on(e,n,r,w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,i),i):0)}}}),w.support.opacity||(w.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=w.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===w.trim(s.replace(Ut,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i)}}),w(function(){w.support.reliableMarginRight||(w.cssHooks.marginRight={get:function(e,n){return n?w.swap(e,{display:"inline-block"},Rt,[e,"marginRight"]):t}}),!w.support.pixelPosition&&w.fn.position&&w.each(["top","left"],function(e,n){w.cssHooks[n]={get:function(e,r){return r?(r=Rt(e,n),Jt.test(r)?w(e).position()[n]+"px":r):t}}})}),w.expr&&w.expr.filters&&(w.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!w.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||w.css(e,"display"))},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(w.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:w.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),w.param=function(e,n){var r,i=[],s=function(e,t){t=w.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=w.ajaxSettings&&w.ajaxSettings.traditional),w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,gn,yn=w.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=w.fn.load,Ln={},An={},On="*/".concat("*");try{gn=s.href}catch(Mn){gn=o.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],w.fn.load=function(e,n,r){if("string"!=typeof e&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),w.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),u.length>0&&w.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,w.ajaxSettings),t):Pn(w.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;2!==b&&(b=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,r&&(E=Hn(c,x,r)),E=Bn(c,E,x,l),l?(c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(w.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(w.etag[s]=S)),204===e||"HEAD"===c.type?T="nocontent":304===e?T="notmodified":(T=E.state,g=E.data,y=E.error,l=!y)):(y=T,(e||!T)&&(T="error",0>e&&(e=0))),x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--w.active||w.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=w.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?w(h):w.event,d=w.Deferred(),v=w.Callbacks("once memory"),m=c.statusCode||{},g={},y={},b=0,E="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||E;return f&&f.abort(t),N(0,t),this}};if(d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=w.trim(c.dataType||"*").toLowerCase().match(S)||[""],null==c.crossDomain&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=w.param(c.data,c.traditional)),Dn(Ln,c,n,x),2===b)return x;a=c.global,a&&0===w.active++&&w.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(w.lastModified[s]&&x.setRequestHeader("If-Modified-Since",w.lastModified[s]),w.etag[s]&&x.setRequestHeader("If-None-Match",w.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&2!==b){E="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);if(f=Dn(An,c,n,x)){x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{b=1,f.send(g,N)}catch(T){if(!(2>b))throw T;N(-1,T)}}else N(-1,"No Transport");return x}return x.abort()},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,n){return w.get(e,t,n,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,r,i,s){return w.isFunction(r)&&(s=s||i,i=r,r=t),w.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),w.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||w("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||w.expando+"_"+yn++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=w.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||w.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&w.isFunction(o)&&o(u[0]),u=o=t}),"script"):t});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};w.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=w.ajaxSettings.xhr(),w.support.cors=!!qn&&"withCredentials"in qn,qn=w.support.ajax=!!qn,qn&&w.ajaxTransport(function(n){if(!n.crossDomain||w.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=w.noop,Un&&delete In[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?4===a.readyState?setTimeout(r):(o=++Rn,Un&&(In||(In={},w(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=RegExp("^(?:([+-])=|)("+E+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Jn.exec(t),s=i&&i[3]||(w.cssNumber[e]?"":"px"),o=(w.cssNumber[e]||"px"!==s&&+r)&&Jn.exec(w.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,w.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};w.Animation=w.extend(er,{tweener:function(e,t){w.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),w.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(w.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=w.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[w.cssProps[e.prop]]||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),s=w.speed(t,n,r),o=function(){var t=er(this,w.extend({},e),s);(i||w._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=w.timers,o=w._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&w.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=w._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=w.timers,o=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||w.isFunction(e)&&e,duration:e,easing:n&&t||t&&!w.isFunction(t)&&t};return r.duration=w.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in w.fx.speeds?w.fx.speeds[r.duration]:w.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){w.isFunction(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.timers=[],w.fx=rr.prototype.init,w.fx.tick=function(){var e,n=w.timers,r=0;for(Xn=w.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||w.fx.stop(),Xn=t},w.fx.timer=function(e){e()&&w.timers.push(e)&&w.fx.start()},w.fx.interval=13,w.fx.start=function(){Vn||(Vn=setInterval(w.fx.tick,w.fx.interval))},w.fx.stop=function(){clearInterval(Vn),Vn=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fx.step={},w.expr&&w.expr.filters&&(w.expr.filters.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length}),w.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){w.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(u)return n=u.documentElement,w.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},w.offset={setOffset:function(e,t,n){var r=w.css(e,"position");"static"===r&&(e.style.position="relative");var i=w(e),s=i.offset(),o=w.css(e,"top"),u=w.css(e,"left"),a=("absolute"===r||"fixed"===r)&&w.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),w.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(f.top=t.top-s.top+c),null!=t.left&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},w.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===w.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),w.nodeName(e[0],"html")||(n=e.offset()),n.top+=w.css(e[0],"borderTopWidth",!0),n.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-w.css(r,"marginTop",!0),left:t.left-n.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u;while(e&&!w.nodeName(e,"html")&&"static"===w.css(e,"position"))e=e.offsetParent;return e||u})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);w.fn[e]=function(i){return w.access(this,function(e,i,s){var o=sr(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?w(o).scrollLeft():s,r?s:w(o).scrollTop()):e[i]=s,t)},e,i,arguments.length,null)}}),w.each({Height:"height",Width:"width"},function(e,n){w.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){w.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return w.access(this,function(n,r,i){var s;return w.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?w.css(n,r,u):w.style(n,r,i,u)},n,o?i:t,o,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=w:(e.jQuery=e.$=w,"function"==typeof define&&define.amd&&define("jquery",[],function(){return w}))})(window),function(e){e.flexslider=function(t,n){var r=e(t),i=e.extend({},e.flexslider.defaults,n),s=i.namespace,o="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,u=o?"touchend":"click",a="vertical"===i.direction,f=i.reverse,l=0<i.itemWidth,c="fade"===i.animation,h=""!==i.asNavFor,p={};e.data(t,"flexslider",r),p={init:function(){r.animating=!1,r.currentSlide=i.startAt,r.animatingTo=r.currentSlide,r.atEnd=0===r.currentSlide||r.currentSlide===r.last,r.containerSelector=i.selector.substr(0,i.selector.search(" ")),r.slides=e(i.selector,r),r.container=e(r.containerSelector,r),r.count=r.slides.length,r.syncExists=0<e(i.sync).length,"slide"===i.animation&&(i.animation="swing"),r.prop=a?"top":"marginLeft",r.args={},r.manualPause=!1;var t=r,n;if(n=!i.video)if(n=!c)if(n=i.useCSS)e:{n=document.createElement("div");var s=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"],u;for(u in s)if(void 0!==n.style[s[u]]){r.pfx=s[u].replace("Perspective","").toLowerCase(),r.prop="-"+r.pfx+"-transform",n=!0;break e}n=!1}t.transitions=n,""!==i.controlsContainer&&(r.controlsContainer=0<e(i.controlsContainer).length&&e(i.controlsContainer)),""!==i.manualControls&&(r.manualControls=0<e(i.manualControls).length&&e(i.manualControls)),i.randomize&&(r.slides.sort(function(){return Math.round(Math.random())-.5}),r.container.empty().append(r.slides)),r.doMath(),h&&p.asNav.setup(),r.setup("init"),i.directionNav&&p.directionNav.setup(),i.controlNav&&p.controlNav.setup(),i.keyboard&&(1===e(r.containerSelector).length||i.multipleKeyboard)&&e(document).bind("keyup",function(e){e=e.keyCode,!r.animating&&(39===e||37===e)&&(e=39===e?r.getTarget("next"):37===e?r.getTarget("prev"):!1,r.flexAnimate(e,i.pauseOnAction))}),i.mousewheel&&r.bind("mousewheel",function(e,t){e.preventDefault();var n=0>t?r.getTarget("next"):r.getTarget("prev");r.flexAnimate(n,i.pauseOnAction)}),i.pausePlay&&p.pausePlay.setup(),i.slideshow&&(i.pauseOnHover&&r.hover(function(){!r.manualPlay&&!r.manualPause&&r.pause()},function(){!r.manualPause&&!r.manualPlay&&r.play()}),0<i.initDelay?setTimeout(r.play,i.initDelay):r.play()),o&&i.touch&&p.touch(),(!c||c&&i.smoothHeight)&&e(window).bind("resize focus",p.resize),setTimeout(function(){i.start(r)},200)},asNav:{setup:function(){r.asNav=!0,r.animatingTo=Math.floor(r.currentSlide/r.move),r.currentItem=r.currentSlide,r.slides.removeClass(s+"active-slide").eq(r.currentItem).addClass(s+"active-slide"),r.slides.click(function(t){t.preventDefault(),t=e(this);var n=t.index();!e(i.asNavFor).data("flexslider").animating&&!t.hasClass("active")&&(r.direction=r.currentItem<n?"next":"prev",r.flexAnimate(n,i.pauseOnAction,!1,!0,!0))})}},controlNav:{setup:function(){r.manualControls?p.controlNav.setupManual():p.controlNav.setupPaging()},setupPaging:function(){var t=1,n;r.controlNavScaffold=e('<ol class="'+s+"control-nav "+s+("thumbnails"===i.controlNav?"control-thumbs":"control-paging")+'"></ol>');if(1<r.pagingCount)for(var a=0;a<r.pagingCount;a++)n="thumbnails"===i.controlNav?'<img src="'+r.slides.eq(a).attr("data-thumb")+'"/>':"<a>"+t+"</a>",r.controlNavScaffold.append("<li>"+n+"</li>"),t++;r.controlsContainer?e(r.controlsContainer).append(r.controlNavScaffold):r.append(r.controlNavScaffold),p.controlNav.set(),p.controlNav.active(),r.controlNavScaffold.delegate("a, img",u,function(t){t.preventDefault(),t=e(this);var n=r.controlNav.index(t);t.hasClass(s+"active")||(r.direction=n>r.currentSlide?"next":"prev",r.flexAnimate(n,i.pauseOnAction))}),o&&r.controlNavScaffold.delegate("a","click touchstart",function(e){e.preventDefault()})},setupManual:function(){r.controlNav=r.manualControls,p.controlNav.active(),r.controlNav.live(u,function(t){t.preventDefault(),t=e(this);var n=r.controlNav.index(t);t.hasClass(s+"active")||(n>r.currentSlide?r.direction="next":r.direction="prev",r.flexAnimate(n,i.pauseOnAction))}),o&&r.controlNav.live("click touchstart",function(e){e.preventDefault()})},set:function(){r.controlNav=e("."+s+"control-nav li "+("thumbnails"===i.controlNav?"img":"a"),r.controlsContainer?r.controlsContainer:r)},active:function(){r.controlNav.removeClass(s+"active").eq(r.animatingTo).addClass(s+"active")},update:function(t,n){1<r.pagingCount&&"add"===t?r.controlNavScaffold.append(e("<li><a>"+r.count+"</a></li>")):1===r.pagingCount?r.controlNavScaffold.find("li").remove():r.controlNav.eq(n).closest("li").remove(),p.controlNav.set(),1<r.pagingCount&&r.pagingCount!==r.controlNav.length?r.update(n,t):p.controlNav.active()}},directionNav:{setup:function(){var t=e('<ul class="'+s+'direction-nav"><li><a class="'+s+'prev" href="#">'+i.prevText+'</a></li><li><a class="'+s+'next" href="#">'+i.nextText+"</a></li></ul>");r.controlsContainer?(e(r.controlsContainer).append(t),r.directionNav=e("."+s+"direction-nav li a",r.controlsContainer)):(r.append(t),r.directionNav=e("."+s+"direction-nav li a",r)),p.directionNav.update(),r.directionNav.bind(u,function(t){t.preventDefault(),t=e(this).hasClass(s+"next")?r.getTarget("next"):r.getTarget("prev"),r.flexAnimate(t,i.pauseOnAction)}),o&&r.directionNav.bind("click touchstart",function(e){e.preventDefault()})},update:function(){var e=s+"disabled";1===r.pagingCount?r.directionNav.addClass(e):i.animationLoop?r.directionNav.removeClass(e):0===r.animatingTo?r.directionNav.removeClass(e).filter("."+s+"prev").addClass(e):r.animatingTo===r.last?r.directionNav.removeClass(e).filter("."+s+"next").addClass(e):r.directionNav.removeClass(e)}},pausePlay:{setup:function(){var t=e('<div class="'+s+'pauseplay"><a></a></div>');r.controlsContainer?(r.controlsContainer.append(t),r.pausePlay=e("."+s+"pauseplay a",r.controlsContainer)):(r.append(t),r.pausePlay=e("."+s+"pauseplay a",r)),p.pausePlay.update(i.slideshow?s+"pause":s+"play"),r.pausePlay.bind(u,function(t){t.preventDefault(),e(this).hasClass(s+"pause")?(r.manualPause=!0,r.manualPlay=!1,r.pause()):(r.manualPause=!1,r.manualPlay=!0,r.play())}),o&&r.pausePlay.bind("click touchstart",function(e){e.preventDefault()})},update:function(e){"play"===e?r.pausePlay.removeClass(s+"pause").addClass(s+"play").text(i.playText):r.pausePlay.removeClass(s+"play").addClass(s+"pause").text(i.pauseText)}},touch:function(){function e(e){p=a?s-e.touches[0].pageY:s-e.touches[0].pageX,v=a?Math.abs(p)<Math.abs(e.touches[0].pageX-o):Math.abs(p)<Math.abs(e.touches[0].pageY-o);if(!v||500<Number(new Date)-d)e.preventDefault(),!c&&r.transitions&&(i.animationLoop||(p/=0===r.currentSlide&&0>p||r.currentSlide===r.last&&0<p?Math.abs(p)/h+2:1),r.setProps(u+p,"setTouch"))}function n(){t.removeEventListener("touchmove",e,!1);if(r.animatingTo===r.currentSlide&&!v&&null!==p){var a=f?-p:p,l=0<a?r.getTarget("next"):r.getTarget("prev");r.canAdvance(l)&&(550>Number(new Date)-d&&50<Math.abs(a)||Math.abs(a)>h/2)?r.flexAnimate(l,i.pauseOnAction):c||r.flexAnimate(r.currentSlide,i.pauseOnAction,!0)}t.removeEventListener("touchend",n,!1),u=p=o=s=null}var s,o,u,h,p,d,v=!1;t.addEventListener("touchstart",function(c){r.animating?c.preventDefault():1===c.touches.length&&(r.pause(),h=a?r.h:r.w,d=Number(new Date),u=l&&f&&r.animatingTo===r.last?0:l&&f?r.limit-(r.itemW+i.itemMargin)*r.move*r.animatingTo:l&&r.currentSlide===r.last?r.limit:l?(r.itemW+i.itemMargin)*r.move*r.currentSlide:f?(r.last-r.currentSlide+r.cloneOffset)*h:(r.currentSlide+r.cloneOffset)*h,s=a?c.touches[0].pageY:c.touches[0].pageX,o=a?c.touches[0].pageX:c.touches[0].pageY,t.addEventListener("touchmove",e,!1),t.addEventListener("touchend",n,!1))},!1)},resize:function(){!r.animating&&r.is(":visible")&&(l||r.doMath(),c?p.smoothHeight():l?(r.slides.width(r.computedW),r.update(r.pagingCount),r.setProps()):a?(r.viewport.height(r.h),r.setProps(r.h,"setTotal")):(i.smoothHeight&&p.smoothHeight(),r.newSlides.width(r.computedW),r.setProps(r.computedW,"setTotal")))},smoothHeight:function(e){if(!a||c){var t=c?r:r.viewport;e?t.animate({height:r.slides.eq(r.animatingTo).height()},e):t.height(r.slides.eq(r.animatingTo).height())}},sync:function(t){var n=e(i.sync).data("flexslider"),s=r.animatingTo;switch(t){case"animate":n.flexAnimate(s,i.pauseOnAction,!1,!0);break;case"play":!n.playing&&!n.asNav&&n.play();break;case"pause":n.pause()}}},r.flexAnimate=function(t,n,u,v,g){h&&1===r.pagingCount&&(r.direction=r.currentItem<t?"next":"prev");if(!r.animating&&(r.canAdvance(t,g)||u)&&r.is(":visible")){if(h&&v){if(u=e(i.asNavFor).data("flexslider"),r.atEnd=0===t||t===r.count-1,u.flexAnimate(t,!0,!1,!0,g),r.direction=r.currentItem<t?"next":"prev",u.direction=r.direction,Math.ceil((t+1)/r.visible)-1===r.currentSlide||0===t)return r.currentItem=t,r.slides.removeClass(s+"active-slide").eq(t).addClass(s+"active-slide"),!1;r.currentItem=t,r.slides.removeClass(s+"active-slide").eq(t).addClass(s+"active-slide"),t=Math.floor(t/r.visible)}r.animating=!0,r.animatingTo=t,i.before(r),n&&r.pause(),r.syncExists&&!g&&p.sync("animate"),i.controlNav&&p.controlNav.active(),l||r.slides.removeClass(s+"active-slide").eq(t).addClass(s+"active-slide"),r.atEnd=0===t||t===r.last,i.directionNav&&p.directionNav.update(),t===r.last&&(i.end(r),i.animationLoop||r.pause());if(c)o?(r.slides.eq(r.currentSlide).css({opacity:0,zIndex:1}),r.slides.eq(t).css({opacity:1,zIndex:2}),r.slides.unbind("webkitTransitionEnd transitionend"),r.slides.eq(r.currentSlide).bind("webkitTransitionEnd transitionend",function(){i.after(r)}),r.animating=!1,r.currentSlide=r.animatingTo):(r.slides.eq(r.currentSlide).fadeOut(i.animationSpeed,i.easing),r.slides.eq(t).fadeIn(i.animationSpeed,i.easing,r.wrapup));else{var y=a?r.slides.filter(":first").height():r.computedW;l?(t=i.itemWidth>r.w?2*i.itemMargin:i.itemMargin,t=(r.itemW+t)*r.move*r.animatingTo,t=t>r.limit&&1!==r.visible?r.limit:t):t=0===r.currentSlide&&t===r.count-1&&i.animationLoop&&"next"!==r.direction?f?(r.count+r.cloneOffset)*y:0:r.currentSlide===r.last&&0===t&&i.animationLoop&&"prev"!==r.direction?f?0:(r.count+1)*y:f?(r.count-1-t+r.cloneOffset)*y:(t+r.cloneOffset)*y,r.setProps(t,"",i.animationSpeed);if(r.transitions){if(!i.animationLoop||!r.atEnd)r.animating=!1,r.currentSlide=r.animatingTo;r.container.unbind("webkitTransitionEnd transitionend"),r.container.bind("webkitTransitionEnd transitionend",function(){r.wrapup(y)})}else r.container.animate(r.args,i.animationSpeed,i.easing,function(){r.wrapup(y)})}i.smoothHeight&&p.smoothHeight(i.animationSpeed)}},r.wrapup=function(e){!c&&!l&&(0===r.currentSlide&&r.animatingTo===r.last&&i.animationLoop?r.setProps(e,"jumpEnd"):r.currentSlide===r.last&&0===r.animatingTo&&i.animationLoop&&r.setProps(e,"jumpStart")),r.animating=!1,r.currentSlide=r.animatingTo,i.after(r)},r.animateSlides=function(){r.animating||r.flexAnimate(r.getTarget("next"))},r.pause=function(){clearInterval(r.animatedSlides),r.playing=!1,i.pausePlay&&p.pausePlay.update("play"),r.syncExists&&p.sync("pause")},r.play=function(){r.animatedSlides=setInterval(r.animateSlides,i.slideshowSpeed),r.playing=!0,i.pausePlay&&p.pausePlay.update("pause"),r.syncExists&&p.sync("play")},r.canAdvance=function(e,t){var n=h?r.pagingCount-1:r.last;return t?!0:h&&r.currentItem===r.count-1&&0===e&&"prev"===r.direction?!0:h&&0===r.currentItem&&e===r.pagingCount-1&&"next"!==r.direction?!1:e===r.currentSlide&&!h?!1:i.animationLoop?!0:r.atEnd&&0===r.currentSlide&&e===n&&"next"!==r.direction?!1:r.atEnd&&r.currentSlide===n&&0===e&&"next"===r.direction?!1:!0},r.getTarget=function(e){return r.direction=e,"next"===e?r.currentSlide===r.last?0:r.currentSlide+1:0===r.currentSlide?r.last:r.currentSlide-1},r.setProps=function(e,t,n){var s,o=e?e:(r.itemW+i.itemMargin)*r.move*r.animatingTo;s=-1*function(){if(l)return"setTouch"===t?e:f&&r.animatingTo===r.last?0:f?r.limit-(r.itemW+i.itemMargin)*r.move*r.animatingTo:r.animatingTo===r.last?r.limit:o;switch(t){case"setTotal":return f?(r.count-1-r.currentSlide+r.cloneOffset)*e:(r.currentSlide+r.cloneOffset)*e;case"setTouch":return e;case"jumpEnd":return f?e:r.count*e;case"jumpStart":return f?r.count*e:e;default:return e}}()+"px",r.transitions&&(s=a?"translate3d(0,"+s+",0)":"translate3d("+s+",0,0)",n=void 0!==n?n/1e3+"s":"0s",r.container.css("-"+r.pfx+"-transition-duration",n)),r.args[r.prop]=s,(r.transitions||void 0===n)&&r.container.css(r.args)},r.setup=function(t){if(c)r.slides.css({width:"100%","float":"left",marginRight:"-100%",position:"relative"}),"init"===t&&(o?r.slides.css({opacity:0,display:"block",webkitTransition:"opacity "+i.animationSpeed/1e3+"s ease",zIndex:1}).eq(r.currentSlide).css({opacity:1,zIndex:2}):r.slides.eq(r.currentSlide).fadeIn(i.animationSpeed,i.easing)),i.smoothHeight&&p.smoothHeight();else{var n,u;"init"===t&&(r.viewport=e('<div class="'+s+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(r).append(r.container),r.cloneCount=0,r.cloneOffset=0,f&&(u=e.makeArray(r.slides).reverse(),r.slides=e(u),r.container.empty().append(r.slides))),i.animationLoop&&!l&&(r.cloneCount=2,r.cloneOffset=1,"init"!==t&&r.container.find(".clone").remove(),r.container.append(r.slides.first().clone().addClass("clone")).prepend(r.slides.last().clone().addClass("clone"))),r.newSlides=e(i.selector,r),n=f?r.count-1-r.currentSlide+r.cloneOffset:r.currentSlide+r.cloneOffset,a&&!l?(r.container.height(200*(r.count+r.cloneCount)+"%").css("position","absolute").width("100%"),setTimeout(function(){r.newSlides.css({display:"block"}),r.doMath(),r.viewport.height(r.h),r.setProps(n*r.h,"init")},"init"===t?100:0)):(r.container.width(200*(r.count+r.cloneCount)+"%"),r.setProps(n*r.computedW,"init"),setTimeout(function(){r.doMath(),r.newSlides.css({width:r.computedW,"float":"left",display:"block"}),i.smoothHeight&&p.smoothHeight()},"init"===t?100:0))}l||r.slides.removeClass(s+"active-slide").eq(r.currentSlide).addClass(s+"active-slide")},r.doMath=function(){var e=r.slides.first(),t=i.itemMargin,n=i.minItems,s=i.maxItems;r.w=r.width(),r.h=e.height(),r.boxPadding=e.outerWidth()-e.width(),l?(r.itemT=i.itemWidth+t,r.minW=n?n*r.itemT:r.w,r.maxW=s?s*r.itemT:r.w,r.itemW=r.minW>r.w?(r.w-t*n)/n:r.maxW<r.w?(r.w-t*s)/s:i.itemWidth>r.w?r.w:i.itemWidth,r.visible=Math.floor(r.w/(r.itemW+t)),r.move=0<i.move&&i.move<r.visible?i.move:r.visible,r.pagingCount=Math.ceil((r.count-r.visible)/r.move+1),r.last=r.pagingCount-1,r.limit=1===r.pagingCount?0:i.itemWidth>r.w?(r.itemW+2*t)*r.count-r.w-t:(r.itemW+t)*r.count-r.w-t):(r.itemW=r.w,r.pagingCount=r.count,r.last=r.count-1),r.computedW=r.itemW-r.boxPadding},r.update=function(e,t){r.doMath(),l||(e<r.currentSlide?r.currentSlide+=1:e<=r.currentSlide&&0!==e&&(r.currentSlide-=1),r.animatingTo=r.currentSlide);if(i.controlNav&&!r.manualControls)if("add"===t&&!l||r.pagingCount>r.controlNav.length)p.controlNav.update("add");else if("remove"===t&&!l||r.pagingCount<r.controlNav.length)l&&r.currentSlide>r.last&&(r.currentSlide-=1,r.animatingTo-=1),p.controlNav.update("remove",r.last);i.directionNav&&p.directionNav.update()},r.addSlide=function(t,n){var s=e(t);r.count+=1,r.last=r.count-1,a&&f?void 0!==n?r.slides.eq(r.count-n).after(s):r.container.prepend(s):void 0!==n?r.slides.eq(n).before(s):r.container.append(s),r.update(n,"add"),r.slides=e(i.selector+":not(.clone)",r),r.setup(),i.added(r)},r.removeSlide=function(t){var n=isNaN(t)?r.slides.index(e(t)):t;r.count-=1,r.last=r.count-1,isNaN(t)?e(t,r.slides).remove():a&&f?r.slides.eq(r.last).remove():r.slides.eq(t).remove(),r.doMath(),r.update(n,"remove"),r.slides=e(i.selector+":not(.clone)",r),r.setup(),i.removed(r)},p.init()},e.flexslider.defaults={namespace:"flex-",selector:".slides > li",animation:"fade",easing:"swing",direction:"horizontal",reverse:!1,animationLoop:!0,smoothHeight:!1,startAt:0,slideshow:!0,slideshowSpeed:7e3,animationSpeed:600,initDelay:0,randomize:!1,pauseOnAction:!0,pauseOnHover:!1,useCSS:!0,touch:!0,video:!1,controlNav:!0,directionNav:!0,prevText:"Previous",nextText:"Next",keyboard:!0,multipleKeyboard:!1,mousewheel:!1,pausePlay:!1,pauseText:"Pause",playText:"Play",controlsContainer:"",manualControls:"",sync:"",asNavFor:"",itemWidth:0,itemMargin:0,minItems:0,maxItems:0,move:0,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){}},e.fn.flexslider=function(t){void 0===t&&(t={});if("object"==typeof t)return this.each(function(){var n=e(this),r=n.find(t.selector?t.selector:".slides > li");1===r.length?(r.fadeIn(400),t.start&&t.start(n)):void 0==n.data("flexslider")&&new e.flexslider(this,t)});var n=e(this).data("flexslider");switch(t){case"play":n.play();break;case"pause":n.pause();break;case"next":n.flexAnimate(n.getTarget("next"),!0);break;case"prev":case"previous":n.flexAnimate(n.getTarget("prev"),!0);break;default:"number"==typeof t&&n.flexAnimate(t,!0)}}}(jQuery),typeof JSON!="object"&&(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;typeof JSON.stringify!="function"&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){function o(){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},t=/&(?!#?\w+;)|<|>|"|'|\//g;return function(){return this?this.replace(t,function(t){return e[t]||t}):this}}function p(e,t,n){return(typeof t=="string"?t:t.toString()).replace(e.define||i,function(t,r,i,s){return r.indexOf("def.")===0&&(r=r.substring(4)),r in n||(i===":"?(e.defineParams&&s.replace(e.defineParams,function(e,t,i){n[r]={arg:t,text:i}}),r in n||(n[r]=s)):(new Function("def","def['"+r+"']="+s))(n)),""}).replace(e.use||i,function(t,r){e.useParams&&(r=r.replace(e.useParams,function(e,t,r,i){if(n[r]&&n[r].arg&&i)return e=(r+":"+i).replace(/'|\\/g,"_"),n.__exp=n.__exp||{},n.__exp[e]=n[r].text.replace(RegExp("(^|[^\\w$])"+n[r].arg+"([^\\w$])","g"),"$1"+i+"$2"),t+"def.__exp['"+e+"']"}));var i=(new Function("def","return "+r))(n);return i?p(e,i,n):i})}function m(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var j={version:"1.0.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1},template:undefined,compile:undefined},q;typeof module!="undefined"&&module.exports?module.exports=j:typeof define=="function"&&define.amd?define("doT",[],function(){return j}):(q=function(){return this||(0,eval)("this")}(),q.doT=j),String.prototype.encodeHTML=o();var r={append:{start:"'+(",end:")+'",endencode:"||'').toString().encodeHTML()+'"},split:{start:"';out+=(",end:");out+='",endencode:"||'').toString().encodeHTML();out+='"}},i=/$^/;j.template=function(e,t,n){t=t||j.templateSettings;var s=t.append?r.append:r.split,u,a=0,f;e=t.use||t.define?p(t,e,n||{}):e,e=("var out='"+(t.strip?e.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):e).replace(/'|\\/g,"\\$&").replace(t.interpolate||i,function(e,t){return s.start+m(t)+s.end}).replace(t.encode||i,function(e,t){return u=!0,s.start+m(t)+s.endencode}).replace(t.conditional||i,function(e,t,n){return t?n?"';}else if("+m(n)+"){out+='":"';}else{out+='":n?"';if("+m(n)+"){out+='":"';}out+='"}).replace(t.iterate||i,function(e,t,n,r){return t?(a+=1,f=r||"i"+a,t=m(t),"';var arr"+a+"="+t+";if(arr"+a+"){var "+n+","+f+"=-1,l"+a+"=arr"+a+".length-1;while("+f+"<l"+a+"){"+n+"=arr"+a+"["+f+"+=1];out+='"):"';} } out+='"}).replace(t.evaluate||i,function(e,t){return"';"+m(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|\}|^|\{)out\+=''\+/g,"$1out+="),u&&t.selfcontained&&(e="String.prototype.encodeHTML=("+o.toString()+"());"+e);try{return new Function(t.varname,e)}catch(l){throw typeof console!="undefined"&&console.log("Could not create a template function: "+e),l}},j.compile=function(e,t){return j.template(e,null,t)},window.doT=j}(),define("psgTpl",["doT","lang"],function(e,t){var n=t.passenger,r=t.flight,i={trip_summary:e.template('<div class="singleFlightBox"><div class="flight-name">{{? it.tripName}}{{=it.tripName}}{{?}}</div><div class="flight-summary"><table width="100%"><tr><td width="40%"><span class="flight-city">{{=it.firstflight.depportname}}<span class="marginLeft">{{=it.firstflight.deptime}}</span></span><span class="flight-date">{{=it.firstflight.depdate}}</span></td><td class="flight-code" width="10%"><span>{{=it.firstflight.flightno}}</span></td><td width="40%"><span class="flight-city">{{=it.firstflight.arrportname}}<span class="marginLeft">{{=it.firstflight.arrtime}}</span></span><span class="flight-date">{{=it.firstflight.arrdate}}</span></td><td width="10%"><span>{{=it.firstflight.cabinname}} '+n.psg528+'</span></td></tr>{{? it.secondflight }}<tr><td><span class="flight-city">{{=it.secondflight.depportname}}<span class="marginLeft">{{=it.secondflight.deptime}}</span></span><span class="flight-date">{{=it.secondflight.depdate}}</span></td><td class="flight-code"><span>{{=it.secondflight.flightno}}</span></td><td><span class="flight-city">{{=it.secondflight.arrportname}}<span class="marginLeft">{{=it.secondflight.arrtime}}</span></span><span class="flight-date">{{=it.secondflight.arrdate}}</span></td></tr>{{?}}</table></div></div>{{?(it.firstflight.rule.isN && it.sandsflag == 1) || !it.firstflight.rule.isN}}<div class="flight-rule {{?it.firstflight.rule.isN}}isN{{?}}"><a href="#" class="rule-tip" data-type="rule" data-sign="{{=it.firstflight.rule.sign}}" data-refund="{{=it.firstflight.rule.refundbefore}}|{{=it.firstflight.rule.refundafter}}|{{=it.firstflight.rule.cRefundBefore}}|{{=it.firstflight.rule.cRefundAfter}}" data-change="{{=it.firstflight.rule.changebefore}}|{{=it.firstflight.rule.changeafter}}|{{=it.firstflight.rule.cChangeBefore}}|{{=it.firstflight.rule.cChangeAfter}}">'+n.psg601+"</a></div>{{?}}"),summary_sub:e.template('<table class="summary-sub"><tr><th>'+n.psg010+"</th><th>"+n.psg011+"</th><th>"+n.psg012+"</th><th>"+n.psg013+"</th><th>"+n.psg014+"</th></tr><tr><td>"+n.psg019+'X<span class="num" data-idx="0">1</span></td><td class="price" data-idx="0" id="priceup">¥{{=it.price[0]}}</td><td data-idx="0" class="fuel">¥{{=it.fuel[0]}}</td><td data-idx="0" class="tax">¥{{=it.tax}}</td><td class="adultInsurance">¥--</td></tr><tr class="child-line"><td>'+n.psg020+'X<span class="num" data-idx="1">1</span></td><td class="price" data-idx="1">¥{{=it.price[1]}}</td><td data-idx="1" class="fuel">¥{{=it.fuel[1]}}</td><td>-</td><td class="childInsurance">¥--</td></tr><tr class="baby-line"><td>'+n.psg021+'X<span class="num" data-idx="2">1</span></td><td data-idx="2" class="price">¥{{=it.price[2]}}</td><td data-idx="2" class="fuel">¥{{=it.fuel[2]}}</td><td>-</td><td class="babyInsurance">¥--</td></tr></table>'),form_tpl:e.template('<li class="psg-block form  form-inline psgType{{=it.pType}}" id="{{=it.id}}" data-type="{{=it.pType}}"><div class="control-group psg-type show"><div class="controls"><div class="search-checkbox"><div class="select checkbox-box p-Type-sel" tabindex="0" hidefocus="true" data-type="pType"><div class="select-trigger"></div><div class="select-ico"> <b class="arrow-down"></b> </div><ul class="option-group"><li class="option" data-value="0">'+n.psg019+" (≥12"+n.psg067+')</li><li class="option" data-value="1">'+n.psg020+" (2-11"+n.psg067+')</li><li class="option" data-value="2">'+n.psg021+" (<2 "+n.psg067+')</li></ul></div></div></div></div><div class="control-group psg-name show"><div class="control-label"><span class="redStar">*</span> '+n.psg022+' </div><div class="controls"><input type="text" class="input psg-name-input p-name" name="psgName" value="" maxlength="55" /> <b class="helper-trigger ico ico-question" data-type="pName" data-direction="t"></b><div class="help-text"></div></div></div><div class="control-group psg-idType {{=it.pIdTypeShow}}"><div class="control-label"><span class="redStar">*</span> '+n.psg026+' </div><div class="controls p-id-box"><div class="search-checkbox"><div class="select checkbox-box p-idType-sel" tabindex="0" hidefocus="true" data-type="pIdType"><div class="select-trigger"></div><div class="select-ico"> <b class="arrow-down"></b> </div><ul class="option-group"><li class="option" data-value="NI">'+n.psg023+'</li><li class="option" data-value="PP">'+n.psg024+'</li><li class="option" data-value="ID">'+n.psg025+'</li></ul></div></div><input type="text" name="pIdCard" class="input p-idCard psg-idType-input" value="{{=it.pIdCard}}" maxlength="18" /> <b class="helper-trigger ico ico-question" data-type="cardType" data-direction="t"></b></div></div><div class="control-group psg-birthday birthday-box {{=it.pBirthdayShow}}"><div class="control-label"><span class="redStar">*</span> '+n.psg027+' </div><div class="controls"><input type="text" class="input psg-birthday-input " placeholder="" name="pBirthday" value="{{=it.pBirthday}}" maxlength="55" /> </div></div><div class="control-group psg-carryBy {{=it.pCarrayByShow}}"><div class="control-label"><span class="redStar">*</span> '+n.psg030+' </div><div class="controls"><div class="search-checkbox"><div class="select checkbox-box psg-carry" tabindex="0" hidefocus="true"><div class="select-trigger psgs-carryByName"></div><div class="select-ico"> <b class="arrow-down"></b> </div><ul class="option-group psgs-carryBy"><li class="option" data-value=""></li></ul></div></div></div></div><!--<div class="control-group psg-insurance show"><div class="control-label">'+n.psg534+'</div><div class="controls"><div class="search-checkbox"><div class="select checkbox-box p-insurance-sel" tabindex="0" hidefocus="true" data-type=""><div class="select-trigger"></div><div class="select-ico"><b class="arrow-down"></b></div><ul class="option-group"><li class="option" data-value="20">'+n.psg535+'</li><li class="option" data-value="-1">'+n.psg536+'</li></ul></div></div><b class="helper-trigger ico ico-question" data-type="insurance" data-direction="t"></b><div class="help-text">'+n.psg537+'</div></div></div><div class="insurance-box psg-insurance"><div class="fl title-lable">'+n.psg534+'</div><div class="fl insurance-item-box"><div class="item-info"><span class="item-type"><input type="checkbox" name="insuranceType_{{=it.id}}" class="check-box-icon" checked="checked" data-value="7">'+n.psg549+'</span><span class="item-price">&yen;<span class="yellow-text">30</span>'+n.psg550+'</span><span class="item-help-text">'+n.psg551+'</span><span class="helper-trigger ico help-icon" data-type="insurance" data-direction="t"></span></div><div class="item-info refund-insurance {{?(!it.pType==2)}} hide{{?}}"><span class="item-type"><input type="checkbox" name="insuranceType_{{=it.id}}" class="check-box-icon" checked="{{?it.pType!==2}}checked{{?}}" data-value="6">'+n.psg552+'</span><span class="item-price">&yen;<span class="yellow-text">20</span>'+n.psg550+'</span><span class="item-help-text">'+n.psg553+'</span><span class="helper-trigger ico help-icon" data-type="insurance_refund" data-direction="t"></span></div></div></div>--><div class="insurance-box psg-insurance"></div><div class="cls-psg-block p-cls hide">'+n.psg250+'</div><div class="del-psg-block p-del">'+n.psg031+"</div></li>"),insurance_tpl:e.template('<div class="fl title-lable">'+n.psg534+'</div><div class="fl insurance-item-box">{{~it.insuranceList:info:index}}<div class="item-info {{? info.forPsgType.indexOf(it.pType)==-1}}hide{{?}}"><label class="insuranceLabel" for="ir{{=index}}_{{=it.psgId}}"><span class="item-type"><input type="checkbox" name="{{=it.psgId}}" id="ir{{=index}}_{{=it.psgId}}" class="check-box-icon" {{?info.isdefault}}checked="checked" {{?}} data-value="{{=info.typeOfInsurance}}"> <span class="item-name">{{=info.insuranceName}}</span> </span><span class="item-price">&yen; <span class="yellow-text">{{=info.insuranceCost}}</span> '+n.psg550+'</span> <span class="helper-trigger ico help-icon" data-type="{{=info.helpType}}" data-direction="t" data-index="{{=index}}"></span> <span class="item-help-text"><span class="blue-text">{{?it.lang==="zh"}}{{=info.claimsDescZH}}{{??}}{{=info.claimsDescEN}}{{?}}</span></span></label></div>{{~}}</div><div class="insurance-icon">'+n.psg551_2+"</div>"),comm_tpl:e.template('<a id="{{=it.id}}" href="#{{=it.id}}" class="c-p{{=it.cls}}">{{=it.psgName}}</a>'),coupon_box:'<div id="coupon-box"><h4 class="coupon-title out-link-style"><div class="coupon-checkbox" otype="button" otitle="'+n.psg216+'"> <input type="hidden" id="terms" />'+n.psg205+'</div> <a href="javascript:void(0)" class="helper-trigger" data-type="coupon">'+n.psg214+'</a></h4><div id="coupon-block" class="form-block coupon-block hide"><div class="coupontips">'+n.psg221+'</div></div><div class="coupontips hide" id="comconpunbox">'+n.psg222+"</div></div>",coupon_tpl:e.template('<div class="conpunshow" id="conpunshow"><div class="conpundir dirleft"><div class="diricon"></div></div><div class="conpunplay" id="conpunplay"><div class="conpunallwid">{{~it.info :coupon:index}}{{? coupon.status && !(it.isMember && coupon.discountType == 1) && !(it.issolbool && coupon.discountType == 1)}}<div class="coupon-list{{? (it.iscomprice || it.adultnum > 1) && coupon.discountType == 1}} unselect{{?}}{{? coupon.discountType == 1}} flightprice{{??}} curprice{{?}}{{? coupon.idCards && coupon.idCards.length>0}} iscards disableid{{?}}" data-index="{{=index}}" data-id="{{=coupon.id}}" {{? coupon.hasOwnProperty("useRestriction")}} data-useRestriction="{{=coupon.useRestriction}}"{{?}}><div class="checedicon"></div><div class="conpunopc">{{? (it.iscomprice || it.adultnum > 1) && coupon.discountType == 1}}'+n.psg232+"{{?? coupon.idCards && coupon.idCards.length>0 && coupon.useRestriction != 1}}{{? coupon.useRestriction == 2}}"+n.psg066+"{{??}}"+n.psg354+'{{?}}{{?}}</div><div class="control-group couponclick"> <div class="conpun-bg"><div class="conpun-priceinfo"><span class="y">￥</span><span class="p">{{=coupon.faceValue}}</span><span class="info"><span class="q">YUAN</span><br /><span class="i">'+n.psg223+'</span></span></div><div class="conpun-date">'+n.psg223+'<span class="l">{{=coupon.flightDate.replace("|","--")}}</span></div></div> </div> <div class="control-group" > <div class="control-label">'+n.psg201+'</div> <div class="controls"> <div class="search-checkbox"> <input type="hidden" {{? it.psg.psg.length != 0 }} value="{{=it.psg.psg[0].psgname}}" data-value="0" {{?}}  value="" data-value="" name="coupon_psg"> <div class="select checkbox-box upgrade_passenger" name="coupon_select" tabindex="0" hidefocus="true"> <div class="select-trigger"></div> <div class="select-ico"><b class="arrow-down"></b></div> <ul class="option-group coupon-select-ul">{{~it.psg.psg :items:index2}} <li class="option" data-value="{{=index2}}">{{=items.psgname}}</li> {{~}} </ul></div></div></div></div><div class="control-group"> <div class="control-label">'+n.psg202+'</div> <div class="controls"> <div class="search-checkbox"> <input type="hidden" {{? it.psg.flight.length > 0 }} value="{{=it.psg.flight[0].depcity}}-{{=it.psg.flight[0].arrcity}}" data-value="{{=it.psg.flight[0].depdate}} {{=it.psg.flight[0].deptime}}:00|{{=it.psg.flight[0].depport}}|{{=it.psg.flight[0].arrport}}|{{=it.psg.flight[0].price[0]}}|{{=it.psg.flight[0].cabinname}}|{{=it.psg.flight[0].chooseCoupon}}" {{?}} name="coupon_flight"> <div class="select checkbox-box upgrade_flight" tabindex="0" hidefocus="true"> <div class="select-trigger"></div> <div class="select-ico"><b class="arrow-down"></b></div> <ul class="option-group">{{~it.psg.flight :items:index3}} {{~coupon.airLines :airline:index4}}{{? airline.split("-")[0] == items.depport && airline.split("-")[1] == items.arrport && airline.split("-")[2] == items.flightno && !(coupon.discountType == 1 && items.issolbool)}}<li class="option" data-value="{{=items.depdate}} {{=items.deptime}}:00|{{=items.depport}}|{{=items.arrport}}|{{=items.price[0]}}|{{=items.cabinname}}|{{=items.chooseCoupon}}">{{=items.depcity}}-{{=items.arrcity}}</li> {{?}}{{~}}{{~}} </ul> </div> </div> </div> </div></div>{{?}}{{~}}<div class="coupon-list addconpun"><div class="conpunopc">'+n.psg226+'</div><div class="control-group addconpunclick"> <div class="conpun-bg{{? "'+t.lang+'" == "en"}} conpun-bg-en{{?}}"><div class="conpundisaddtxt">'+n.psg229+'</div><div class="conpuninputdiv"><input type="text" class="conpuninput" value="" placeholder="'+n.psg228+'" maxlength=12 /><a href="javascript:void(0);" class="conpunBtn">'+n.psg227+'</a></div></div> </div> </div></div></div><div class="conpundir dirright"><div class="diricon"></div></div></div>'),coupon_only_tpl:e.template('{{~it.info :coupon:index}}<div class="coupon-list{{? it.adultnum > 1 && coupon.discountType == 1}} unselect{{?}}{{?coupon.discountType == 1}} flightprice{{??}} curprice{{?}}{{? coupon.idCards && coupon.idCards.length>0}} iscards{{? it.discard}} disableid{{?}}{{?}}" data-index="{{=it.index}}" data-id="{{=coupon.id}}" {{? coupon.hasOwnProperty("useRestriction")}} data-useRestriction="{{=coupon.useRestriction}}"{{?}}><div class="checedicon"></div><div class="conpunopc">{{? it.adultnum > 1 && coupon.discountType == 1}}'+n.psg232+"{{?? it.discard}}{{?coupon.useRestriction !=1}}{{? coupon.useRestriction == 2}}"+n.psg066+"{{??}}"+n.psg354+'{{?}}{{?}}{{?}}</div><div class="control-group couponclick"> <div class="conpun-bg"><div class="conpun-priceinfo"><span class="y">￥</span><span class="p">{{=coupon.faceValue}}</span><span class="info"><span class="q">YUAN</span><br /><span class="i">'+n.psg223+'</span></span></div><div class="conpun-date">'+n.psg223+'<span class="l">{{=coupon.flightDate.replace("|","--")}}</span></div></div> </div> <div class="control-group" > <div class="control-label">'+n.psg201+'</div> <div class="controls"> <div class="search-checkbox"> <input type="hidden" {{? it.psg.psg.length != 0 }} value="{{=it.psg.psg[0].psgname}}" data-value="0" {{?}}  value="" name="coupon_psg"> <div class="select checkbox-box upgrade_passenger" name="coupon_select" tabindex="0" hidefocus="true"> <div class="select-trigger"></div> <div class="select-ico"><b class="arrow-down"></b></div> <ul class="option-group coupon-select-ul">{{~it.psg.psg :items:index2}} <li class="option" data-value="{{=index2}}">{{=items.psgname}}</li> {{~}} </ul></div></div></div></div><div class="control-group"> <div class="control-label">'+n.psg202+'</div> <div class="controls"> <div class="search-checkbox"> <input type="hidden" {{? it.psg.flight.length > 0 }}{{~it.psg.flight :items:index5}} {{~coupon.airLines :airline:index6}}{{? airline.split("-")[0] == items.depport && airline.split("-")[1] == items.arrport && airline.split("-")[2] == items.flightno}} value="{{=items.depcity}}-{{=items.arrcity}}" data-value="{{=items.depdate}} {{=items.deptime}}:00|{{=items.depport}}|{{=items.arrport}}|{{=items.price[0]}}|{{=items.cabinname}}|{{=items.chooseCoupon}}" {{?}}{{~}}{{~}}{{?}} name="coupon_flight"> <div class="select checkbox-box upgrade_flight" tabindex="0" hidefocus="true"> <div class="select-trigger"></div> <div class="select-ico"><b class="arrow-down"></b></div> <ul class="option-group">{{~it.psg.flight :items:index3}} {{~coupon.airLines :airline:index4}}{{? airline.split("-")[0] == items.depport && airline.split("-")[1] == items.arrport && airline.split("-")[2] == items.flightno && !(coupon.discountType == 1 && items.issolbool)}}<li class="option" data-value="{{=items.depdate}} {{=items.deptime}}:00|{{=items.depport}}|{{=items.arrport}}|{{=items.price[0]}}|{{=items.cabinname}}|{{=items.chooseCoupon}}">{{=items.depcity}}-{{=items.arrcity}}</li> {{?}}{{~}}{{~}} </ul> </div> </div> </div> </div></div>{{~}}'),upgrades_box:'<div id="newupgrade-box"><h4 class="coupon-title out-link-style"><div class="fl hot-icon"></div><div class="coupon-checkbox" otype="button" otitle="'+n.psg236+'">'+n.psg237+'<div class="coupon-hot-tip">'+n.psg564+'</div> </div><a href="javascript:void(0)" class="helper-trigger" data-type="newupgrade">'+n.psg238+'</a></h4><div id="newupgrade-block" class="form-block coupon-block hide"><div class="coupontips">'+n.psg239+'</div><div class="conpunshow" id="gradeshow"><div class="conpundir gradedir dirleft disablddir"><div class="diricon"></div></div><div class="conpunplay gradeplay" id="gradeplay"><div class="conpunallwid" id="gradeallwid"></div></div><div class="conpundir gradedir dirright"><div class="diricon"></div></div></div><div class="coupontips hide" id="comupgradebox">'+n.psg240+"</div></div></div>",upgrades_tpl:e.template('{{? it[0]}}<div class="grade-list" data-index="{{=it[0].index}}"><div class="gradetitle clearfix"><div class="gradeseat"></div><div class="gradeflgiht{{? "'+t.lang+'" == "en"}} gradetitleEn{{?}}">{{=it[0].DEPNAME[0]}}-{{=it[0].ARRNAME[0]}}</div></div><div class="gradeCon"><div class="gradeprice{{? "'+t.lang+'" == "en"}} fontSize12{{?}}">'+n.psg247+'<span class="y">+ ¥</span><span class="p{{? "'+t.lang+'" == "en"}} fontSize24{{?}}">{{=it[0].PICE[0]}}</span>'+n.psg242+'</div><div class="gradecabin{{? "'+t.lang+'" == "en"}} fontSize18{{?}}">{{=it[0].cabinname}}</div></div><div class="gradeBtn" data-index="0" data-price="{{=it[0].PICE[0]}}"><div class="gradeBtn-left">'+n.psg243+'{{=it[0].cabinname}}<div class="gradechecedicon"></div></div><div class="gradeBtn-right">'+n.psg562+'</div></div>{{? it[1]}}<div class="gradeBtn gradetwoBtn" data-index="1" data-price="{{=it[1].PICE[0]}}"><div class="gradeBtn-left">'+n.psg244+"¥{{=it[1].PICE[0]}}"+n.psg245+'{{=it[1].cabinname}}<div class="gradechecedicon"></div></div><div class="gradeBtn-right">'+n.psg562+"</div></div>{{?}}</div>{{?}}"),zxprice_box:'<div id="zxPrice_block" class="form-block coupon-block"><p class="zx-price">'+n.psg544+'</p></div><div class="channelrule helper-trigger" data-type="zxprice">'+n.psg545+'</div><h4 class="coupon-title out-link-style"><div class="coupon-checkbox" otype="button" otitle="'+n.psg530+'"> <input type="hidden" id="zxPrice" />'+n.psg530+'  &yen;<span class="sellzxprice">--</span></div></h4>',multipleUpgrade:e.template('<div id="recommendUpgrades"><div id="multipleSegTableZH"><div class="bnav4 openClose" id="openClose3" style="z-index:100; dislay:block"><p class="adredtext"><img class="adicon" src="/B2C40/static/main/images/adicon.gif" /><b class="adtext01">'+n.psg047+"</b>"+n.psg048+n.psg220+"<small>"+n.psg049+'</small></p>{{~it:value:index}}<div class="linebox"><div class="dd" style="height:75px;"><ul class="lineList"><li class="mutiselectClass"><div class="upgradecheckbox" data-city="{{=value.depport}}{{=value.arrport}}" data-order="{{=value.segorder}}" data-fgprice="{{=value.fgprice}}" data-newprice="{{=value.newprice}}" data-oldprice="{{=value.oldprice}}" data-differ="{{=value.farediffer}}" data-cabin="{{=value.aftercabin}}" otype = "button" otitle = "预订流程-旅客信息-推荐升舱-选择"></div><span class="huiText"> {{=value.depportname}}-{{=value.arrportname}}</span><b class="linered01">+{{=value.farediffer}}</b><span class="redlineText01">'+n.psg050+"</span>"+n.psg051+"{{=value.aftercabinname}}"+n.psg218+'<span class="lineText03">'+n.psg052+'</span><b class="redlineText02">{{=value.fgprice}}</b><span class="lineText03">'+n.psg053+'</span></li></ul></div></div>{{? value.aftercabinname=="'+t.flight.fl0009+'"}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev-{{=index}}"></a><a class="rightbtn" id="mycarousel-next-{{=index}}"></a> <div class="adlist" id="mycarousel-{{=index}}"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent-{{=index}}"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show03.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg03.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show07.gif" id="Max" class="maxImg" name="6" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg09.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show11.gif" id="Max" class="maxImg" name="7" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg11.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show08.gif" id="Max" class="maxImg" name="8" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg10.gif" /></a></li></ul></div></div></div>{{?? value.aftercabinname=="'+t.flight.fl0010+'"}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev-{{=index}}"></a><a class="rightbtn" id="mycarousel-next-{{=index}}"></a> <div class="adlist" id="mycarousel-{{=index}}"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent-{{=index}}"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show09.gif" id="Max" class="maxImg" name="1" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg12.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show05.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg13.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show10.gif" id="Max" class="maxImg" name="4" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg14.gif" /></a></li></ul></div></div></div>{{??}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev-{{=index}}"></a><a class="rightbtn" id="mycarousel-next-{{=index}}"></a> <div class="adlist" id="mycarousel-{{=index}}"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent-{{=index}}"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show02.gif" id="Max" class="maxImg" name="1" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg02.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show03.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg03.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show06.gif" id="Max" class="maxImg" name="4" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg06.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show05.gif" id="Max" class="maxImg" name="5" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg08.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show07.gif" id="Max" class="maxImg" name="6" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg09.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show11.gif" id="Max" class="maxImg" name="7" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg11.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show08.gif" id="Max" class="maxImg" name="8" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg10.gif" /></a></li></ul></div></div></div>{{?}}{{~}}<span class="closebox"><a href="javascript:void(0)" class="closebtn" id="closebtn2">'+n.psg054+'</a></span></div><div class="bnav5 openClose" id="openClose4" style="z-index:1;"><span class="adredtext5"><img class="adicon2" src="/B2C40/static/main/images/adicon.gif" /><b class="adtext01">'+n.psg047+"</b>"+n.psg048+n.psg220+'</span><div class="linebox" style="float:left; margin-top:4px;"><div class="dd" style="height:75px;"><ul class="lineList">{{~it:value:index}}<li class="mutiselectClass"><p class="lineMoreText"></p><div class="upgradecheckbox" data-city="{{=value.depport}}{{=value.arrport}}" data-order="{{=value.segorder}}" data-fgprice="{{=value.fgprice}}" data-newprice="{{=value.newprice}}" data-oldprice="{{=value.oldprice}}" data-differ="{{=value.farediffer}}" data-cabin="{{=value.aftercabin}}" otype = "button" otitle = "预订流程-旅客信息-推荐升舱-选择"></div> <span class="huiText">&nbsp;{{=value.depportname}}-{{=value.arrportname}}</span><b class="linered01">+{{=value.farediffer}}</b><span class="redlineText01">'+n.psg050+"</span>"+n.psg051+"{{=value.aftercabinname}}"+n.psg218+'<span class="lineText03">'+n.psg052+'</span><b class="redlineText02">{{=value.fgprice}}</b><span class="lineText03">'+n.psg053+'</span><p></p></li>{{~}}</ul></div></div><span class="closebox"><a href="javascript:void(0)" class="showbtn">'+n.psg055+"</a></span></div></div></div>"),singleUpgrade:e.template('<div id="recommendUpgrades"><div id="singleSegTableZH"><div class="bnav3 openClose" id="openClose1">{{~it:value:index}}<p class="adredtext"><img class="adicon" src="/B2C40/static/main/images/adicon.gif" /><b class="adtext01">'+n.psg047+"</b>"+n.psg048+"{{=value.aftercabinname}}"+n.psg217+"<small>"+n.psg049+'</small></p><p class="adtext simpselectClass"><input otype="button" name="checkbox" type="checkbox" style="display: none"/><a href="#" data-city="{{=value.depport}}{{=value.arrport}}" data-order="{{=value.segorder}}" data-fgprice="{{=value.fgprice}}" data-newprice="{{=value.newprice}}" data-oldprice="{{=value.oldprice}}" data-differ="{{=value.farediffer}}" data-cabin="{{=value.aftercabin}}" class="adbtn02 selectLabClass" otype = "button" otitle = "预订流程-旅客信息-推荐升舱-选择">'+n.psg056+'</a><span class="adpricetext"><b class="adtext04">+{{=value.farediffer}}</b>'+n.psg050+'</span><span style="font-size:24px">'+n.psg057+"{{=value.aftercabinname}}"+n.psg218+'</span><b class="adtext05">{{=value.depportname}}-{{=value.arrportname}}'+n.psg058+"{{=value.aftercabinname}}"+n.psg219+'</b><span class="adpricetext"><b class="adtext06" >{{=value.fgprice}}'+n.psg050+'</b></span></p>{{? value.aftercabinname=="'+t.flight.fl0009+'"}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev"></a><a class="rightbtn" id="mycarousel-next"></a> <div class="adlist" id="mycarousel"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show03.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg03.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show07.gif" id="Max" class="maxImg" name="6" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg09.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show11.gif" id="Max" class="maxImg" name="7" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg11.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show08.gif" id="Max" class="maxImg" name="8" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg10.gif" /></a></li></ul></div></div></div>{{?? value.aftercabinname=="'+t.flight.fl0010+'"}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev"></a><a class="rightbtn" id="mycarousel-next"></a> <div class="adlist" id="mycarousel"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show09.gif" id="Max" class="maxImg" name="1" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg12.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show05.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg13.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show10.gif" id="Max" class="maxImg" name="4" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg14.gif" /></a></li></ul></div></div></div>{{??}}<div class="adlistbox"><a class="leftbtn" id="mycarousel-prev"></a><a class="rightbtn" id="mycarousel-next"></a> <div class="adlist" id="mycarousel"><span class="centerkuang"></span><div class="adlist_content" id="adlistContent"><ul><li><a data-src="/B2C40/static/main/images/upgrades/show02.gif" id="Max" class="maxImg" name="1" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg02.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show03.gif" id="Max" class="maxImg" name="2" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg03.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show04.gif" id="Max" class="maxImg" name="3" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg04.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show06.gif" id="Max" class="maxImg" name="4" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg06.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show05.gif" id="Max" class="maxImg" name="5" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg08.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show07.gif" id="Max" class="maxImg" name="6" rel="nofollow"><img src="/B2C40/static/main/images/upgrades/adlistimg09.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show11.gif" id="Max" class="maxImg" name="7" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg11.gif" /></a></li><li><a data-src="/B2C40/static/main/images/upgrades/show08.gif" id="Max" class="maxImg" name="8" rel="nofollow" ><img src="/B2C40/static/main/images/upgrades/adlistimg10.gif" /></a></li></ul></div></div></div>{{?}}{{~}}<span class="closebox"><a href="javascript:void(0)" class="closebtn">'+n.psg054+'</a></span></div><div class="bnav2 openClose" id="openClose2">{{~it:value:index}}<p class="adtext simpselectClass"><input otype="button" name="checkbox" type="checkbox" style="display: none"><a href="#" data-city="{{=value.depport}}{{=value.arrport}}" data-order="{{=value.segorder}}" data-fgprice="{{=value.fgprice}}" data-newprice="{{=value.newprice}}" data-oldprice="{{=value.oldprice}}" data-differ="{{=value.farediffer}}" data-cabin="{{=value.aftercabin}}" class="adbtn selectLabClass" otype = "button" otitle = "预订流程-旅客信息-推荐升舱-选择">'+n.psg056+'</a><img class="adicon" src="/B2C40/static/main/images/adicon.gif"><b class="adtext01">'+n.psg047+"</b>"+n.psg048+"{{=value.aftercabinname}}"+n.psg217+'<span class="adpricetext"><b class="adtext02">+{{=value.farediffer}}</b>'+n.psg050+"</span>"+n.psg048+"{{=value.aftercabinname}}"+n.psg217+'<span class="adpricetext" onclick=""><b class="adtext03">{{=value.fgprice}}</b>'+n.psg053+'</span></p>{{~}}<span class="closebox"><a href="javascript:void(0)" class="showbtn" >'+n.psg055+"</a></span></div></div></div>"),pName:'<div class="passenger-name-helper-box"><p>'+n.psg515+"</p><p>"+n.psg516+"</p><p>"+n.psg517+"</p></div>",insurance:e.template('<div class="insurance-helper-box" id="insurance-helperbox" tabindex="-1"><table><thead><tr><th class="insurance-type">'+n.psg500+'</th><th class="insurance-adult">'+n.psg507+'</th></tr></thead><tbody><tr><td><div class="bluebg">'+n.psg501+'</div></td><td ><div class="bluebg">'+n.psg508+'</div></td></tr><tr><td><div class="bluebg">'+n.psg502+'</div></td><td><div class="bluebg">'+n.psg509+'</div></td></tr><tr><td><div class="bluebg">'+n.psg503+'</div></td><td><div class="bluebg2">'+n.psg510+'</div></td></tr><tr><td><div class="bluebg">'+n.psg504+'</div></td><td><div class="bluebg">'+n.psg511+'</div></td></tr><tr><td><div class="bluebg">'+n.psg505+'</div></td><td><div class="bluebg">'+n.psg512+'</div></td></tr><tr><td><div class="bluebg">'+n.psg506+'</div></td><td><div class="bluebg">'+n.psg513+"</div></td></tr><tr><td>"+n.psg540+"</td><td>"+n.psg541+'</td></tr><tr><td colspan="2" class="tda"><a href="{{=it.url}}" aria-hidden="true" tabindex="-1" target="_blank" >'+n.psg514+"</a></td></tr></tbody></table></div>"),insurance_refund:e.template('<div class="insurance-helper-box" id="insurance-refund-helperbox" tabindex="-1"><table><thead><tr><th class="insurance-type">'+n.psg500+'</th><th class="insurance-adult">'+n.psg507+"</th></tr></thead><tbody><tr><td><div>"+n.psg547+"</div></td><td><div>"+n.psg548+'</div></td></tr><tr><td colspan="2" class="tda"><a href="{{=it.url}}" aria-hidden="true" tabindex="-1" target="_blank">'+n.psg514+"</a></td></tr></tbody></table></div>"),cardType:'<div class="passenger-card-type-helper-box">'+n.psg565+"</div>",solcardType:'<div class="passenger-card-type-helper-box">'+r.fl0206+"</div>",zxprice:e.template('{{? it}}<div class="zxpricechannlrule"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><th>&nbsp;</th><th>'+n.psg202+'</th><th colspan="2">'+r.fl0038+"</th><th>"+r.fl0040+'</th></tr><tr><td rowspan="4">'+n.psg345+'</td><td rowspan="2">{{=it.depcity}}</td><td class="odd">'+r.fl0041+'</td><td class="odd">{{=it.change[0]}}</td><td class="odd">{{=it.sign}}</td></tr><tr><td>'+r.fl0043+'</td><td>{{=it.change[1]}}</td><td>{{=it.sign}}</td></tr><tr><td rowspan="2">{{=it.arrcity}}</td><td class="odd">'+r.fl0041+'</td><td class="odd">{{=it.change[0]}}</td><td class="odd">{{=it.sign}}</td></tr><tr><td>'+r.fl0043+"</td><td>{{=it.change[1]}}</td><td>{{=it.sign}}</td></tr><tr><th>&nbsp;</th><th>"+n.psg347+'</th><th colspan="3">'+r.fl0039+'</th></tr><tr><td rowspan="3">'+n.psg346+'</td><td rowspan="2">'+n.psg348+'</td><td colspan="2" class="odd">'+r.fl0041+'</td><td class="odd">{{=it.refund[0]}}</td></tr><tr><td colspan="2">'+r.fl0043+"</td><td>{{=it.refund[1]}}</td></tr><tr><td>"+n.psg349+'</td><td colspan="3">'+r.fl0029+'</td></tr></table><p class="grey">'+r.fl0045+'<br /><span class="red">*</span> '+r.fl0116+"</p></div>{{?}}"),coupon:'<div class="coupon-helper-box"><p>'+n.psg518+"</p></div>",ticketBox:e.template('<div class="ticket-box"><div class="ticket-title">'+n.psg019+'</div><table cellpadding="0" cellspacing="0" border="0" class="ticket-nt" width="100%"><tr><td class="even"><strong>'+n.psg566+'</strong></td><td class="even center"><strong>'+n.psg567+'</strong></td><td class="even center"><strong>'+n.psg568+'</strong></td><td class="even"><strong>'+n.psg569+'</strong></td></tr><tr><td class="odd">'+n.psg570+'</td><td class="odd center">{{? it.change[0] == "'+n.psg575+'"}}'+n.psg576+'{{?? it.change[0] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.change[0] == "'+n.psg578+'"}}'+n.psg578+"{{??}}¥{{=it.change[0]}}"+n.psg573+'{{?}}</td><td class="odd center">{{? it.refund[0] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.refund[0] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.refund[0] == "'+n.psg577+'"}}'+n.psg577+"{{??}}¥{{=it.refund[0]}}"+n.psg573+'{{?}}</td><td class="odd">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signbefore}}{{?}}</td></tr><tr><td class="even">'+n.psg572+'</td><td class="even center">{{? it.change[1] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.change[1] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.change[1] == "'+n.psg578+'"}}'+n.psg578+"{{??}}¥{{=it.change[1]}}"+n.psg573+'{{?}}</td><td class="even center">{{? it.refund[1] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.refund[1] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.refund[1] == "'+n.psg577+'"}}'+n.psg577+"{{??}}¥{{=it.refund[1]}}"+n.psg573+'{{?}}</td><td class="even">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signafter}}{{?}}</td></tr></table>{{?it.hasChild}}<div class="ticket-title">'+n.psg020+'</div><table cellpadding="0" cellspacing="0" border="0" class="ticket-nt" width="100%"><tr><td class="even"><strong>'+n.psg566+'</strong></td><td class="even center"><strong>'+n.psg567+'</strong></td><td class="even center"><strong>'+n.psg568+'</strong></td><td class="even"><strong>'+n.psg569+'</strong></td></tr><tr><td class="odd">'+n.psg570+'</td><td class="odd center">{{? it.change[2] == "'+n.psg575+'"}}'+n.psg576+'{{?? it.change[2] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.change[2] == "'+n.psg578+'"}}'+n.psg578+"{{??}}¥{{=it.change[2]}}"+n.psg573+'{{?}}</td><td class="odd center">{{? it.refund[2] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.refund[2] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.refund[2] == "'+n.psg577+'"}}'+n.psg577+"{{??}}¥{{=it.refund[2]}}"+n.psg573+'{{?}}</td><td class="odd">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signbefore}}{{?}}</td></tr><tr><td class="even">'+n.psg572+'</td><td class="even center">{{? it.change[3] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.change[3] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.change[3] == "'+n.psg578+'"}}'+n.psg578+"{{??}}¥{{=it.change[3]}}"+n.psg573+'{{?}}</td><td class="even center">{{? it.refund[3] == "'+n.psg575+'"}}'+n.psg602+'{{?? it.refund[3] == "'+n.psg576+'"}}'+n.psg576+'{{?? it.refund[3] == "'+n.psg577+'"}}'+n.psg577+"{{??}}¥{{=it.refund[3]}}"+n.psg573+'{{?}}</td><td class="even">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signafter}}{{?}}</td></tr></table>{{?}} {{?it.hasInfant}}<div class="ticket-title">'+n.psg021+'</div><table cellpadding="0" cellspacing="0" border="0" class="ticket-nt" width="100%"><tr><td class="even"><strong>'+n.psg566+'</strong></td><td class="even center"><strong>'+n.psg567+'</strong></td><td class="even center"><strong>'+n.psg568+'</strong></td><td class="even"><strong>'+n.psg569+'</strong></td></tr><tr><td class="odd">'+n.psg570+'</td><td class="odd center">'+n.psg576+'</td><td class="odd center">'+n.psg576+'</td><td class="odd">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signbefore}}{{?}}</td></tr><tr><td class="even">'+n.psg572+'</td><td class="even center">'+n.psg576+'</td><td class="even center">'+n.psg576+'</td><td class="even">{{? it.sign}}{{=it.sign}}{{??}}{{=it.signafter}}{{?}}</td></tr></table>{{?}}<p class="grey">'+n.psg574+'<br><span class="red">*</span> '+n.psg579+"</p></div>"),newupgrade:'<div class="coupon-helper-box">'+n.psg241+"</div>",unnewupgrade:'<div class="coupon-helper-box">'+n.psg342+"</div>",unnewupgrade2:'<div class="coupon-helper-box">'+n.psg350+"</div>",unzxpricebox:'<div class="coupon-helper-box">'+n.psg344+"</div>",solcardtpl:e.template('<div class="psg-sol-card"><div class="fr"><div class="control-label"><span class="redStar">*</span>{{? it==1}}'+r.fl0204+"{{?? it==2}}"+r.fl0205+"{{??}}"+r.fl0204+'{{?}}</div><input type="text" name="psolCard" class="input psg-sol-input" autocomplete="off" value=""><b class="helper-trigger ico ico-question" data-type="solcardType" data-direction="t"></b><div class="help-text"></div></div></div>'),kownandrule:e.template('<div class="knowandrulebox"><iframe class="shadow-bg"></iframe><div class="knowandrule"><h3>{{=it.title}}<div class="krclosed">&times;</div></h3><iframe id="knowandrule" src="{{=it.href}}" frameborder=0 scrolling="yes"></iframe><div class="krmore"><a href="{{=it.href}}" target="_blank">'+n.psg249+'</a></div><div class="krsubmit">'+n.psg227+"</div></div></div>"),showidType:'<div class="tip-bluesimple" id="tip-bluesimple-idtype" style="visibility: visible;"><div class="tip-inner tip-bg-image"><img src="/B2C40/static/main/images/idsuch.jpg" width="457px"></div><div class="tip-arrow tip-arrow-topleft" style="visibility: visible;"></div></div>'};return i}),function(e){function s(){e.each(t,function(){this.refresh(!0)})}var t=[],n=/^url\(["']?([^"'\)]*)["']?\);?$/i,r=/\.png$/i,i=!!window.createPopup&&document.documentElement.currentStyle.minWidth=="undefined";e(window).resize(s),e.Poshytip=function(t,n){this.$elm=e(t),this.opts=e.extend({},e.fn.poshytip.defaults,n),this.$tip=e(['<div class="',this.opts.className,'" error-group="',this.opts.errorGroup,'">','<div class="tip-inner tip-bg-image"></div>','<div class="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left"></div>',"</div>"].join("")).appendTo(document.body),this.$arrow=this.$tip.find("div.tip-arrow"),this.$inner=this.$tip.find("div.tip-inner"),this.disabled=!1,this.content=null,this.init()},e.Poshytip.prototype={init:function(){t.push(this);var n=this.$elm.attr("title");this.$elm.data("title.poshytip",n!==undefined?n:null).data("poshytip",this);if(this.opts.showOn!="none"){this.$elm.bind({"mouseenter.poshytip":e.proxy(this.mouseenter,this),"mouseleave.poshytip":e.proxy(this.mouseleave,this)});switch(this.opts.showOn){case"hover":this.opts.alignTo=="cursor"&&this.$elm.bind("mousemove.poshytip",e.proxy(this.mousemove,this)),this.opts.allowTipHover&&this.$tip.hover(e.proxy(this.clearTimeouts,this),e.proxy(this.mouseleave,this));break;case"focus":this.$elm.bind({"focus.poshytip":e.proxy(this.showDelayed,this),"blur.poshytip":e.proxy(this.hideDelayed,this)})}}},mouseenter:function(e){if(this.disabled)return!0;if(this.opts.isNowshow&&this.opts.classshow.hasClass(this.opts.showclass))return!0;if(this.opts.isnoshow&&!this.opts.classshow.hasClass(this.opts.showclass))return!0;this.$elm.attr("title","");if(this.opts.showOn=="focus")return!0;this.showDelayed()},mouseleave:function(e){if(this.disabled||this.asyncAnimating&&(this.$tip[0]===e.relatedTarget||jQuery.contains(this.$tip[0],e.relatedTarget)))return!0;if(!this.$tip.data("active")){var t=this.$elm.data("title.poshytip");t!==null&&this.$elm.attr("title",t)}if(this.opts.showOn=="focus")return!0;this.hideDelayed()},mousemove:function(e){if(this.disabled)return!0;this.eventX=e.pageX,this.eventY=e.pageY,this.opts.followCursor&&this.$tip.data("active")&&(this.calcPos(),this.$tip.css({left:this.pos.l,top:this.pos.t}),this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow))},show:function(){if(this.disabled||this.$tip.data("active"))return;this.reset(),this.update();if(!this.content)return;this.display(),this.opts.timeOnScreen&&this.hideDelayed(this.opts.timeOnScreen)},showDelayed:function(t){this.clearTimeouts(),this.showTimeout=setTimeout(e.proxy(this.show,this),typeof t=="number"?t:this.opts.showTimeout)},hide:function(){if(this.disabled||!this.$tip.data("active"))return;this.display(!0)},hideDelayed:function(t){this.clearTimeouts(),this.hideTimeout=setTimeout(e.proxy(this.hide,this),typeof t=="number"?t:this.opts.hideTimeout)},reset:function(){this.$tip.queue([]).detach().css("visibility","hidden").data("active",!1),this.$inner.find("*").poshytip("hide"),this.opts.fade&&this.$tip.css("opacity",this.opacity),this.$arrow[0].className="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left",this.asyncAnimating=!1},update:function(e,t){if(this.disabled)return;var n=e!==undefined;if(n){t||(this.opts.content=e);if(!this.$tip.data("active"))return}else e=this.opts.content;var r=this,i=typeof e=="function"?e.call(this.$elm[0],function(e){r.update(e)}):e=="[title]"?this.$elm.data("title.poshytip"):e;this.content!==i&&(this.$inner.empty().append(i),this.content=i),this.refresh(n)},refresh:function(t){if(this.disabled)return;if(t){if(!this.$tip.data("active"))return;var s={left:this.$tip.css("left"),top:this.$tip.css("top")}}this.$tip.css({left:0,top:0}).appendTo(document.body),this.opacity===undefined&&(this.opacity=this.$tip.css("opacity"));var o=this.$tip.css("background-image").match(n),u=this.$arrow.css("background-image").match(n);if(o){var a=r.test(o[1]);i&&a?(this.$tip.css("background-image","none"),this.$inner.css({margin:0,border:0,padding:0}),o=a=!1):this.$tip.prepend('<table class="tip-table" border="0" cellpadding="0" cellspacing="0"><tr><td class="tip-top tip-bg-image" colspan="2"><span></span></td><td class="tip-right tip-bg-image" rowspan="2"><span></span></td></tr><tr><td class="tip-left tip-bg-image" rowspan="2"><span></span></td><td></td></tr><tr><td class="tip-bottom tip-bg-image" colspan="2"><span></span></td></tr></table>').css({border:0,padding:0,"background-image":"none","background-color":"transparent"}).find(".tip-bg-image").css("background-image",'url("'+o[1]+'")').end().find("td").eq(3).append(this.$inner),a&&!e.support.opacity&&(this.opts.fade=!1)}u&&!e.support.opacity&&(i&&r.test(u[1])&&(u=!1,this.$arrow.css("background-image","none")),this.opts.fade=!1);var f=this.$tip.find("> table.tip-table");if(i){this.$tip[0].style.width="",f.width("auto").find("td").eq(3).width("auto");var l=this.$tip.width(),c=parseInt(this.$tip.css("min-width")),h=parseInt(this.$tip.css("max-width"));!isNaN(c)&&l<c?l=c:!isNaN(h)&&l>h&&(l=h),this.$tip.add(f).width(l).eq(0).find("td").eq(3).width("100%")}else f[0]&&f.width("auto").find("td").eq(3).width("auto").end().end().width(document.defaultView&&document.defaultView.getComputedStyle&&parseFloat(document.defaultView.getComputedStyle(this.$tip[0],null).width)||this.$tip.width()).find("td").eq(3).width("100%");this.tipOuterW=this.$tip.outerWidth(),this.tipOuterH=this.$tip.outerHeight(),this.calcPos(),u&&this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow,this.$arrow.css("visibility","inherit"));if(t&&this.opts.refreshAniDuration){this.asyncAnimating=!0;var p=this;this.$tip.css(s).animate({left:this.pos.l,top:this.pos.t},this.opts.refreshAniDuration,function(){p.asyncAnimating=!1})}else this.$tip.css({left:this.pos.l,top:this.pos.t})},display:function(t){var n=this.$tip.data("active");if(n&&!t||!n&&t)return;this.$tip.stop();if((this.opts.slide&&this.pos.arrow||this.opts.fade)&&(t&&this.opts.hideAniDuration||!t&&this.opts.showAniDuration)){var r={},i={};if(this.opts.slide&&this.pos.arrow){var s,o;this.pos.arrow=="bottom"||this.pos.arrow=="top"?(s="top",o="bottom"):(s="left",o="right");var u=parseInt(this.$tip.css(s));r[s]=u+(t?0:this.pos.arrow==o?-this.opts.slideOffset:this.opts.slideOffset),i[s]=u+(t?this.pos.arrow==o?this.opts.slideOffset:-this.opts.slideOffset:0)+"px"}this.opts.fade&&(r.opacity=t?this.$tip.css("opacity"):0,i.opacity=t?0:this.opacity),this.$tip.css(r).animate(i,this.opts[t?"hideAniDuration":"showAniDuration"])}t?this.$tip.queue(e.proxy(this.reset,this)):this.$tip.css("visibility","inherit");if(n){var a=this.$elm.data("title.poshytip");a!==null&&this.$elm.attr("title",a)}this.$tip.data("active",!n)},disable:function(){this.reset(),this.disabled=!0},enable:function(){this.disabled=!1},destroy:function(){this.reset(),this.$tip.remove(),delete this.$tip,this.content=null,this.$elm.unbind(".poshytip").removeData("title.poshytip").removeData("poshytip"),t.splice(e.inArray(this,t),1)},clearTimeouts:function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0)},calcPos:function(){var t={l:0,t:0,arrow:""},n=e(window),r={l:n.scrollLeft(),t:n.scrollTop(),w:n.width(),h:n.height()},i,s,o,u,a,f;if(this.opts.alignTo=="cursor")i=s=o=this.eventX,u=a=f=this.eventY;else{var l=this.$elm.offset(),c={l:l.left,t:l.top,w:this.$elm.outerWidth(),h:this.$elm.outerHeight()};i=c.l+(this.opts.alignX!="inner-right"?0:c.w),s=i+Math.floor(c.w/2),o=i+(this.opts.alignX!="inner-left"?c.w:0),u=c.t+(this.opts.alignY!="inner-bottom"?0:c.h),a=u+Math.floor(c.h/2),f=u+(this.opts.alignY!="inner-top"?c.h:0)}switch(this.opts.alignX){case"right":case"inner-left":t.l=o+this.opts.offsetX,this.opts.keepInViewport&&t.l+this.tipOuterW>r.l+r.w&&(t.l=r.l+r.w-this.tipOuterW);if(this.opts.alignX=="right"||this.opts.alignY=="center")t.arrow="left";break;case"center":t.l=s-Math.floor(this.tipOuterW/2),this.opts.keepInViewport&&(t.l+this.tipOuterW>r.l+r.w?t.l=r.l+r.w-this.tipOuterW:t.l<r.l&&(t.l=r.l));break;default:t.l=i-this.tipOuterW-this.opts.offsetX,this.opts.keepInViewport&&t.l<r.l&&(t.l=r.l);if(this.opts.alignX=="left"||this.opts.alignY=="center")t.arrow="right"}switch(this.opts.alignY){case"bottom":case"inner-top":t.t=f+this.opts.offsetY;if(!t.arrow||this.opts.alignTo=="cursor")t.arrow="top";this.opts.keepInViewport&&t.t+this.tipOuterH>r.t+r.h&&(t.t=u-this.tipOuterH-this.opts.offsetY,t.arrow=="top"&&(t.arrow="bottom"));break;case"center":t.t=a-Math.floor(this.tipOuterH/2),this.opts.keepInViewport&&(t.t+this.tipOuterH>r.t+r.h?t.t=r.t+r.h-this.tipOuterH:t.t<r.t&&(t.t=r.t));break;default:t.t=u-this.tipOuterH-this.opts.offsetY;if(!t.arrow||this.opts.alignTo=="cursor")t.arrow="bottom";this.opts.keepInViewport&&t.t<r.t&&(t.t=f+this.opts.offsetY,t.arrow=="bottom"&&(t.arrow="top"))}this.pos=t}},e.fn.poshytip=function(t){if(typeof t=="string"){var n=arguments,r=t;return Array.prototype.shift.call(n),r=="destroy"&&(this.die?this.die("mouseenter.poshytip").die("focus.poshytip"):e(document).undelegate(this.selector,"mouseenter.poshytip").undelegate(this.selector,"focus.poshytip")),this.each(function(){var t=e(this).data("poshytip");t&&t[r]&&t[r].apply(t,n)})}var i=e.extend({},e.fn.poshytip.defaults,t);e("#poshytip-css-"+i.className)[0]||e(['<style id="poshytip-css-',i.className,'" type="text/css">',"div.",i.className,"{visibility:hidden;position:absolute;top:0;left:0;}","div.",i.className," table.tip-table, div.",i.className," table.tip-table td{margin:0;font-family:inherit;font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;vertical-align:middle;}","div.",i.className," td.tip-bg-image span{display:block;font:1px/1px sans-serif;height:",i.bgImageFrameSize,"px;width:",i.bgImageFrameSize,"px;overflow:hidden;}","div.",i.className," td.tip-right{background-position:100% 0;}","div.",i.className," td.tip-bottom{background-position:100% 100%;}","div.",i.className," td.tip-left{background-position:0 100%;}","div.",i.className," div.tip-inner{background-position:-",i.bgImageFrameSize,"px -",i.bgImageFrameSize,"px;}","div.",i.className," div.tip-arrow{visibility:hidden;position:absolute;overflow:hidden;font:1px/1px sans-serif;}","</style>"].join("")).appendTo("head");if(i.liveEvents&&i.showOn!="none"){var s,o=e.extend({},i,{liveEvents:!1});switch(i.showOn){case"hover":s=function(){var t=e(this);t.data("poshytip")||t.poshytip(o).poshytip("mouseenter")},this.live?this.live("mouseenter.poshytip",s):e(document).delegate(this.selector,"mouseenter.poshytip",s);break;case"focus":s=function(){var t=e(this);t.data("poshytip")||t.poshytip(o).poshytip("showDelayed")},this.live?this.live("focus.poshytip",s):e(document).delegate(this.selector,"focus.poshytip",s)}return this}return this.each(function(){new e.Poshytip(this,i)})},e.fn.poshytip.defaults={content:"[title]",className:"tip-yellow",bgImageFrameSize:10,showTimeout:500,hideTimeout:100,timeOnScreen:0,showOn:"hover",liveEvents:!1,alignTo:"cursor",alignX:"right",alignY:"top",offsetX:-22,offsetY:18,keepInViewport:!0,allowTipHover:!0,followCursor:!1,fade:!0,slide:!0,slideOffset:8,showAniDuration:300,hideAniDuration:300,refreshAniDuration:200}}(jQuery),define("poshytip",function(){}),define("loginCommonRequest",["require","exports","module","jquery"],function(e,t,n){var r=e("jquery");_META={memberLogin:{url:"/portal/user/login"},MAPB_Login:{url:"/portal/user/login?channel=MAP-B"},nameCheck:{url:"/B2C40/user/exchangeKeyLogin.ao"},sentPsw:{url:"/portal/smsMessage/EUserVerifyCode"},sentPswCode:{url:"/portal/smsMessage/getEmailLoginVerifyCode"},mobileBind:{url:"/portal/user/bindAccount"},bindSendPsw:{url:"/portal/smsMessage/ESocialMediaVerifyCode"}},_lReq=function(e,t,n,i,s){var o=_META[e],u=t?t:"";r.ajax({url:o.url,data:u,type:"post",async:i,dataType:"json",success:function(e){try{typeof n=="function"&&n(e)}catch(t){typeof s=="function"&&s()}},error:function(e){typeof s=="function"&&s(e)}})},main=function(e,t,n,r,i){try{"function"==typeof n&&_lReq(e,t,n,r,i)}catch(s){}},n.exports=main}),define("loginCommonTpl",["require","exports","module","doT","lang"],function(e,t,n){var r=e("doT"),i=e("lang"),s=i.login,o={alertLoginBoxMain:r.template('<div class="shadow-box shadow-blue hide  {{=it.lang}}" id="login-dialog"><iframe class="shadow-bg" title="background" aria-hidden="true"></iframe><div class="content-box {{?it.hasNolog}} hasNolog{{?}}" tabindex="0"><div class="logintitle"><div class="close-btn">x</div></div><div id="main_login_content"></div></div></div>'),loginAll:r.template('<div class="login-box all {{?it.hasNolog}} fl {{?}}"><ul class="tab-title"><li class="left member-login current" data-boxname="memberBox">'+s.login01+'</li><li class="left psw-login" data-boxname="dynamicPswBox">'+s.login100+'</li></ul><div class="lg-tabcontent" id="memberBox"><form class="form-box" id="memberLogin" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" maxlength="30" data-placeholder="'+s.login37+'" value="{{?it.userId&&it.userId!=" "}}{{=it.userId}}{{?}}" class="{{?it.userId&&it.userId!=" "}}greyfont{{?}} ipt-valid" name="userId" id="userId"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="greyfont place-hoder" autocomplete="off" name="passWordPH" id="passWordPH" value="'+s.login03_1+'"><input type="password" class="hide ipt-valid" maxlength="10" autocomplete="off" name="passWord" value="" id="passWord"><div class="help-txt"></div></div><div class="forget-psw"><a href="#" target="_blank" class="btn" id="mem_forgetPsw">'+s.login05+'</a></div><div class="lg-msg"></div><div class="lg-protocol"><label for="loginProtocol"><input type="checkbox" id="loginProtocol"  name="loginProtocol">'+s.login132+'</label></div><button type="submit" class="btn long-btn disabled login-btn"  otype="button" otitle="预订流程-航班选择-会员登录" id="mem_btn_login">'+s.login04+'</button></form></div><div class="lg-tabcontent hide" id="dynamicPswBox"><form class="form-box" id="dynamicPswLogin" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" maxlength="30" data-placeholder="{{?!it.isEmailDisabled}}'+s.login101+"{{??}}"+s.login134+'{{?}}" data-email="{{=it.isEmailDisabled}}" value="{{?it.userId&&it.userId!=" "}}{{=it.userId}}{{?}}" class="{{?it.userId&&it.userId!=" "}}greyfont{{?}} ipt-valid ipt-disBtn" name="userId" id="eId"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="short greyfont ipt-valid" autocomplete="off" data-placeHolder="'+s.login102+'" name="vcode" id="vcode"><div class="btn short-btn"  id="dyn_btn_psw">'+s.login103+'</div><div class="help-txt"></div></div><div class="lg-msg"></div><div class="lg-protocol"><label for="loginProtocol1"><input type="checkbox" id="loginProtocol1" name="loginProtocol">'+s.login132+'</label></div><button type="submit" class="btn long-btn login-btn disabled" id="dyn_btn_login" otype="button" otitle="预订流程-航班选择-动态密码登录">'+s.login04+'</button></form></div>{{?it.isExAccount}}<div class="exAccount" id="exAccount"><div>'+s.login08+'</div><div class="qqlogin disabled">QQ</div><div class="weixinlogin disabled">weixin</div></div>{{?}}</div>'),noLogin:r.template('<div class="login-box no-login fl"><div class="btn long-btn" otype="button" otitle="预订流程-航班选择-无需登录" id="noLogin_btn">'+s.login109+"&gt;</div></div>"),loginMemberOnly:r.template('<div class="login-box member-only"><ul class="tab-title"><li class="current unclick" data-boxname="memberBox">'+s.login01+'</li></ul><div class="lg-tabcontent" id="memberBox"><form class="form-box" id="memberLogin" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" maxlength="30" data-placeholder="'+s.login37+'" value="" class="greyfont ipt-valid" name="userId" id="userId"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="greyfont place-hoder" autocomplete="off" name="passWordPH" id="passWordPH" value="'+s.login03_1+'"><input type="password" class="hide ipt-valid" autocomplete="off" maxlength="10" name="passWord" value="" id="passWord"><input type="password" class="sr-only" maxlength="10" autocomplete="off" name="passWord" value="" id="passWord"><div class="help-txt"></div></div><div class="forget-psw"><a href="#" target="_blank" class="btn" id="mem_forgetPsw">'+s.login05+'？</a></div><div class="lg-msg"></div><div class="lg-protocol"><label for="loginProtocol1"><input type="checkbox" id="loginProtocol1" name="loginProtocol">'+s.login132+'</label></div><button type="submit" class="btn long-btn disabled login-btn" otype="button" otitle="预订流程-航班选择-会员登录" id="mem_btn_login">'+s.login04+'</button></form></div>{{?it.isExAccount}}<div class="exAccount" id="exAccount"><div>'+s.login08+'</div><div class="qqlogin">QQ</div><div class="weixinlogin">weixin</div></div>{{?}}</div>'),loginDynamicOnly:r.template('<div class="login-box dynamic-only"><ul class="tab-title"><li class="current unclick" data-boxname="dynamicPswBox">'+s.login100+'</li></ul><div class="lg-tabcontent" id="dynamicPswBox"><form class="form-box" id="dynamicPswLogin" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" maxlength="30" data-placeholder="{{?!it.isEmailDisabled}}'+s.login101+"{{??}}"+s.login134+'{{?}}" data-email="{{=it.isEmailDisabled}}" value="{{?it.userId&&it.userId!=""}}{{=it.userId}}{{?}}" class="{{?!it.userId||it.userId==""}}greyfont{{?}} ipt-valid ipt-disBtn" name="userId" id="eId"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="short ipt-valid" data-placeHolder="'+s.login102+'" autocomplete="off" name="vcode" value="" maxlength="6" id="vcode"><div class="btn short-btn {{?!it.userId}}disabled{{?}}" id="dyn_btn_psw">'+s.login103+'</div><div class="help-txt"></div></div><div class="lg-msg"></div><div class="lg-protocol"><label for="loginProtocol1"><input type="checkbox" id="loginProtocol1" name="loginProtocol">'+s.login132+'</label></div><button type="submit" class="btn long-btn disabled login-btn" id="dyn_btn_login" otype="button" otitle="预订流程-航班选择-动态密码登录">'+s.login04+'</button></form><div class="back-a member-login-a">&lt; '+s.login01+"</div></div></div>"),mobileBind:r.template('<div class="login-box mobile-bind"><ul class="tab-title"><li class="current unclick" data-boxname="mobileBox">'+s.login106+'</li></ul><div class="close-icon">Ⅹ</div><div class="warn-tip">'+s.login115+'</div><div class="lg-tabcontent" id="mobileBox"><form class="form-box" id="mobileBind" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" data-placeholder="'+s.login107+'" maxlength="11" value="" class="greyfont ipt-valid" name="userId" id="mobile"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="short greyfont ipt-valid" maxlength="6" autocomplete="off" data-placeholder="'+s.login113+'" value="" id="vcode" name="vcode"><div class="btn short-btn" id="mobile_btn_psw">'+s.login114+'</div><div class="help-txt"></div></div><div class="lg-msg"></div><div class="btn long-btn margin-20" otype="button" otitle="预订流程-航班选择-会员登录" id="mobile_btn_bind">'+s.login108+"</div></form></div></div>"),moreMemberChoose:r.template('<div class="login-box more-member"><ul class="tab-title"><li class="current unclick" data-boxname="moreMemberBox">'+s.memberChoose001+'</li></ul><div class="lg-tabcontent" id="moreMemberBox"><ul class="member-list">{{~it.cardList:item:index}}<li class="member-item {{?item.status=="N"}}frozen{{?}}" exchange_key="{{=item.exkey}}" index={{=item.index}} data-memberNo="{{=item.card}}" data-tokenid="{{=it.tokenId}}"><span class="item-icon"></span><span class="item-number">{{=item.card}}</span><span class="item-name">{{?it.lang=="en"}}{{?item.enName}}{{=item.enName}}{{??}}{{=item.cnName}}{{?}}{{??}}{{?item.cnName&&/^[*]{0,}[一-龥]{1,}$/.test(item.cnName)}}{{=item.cnName}}{{??}}{{=item.enName}}{{?}}{{?}}</span>{{?item.status=="N"}}<span class="item-status">'+s.memberChoose004+'</span>{{?}}</li>{{~}}</ul><div class="warn-tip">'+s.memberChoose002+'</div><div class="btn long-btn unclick" otype="button" otitle="预订流程-航班选择-会员登录" id="moreMember_btn">'+s.memberChoose006+'</div></div><div class="back-a member-login-a txt-right">'+s.memberChoose003+"</div></div>"),nameCheck:r.template('<div class="login-box name-check"><ul class="tab-title"><li class="current unclick" data-boxname="nameCheckBox">'+s.nameCheck001+'</li></ul><div class="lg-tabcontent" id="nameCheckBox"><div class="name-tip" id="nameTip">{{=it.checkName}}</div><div class="form-box"><input type="text" class="check-name greyfont margin-20 ipt-valid" maxlength="20" autocomplete="off" name="checkName" data-placeholder="'+s.nameCheck002+'" value="" id="checkName" data-index="{{=it.index}}" data-exKey="{{=it.exKey}}"  data-tokenId="{{=it.tokenId}}" data-memberNo="{{=it.mNo}}" ><div class="help-txt"></div></div><div class="warn-tip">'+s.nameCheck002+"<br>"+s.nameCheck003+'"</div><div class="btn long-btn unclick" otype="button" otitle="预订流程-航班选择-会员登录" id="nameCheck_btn">'+s.nameCheck004+'</div><div class="back-a more-member-a txt-right">'+s.nameCheck005+"</div></div></div>"),forgetPsw:r.template('<div class="login-box lg-password-box"><ul class="tab-title"><li class="current unclick" data-boxname="dynamicPswBox">'+s.login_psw01+'</li></ul><div class="lg-tabcontent" id="dynamicPswBox"><form class="form-box" id="emailBox" autocomplete="off"><div class="lg-unit"><input type="text" autocomplete="off" maxlength="30" data-placeholder="'+s.login_psw07+'" value="{{?it.userId&&it.userId!=""}}{{=it.userId}}{{?}}" class="{{?!it.userId||it.userId==""}}greyfont{{?}} ipt-valid" name="userId" id="email"><div class="help-txt"></div></div><div class="lg-unit"><input type="text" class="short greyfont ipt-valid" autocomplete="off" data-placeHolder="'+s.login102+'" id="passWord" name="passWord"><div class="btn short-btn" id="email_btn_psw">'+s.login114+'</div><div class="help-txt"></div></div><div class="lg-msg"></div><button type="submit" class="btn long-btn" id="mail_btn_login" otype="button" otitle="预订流程-航班选择-会员登录">'+s.login04+'</button></form><div class="back-a member-login-a">&lt; '+s.login01+"</div></div></div>")};return o}),function(e){var t=Object.prototype,n=Function.prototype,r=Array.prototype,i=String.prototype;n.bind||(n.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=r.slice.call(arguments,1),n=this,i=function(){},s=function(){return n.apply(this instanceof i?this:e,t.concat(r.slice.call(arguments)))};return this.prototype&&(i.prototype=this.prototype),s.prototype=new i,s}),r.forEach||(r.forEach=function(e,t){var n,r;if(this==null)throw new TypeError(" this is null or not d efined");var i=Object(this),s=i.length>>>0;if(typeof e!="function")throw new TypeError(e+" is not a function");arguments.length>1&&(n=t),r=0;while(r<s){var o;r in i&&(o=i[r],e.call(n,o,r,i)),r++}}),r.map||(r.map=function(e,t){var n,r,i;if(this==null)throw new TypeError(" this is null or not defined");var s=Object(this),o=s.length>>>0;if(typeof e!="function")throw new TypeError(e+" is not a function");arguments.length>1&&(n=t),r=new Array(o),i=0;while(i<o){var u,a;i in s&&(u=s[i],a=e.call(n,u,i,s),r[i]=a),i++}return r}),r.every||(r.every=function(e,t){var n,r;if(this==null)throw new TypeError("this is null or not defined");var i=Object(this),s=i.length>>>0;if(typeof e!="function")throw new TypeError;arguments.length>1&&(n=t),r=0;while(r<s){var o;if(r in i){o=i[r];var u=e.call(n,o,r,i);if(!u)return!1}r++}return!0}),r.filter||(r.filter=function(e){if(this===void 0||this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError;var r=[],i=arguments.length>=2?arguments[1]:void 0;for(var s=0;s<n;s++)if(s in t){var o=t[s];e.call(i,o,s,t)&&r.push(o)}return r}),r.findIndex||(r.findIndex=function(e){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof e!="function")throw new TypeError("predicate must be a function");var t=Object(this),n=t.length>>>0,r=arguments[1],i;for(var s=0;s<n;s++){i=t[s];if(e.call(r,i,s,t))return s}return-1}),r.indexOf||(r.indexOf=function(e,t){var n;if(this==null)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(i===0)return-1;var s=t|0;if(s>=i)return-1;n=Math.max(s>=0?s:i-Math.abs(s),0);while(n<i){if(n in r&&r[n]===e)return n;n++}return-1}),i.indexOf||(i.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),e.console||(e.console={log:function(){}}),e.define&&define("polyfill",["require","exports","module"],function(e,t,n){})}(function(){return this}()),define("polyfill",null,{}),define("lValidate",["require","exports","module","jquery","lang"],function(e,t,n){var r=e("jquery"),i=e("lang"),s=i.login,o={userId:/^[\s\S]{1,30}$/,passWord:/(^\d{6,10}$)/,mobile:/^\s*([\d]{11})\s*$/,vcode:/(^[\d]{6}$)|(^[\d]{4}$)/,checkName:/(^[a-zA-Z]{1,30}$)|(^[\u4e00-\u9fa5]{1,30}$)/,email:/^(?![\_\-\.])[a-zA-Z0-9\_\-\.]*?[^\_\-\.]+@(?![\_\-\.])[a-zA-Z0-9\_\-\.]*?\.[a-zA-Z0-9]+$/,eId:/(^\w+@\w+\.\w+$)|^\s*([\d]{11})\s*$/},u=[s.login37,s.login41,s.login_psw07,s.login101,s.login102,s.login107,s.login73,s.nameCheck002],a={empty:function(e){return!!e&&u.indexOf(e)<0},userId:function(e){return o.userId.test(e)},passWord:function(e){return o.passWord.test(e)},mobile:function(e){return o.mobile.test(e)},vcode:function(e){return o.vcode.test(e)},checkName:function(e){return o.checkName.test(e)},email:function(e){return o.email.test(e)},eId:function(e,t){var n="";return t.data("email")?o.mobile.test(e)||(n="e02"):!o.mobile.test(e)&&!o.email.test(e)&&(n="e01"),n}},f=function(e,t,n){if(!e)return;var r=e.length,i=-1,s,o;while(++i<r){s=e[i];if(s){o=a[s.type],result=o&&o(t,n),msg=typeof result=="boolean"?!result&&s.msg:s.msg[result];if(msg)return msg}}return},l={passWord:[{type:"empty",msg:s.login11},{type:"passWord",msg:s.login16}],userId:[{type:"empty",msg:s.login11},{type:"userId",msg:s.login57}],mobile:[{type:"empty",msg:s.login11},{type:"mobile",msg:s.login27}],mcode:[{type:"empty",msg:s.login11},{type:"vcode",msg:s.login29}],vcode:[{type:"empty",msg:s.login11},{type:"vcode",msg:s.login56}],checkName:[{type:"empty",msg:s.login11},{type:"checkName",msg:s.nameCheck007}],email:[{type:"empty",msg:s.login11},{type:"email",msg:s.login84}],eId:[{type:"empty",msg:s.login11},{type:"eId",msg:{e01:s.login131,e02:s.login135}}]},c=function(e){var t=e[0];if(r(t).length>0){var n=r.trim(t.value),i=e.attr("id"),s=f(l[i],n,e),o=e.data("error");return s=s===undefined?"":s,s!==o&&!r(t).hasClass("userId")&&e.data("error",s).closest(".lg-unit").toggleClass("error",!!s).find(".help-txt").html(s||" "),s?"":n}};n.exports=c}),define("loginCommon",["require","exports","module","jquery","lang","loginCommonRequest","loginCommonTpl","lValidate","polyfill"],function(e,t,n){var r=e("jquery"),i=e("lang"),s=i.flight,o=e("loginCommonRequest"),u=i.login,a=e("loginCommonTpl"),f=e("lValidate"),l=e("polyfill"),c,h={},p={},d={},v=!1,m,g={email:/^(?![\_\-\.])[a-zA-Z0-9\_\-\.]*?[^\_\-\.]+@(?![\_\-\.])[a-zA-Z0-9\_\-\.]*?\.[a-zA-Z0-9]+$/,phone:/^1[0-9]{10}$/},y=function(e){var t,n=11;return e=e.toString(),/^\d{11}$/.test(e)?(t=e.substr(0,n/3)+e.substr(Math.round(n*2/3)).replace(/\d/g,"*")+e.substr(n*2/3),t):""},b=function(e){var t,n,r;return e=e.toString(),n=e.length,r=e.indexOf("@"),t=e.substr(0,1)+e.substr(1,r).replace(/\w/g,"*")+e.substr(r+1,n),t},w=function(e,t){var n={login:"loginAll",mem:"loginMemberOnly",b2c:"loginDynamicOnly",forget:"forgetPsw",nameList:"moreMemberChoose",namecheck:"nameCheck",all:"loginAll",bind:"mobileBind"},i=n[e],s="",o=!1;if(e==="all"||e==="login")t=t?t:{},t.isExAccount=!0,t.isEmailDisabled=v;s=t?a[i](t):a[i],c.closest(".hasNolog").length>0&&(o=!0),"namecheck"===e?(c.prepend(s),c.find(".more-member").addClass("hide")):c.html(s),C(),["all","login","b2c"].join("|").indexOf(e)>-1&&!t.userId&&_(r("#dynamicPswLogin .short-btn"),"disabled"),e==="all"||o?(h.isalert&&c.closest(".content-box").addClass("hasNolog"),c.find(".no-login").length===0&&c.append(a.noLogin)):h.isalert&&c.closest(".content-box").removeClass("hasNolog"),["login","mem","all"].indexOf(e)>-1&&typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_p","会员登录",!0),e==="b2c"&&typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_p","动态密码登录",!0)},E=function(e,t,n){var r={600001:u.login16,600005:u.login61,600007:u.login16,600006:u.login36,9e5:u.login71,600017:u.login124,600016:u.login125,600024:u.login16,600008:u.login96,600025:u.login69,600043:u.login97,600042:u.login98,600051:u.login117,600052:u.login118,600053:u.login119,600054:u.login120,600055:u.login121,600056:u.login122,600057:u.login123,600026:u.login125,600049:u.login130,P0003:u.login127,MSG0001:u.login127,MSG0002:u.login127,MSG0003:u.login127,MSG0008:u.login127,MSG0011:u.login129,cErr:u.login126,600050:u.login70,600030:u.login69,mErr:u.login24,sError:u.login70},i="",s;try{t==="login"?(i=r[e]?r[e]:r[600005],n.find(".lg-msg").addClass("error").text(i)):(s=t==="code"?"cErr":"mErr",i=r[e]?r[e]:r[s],x(i))}catch(o){x(r.sError)}},S=function(e,t,n){var s=!0,u={},a=e.find(".long-btn");if(a.data("cooling"))return;_(a,"loading"),e.find(".error").removeClass(".error").find(".lg-msg").text("").closest("form").find(".help-txt").text(""),e.find("input.ipt-valid").each(function(e,t){var n=t.name,i=f(r(t));i===""?(s=!1,u[n]=""):u[n]=i});if(s){if(t){u.loginType=1,u.memberType=1;if(u.passWord.length===4&&g.phone.test(u.userId)){w("b2c",{userId:u.userId});return}}else n==="memberLogin"&&(g.email.test(u.userId)?(u.loginType=11,u.memberType=7):(u.loginType=12,u.memberType=8));n==="memberLogin"&&h.isMAPB&&(u.channel="MAP-B"),o(n,u,function(t){t.success?(p.INFO=t.data,r("body").triggerHandler("uLogged"),_(a,"loading",!0)):(_(a,"loading",!0),t.tokenId&&t.tokenId!=""&&t.cardList&&t.cardList.length>0?w("nameList",{cardList:t.cardList,tokenId:t.tokenId,lang:i.lang}):E(t.exceptionMessage.code,"login",e))},!0,function(){E("600005","login",e),_(a,"loading",!0)})}else _(a,"loading",!0)},x=function(e,t,n,o){if(r("#alert_msg_box").length>0){if(r("#alert_msg_box").css("display")==="none"){r("#alert_msg_box .confirm-info p").html(e);var a=n?s.fl0117:u.login32,f=n?s.fl0118:u.login33,l=r("#alert_msg_box .btn-primary");l.html(a),n?r("#alert_msg_box .btn-del").length>0?"":l.after('<button class="btn btn-del">'+i.login.login33+"</button>"):r("#alert_msg_box .btn-del").remove(),n&&r("#alert_msg_box .btn-del").bind("click",function(){r("#alert_msg_box").hide(),r(document).off("focusin.dialog")}),r("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){r("#alert_msg_box").hide(),r(document).off("focusin.dialog"),typeof t=="function"?t():""}),r("#alert_msg_box").show()}}else{var a=n?s.fl0117:u.login32,c='<div id="alert_msg_box" class="confirm-window-box"><iframe class="shadow-bg" title="background"></iframe> <div class="confirm-window" tabindex="0"><div class="right confirm-info"><div class="left img"></div><p>'+e+'</p></div><a class="close-window close-w" href="javascript:;" role="button">&times;</a><div class="a-center top10"><button class="btn btn-primary">'+a+"</button></div></div></div>";r(c).prependTo("body"),r("#alert_msg_box .close-window").bind("click",function(e){e.preventDefault(),r("#alert_msg_box").hide()}),r("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){r("#alert_msg_box").hide(),typeof t=="function"?t():""})}n&&r("#alert_msg_box .btn-del").length<=0&&(r("#alert_msg_box .btn-primary").after('<button class="btn btn-del">'+s.fl0118+"</button>"),r("#alert_msg_box .btn-del").bind("click",function(){r.cookie("showSHAPVG",!0),r("#alert_msg_box").hide()}))},T=function(e,t){if(r("#getCodeBox").length>0)return!1;var n=t?"&flag=nomemberLogin":"",i=r('<div class="alert-box" id="getCodeBox"><iframe class="shadow-bg"></iframe><div class="closer-filter"></div><div class="box-content"><form class="form" id="get-code-form"><div class="imgBox"><img src="" id="kaptchaImage" /><div class="img-helper">'+s.fl0102+'</div></div><div class="control-group"><div class="control-label">'+s.fl0103+'</div><div class="controls"><input type="text" maxlength="4" class="input" id="kaptchaInput" /><button class="flat-btn flat-main" type="submit">'+s.fl0104+'</button><div class="help-text"></div></div></div></form></div></div>');i.find(".form").bind("submit",function(n){n.preventDefault();var i=r("#kaptchaInput"),o=i.val();o.length===4?t&&typeof e=="function"?(r("#getCodeBox").remove(),e(o)):N(e,1,!1):i.closest(".control-group").addClass("error").find("input ~.help-text").html(s.fl0086)}).find("#kaptchaImage").bind("click",function(e){e.preventDefault(),r(this).attr("src","/B2C40/GenerateVerifyCodeServlet.do?r="+Math.random()+n)}).trigger("click"),i.appendTo("body").find("#kaptchaInput").bind("keydown",function(e){e.keyCode==27&&r("#getCodeBox").remove()}).focus()},N=function(e,t,n){var i=r("#kaptchaInput").val();r.ajax({type:"POST",url:"/B2C40/VerifyCodeServlet.do?verifyCode="+i,dataType:"xml",async:!1,complete:function(t){var n=t.responseText;if(n=="ok"){var i=r("#kaptchaInput"),o=i.val();r("#getCodeBox").remove(),e(o)}else alert(s.fl0087),r("#kaptchaImage").attr("src","/B2C40/GenerateVerifyCodeServlet.do?r="+Math.random()),r("#kaptchaInput").val("")}})},C=function(){r("input").each(function(){if(r(this).attr("type")!="password"&&!r(this).hasClass("place-hoder")&&r(this).data("placeholder")){var e=r(this).data("placeholder");if(r(this).val()==""||r(this).val()==e)r(this).val(e),r(this).addClass("greyfont");r(this).on("focus",function(){r(this).val()==e&&(r(this).val(""),r(this).removeClass("greyfont"))}).on("blur",function(){r(this).val()==""&&(r(this).val(e),r(this).addClass("greyfont"))})}else r(this).attr("type")=="password"?r(this).on("blur",function(){r(this).val()==""&&(r(this).addClass("hide"),r("#"+r(this).attr("id")+"PH").removeClass("hide"))}):r(this).hasClass("place-hoder")&&r(this).on("focus",function(){r(this).addClass("hide");var e=r(this).attr("id"),t=e.substr(0,e.length-2);r("#"+t).removeClass("hide").focus()})})},k=function(e,t,n){var i=e.closest("form"),s=i.find("input[name=userId]"),a="mobile",l,c,h={},p="",d=!0,v="",m=e.text(),w=u.login85,S="code",N=!1,C;if(e.data("cooling"))return;_(e,"loading"),p=f(s),p?h[a]=p:d=!1,d?(N=g.email.test(h.mobile),N&&(t="sentPswCode",w=u.login86,S="email"),o(t,h,function(n){n.success?(p=t==="sentPswCode"?b(p):y(p),w=w.replace("{0}",p),x(w),l=60,e.removeClass("loading"),c=setInterval(function(){l--?M(e,l,m):(clearInterval(c),_(e,"loading",!0))},1e3),t==="bindSendPsw"&&setTimeout(function(){r("#alert_msg_box").hide()},1500)):(_(e,"loading",!0),C=n.errorCode,C==="600029"?T(function(t){e.trigger("click")}):E(C,S))},!0,function(){E("",S),_(e,"loading",!0)})):_(e,"loading",!0)},L=function(e){if(!e&&/^https?\:\/\/\w+$/.test(e))return!1;r("#zslopenwinbyurl").length>0&&r("#zslopenwinbyurl").remove(),r("body").append('<form target="_blank" action="'+e+'" id="zslopenwinbyurl"></form>'),r("#zslopenwinbyurl").submit()},A=function(){C(),c.on("submit","#memberLogin",function(e){e.preventDefault();var t=r(this);if(r(this).find(".login-btn").hasClass("disabled"))return;S(t,!0,"memberLogin")}).on("submit","#dynamicPswLogin",function(e){e.preventDefault();var t=r(this);if(r(this).find(".login-btn").hasClass("disabled"))return;S(t,!1,"memberLogin")}).on("submit","#emailBox",function(e){e.preventDefault();var t=r(this);S(t,!1,"memberLogin")}).on("click","#mem_forgetPsw",function(e){e.preventDefault();var t=r(this),n,i=r.trim(r("#userId").val());if(h.type!=="mem"&&g.phone.test(i)){n=i!==u.login37?i:"",w("b2c",{userId:n});return}r.isskypearl?r.cookie("language")&&r.cookie("language").indexOf("en")>-1?L(r.csairUrl().hostUrl+"/cn/notice_en.html"):L(r.csairUrl().hostUrl+"/cn/notice.html"):window.location.href=u.login_psw_url}).on("click",".tab-title li",function(){var e=r(this),t=e.text(),n;e.hasClass("current")||(r(".tab-title li").removeClass("current"),e.addClass("current"),r(".lg-tabcontent").addClass("hide"),n=r("#"+r(this).attr("data-boxname")),n.removeClass("hide"),n.find("input[name=loginProtocol]").is(":checked")?(r(".weixinlogin").removeClass("disabled"),r(".qqlogin").removeClass("disabled")):(r(".weixinlogin").addClass("disabled"),r(".qqlogin").addClass("disabled")),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_p",t,!0))}).on("click","#dyn_btn_psw",function(){var e=r(this);k(e,"sentPsw")}).on("click",".back-a",function(){r(this).closest("#nameCheckBox").length>0?(r(".more-member").removeClass("hide"),r(".name-check").remove()):w(h.type)}).on("click",".qqlogin",function(){if(r(this).hasClass("disabled"))return;if(!r(this).closest(".login-box").find(".lg-tabcontent:visible").find("input[name=loginProtocol]").is(":checked"))return x(u.login133),!1;r("body").trigger("QQuserLogged"),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_p","QQ登录",!0)}).on("click",".weixinlogin",function(){if(r(this).hasClass("disabled"))return;if(!r(this).closest(".login-box").find(".lg-tabcontent:visible").find("input[name=loginProtocol]").is(":checked"))return x(u.login133),!1;r("body").trigger("WXuserLogged"),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_p","微信登录",!0)}).on("click","#noLogin_btn",function(e){e.preventDefault(),r("body").triggerHandler("nologin")}).on("click","#moreMember_btn",function(){if(r("#moreMemberBox .member-item.checked").length===1&&!r(this).hasClass("unclick")){var e=r(".member-list"),t={checkName:e.data("checkName"),tokenId:e.data("tokenid"),exKey:e.data("exchangeKey"),index:e.data("index"),mNo:e.data("memberNo")};w("namecheck",t)}}).on("click",".member-item",function(){var e=r(this);e.hasClass("frozen")||(r("#moreMemberBox .member-item").removeClass("checked"),e.addClass("checked"),r("#moreMember_btn").removeClass("unclick"),e.closest(".member-list").data({memberNo:e.find(".item-number").text(),exchangeKey:e.attr("exchange_key"),index:e.attr("index"),checkName:e.find(".item-name").text(),tokenid:e.data("tokenid")}))}).on("change","#checkName",function(){r(this).val().trim()===""||r(this).val().trim()==r(this).attr("placeholder")?r("#nameCheck_btn").addClass("unclick"):r("#nameCheck_btn").removeClass("unclick")}).on("click","#nameCheck_btn",function(){var e=r(this);if(!e.hasClass("working")&&!e.hasClass("unclick")){var t=r("#checkName"),n=!1,s={},u;if(e.data("cooling"))return;_(e,"loading"),u=f(t),name=i.lang==="en"?"enName":"cnName",s={tokenId:t.data("tokenid"),exchangeKey:t.data("exkey"),memberNo:t.data("memberno"),index:t.data("index")},u&&(n=!0,s[name]=u),n?o("nameCheck",s,function(t){t.success?(_(e,"loading",!0),r("body").trigger("uLogged")):(_(e,"loading",!0),t.exceptionMessage.code==="600005"?x(i.inputNumError.numError03+"["+t.exceptionMessage.code+"]"):x(t.exceptionMessage.message),x(t.exceptionMessage.message))},!1,function(){_(e,"loading",!0)}):_(e,"loading",!0)}}).on("click","#mobile_btn_bind",function(e){e.preventDefault();var t=r(this).closest("form");S(t,!1,"mobileBind")}).on("click","#mobile_btn_psw",function(e){e.preventDefault();var t=r(this);k(t,"bindSendPsw")}).on("click",".mobile-bind .close-icon",function(){w("login")}).on("keyup",".ipt-disBtn",function(){var e=r(this),t=e.closest("form").find(".short-btn"),n=e.val();!n||n===e.data("placeHolder")?_(t,"disabled"):_(t,"disabled",!0)}).on("change","input[name=loginProtocol]",function(){var e=r(this),t=e.closest(".form-box");e.is(":checked")?(t.find(".login-btn").removeClass("disabled"),c.find(".qqlogin").removeClass("disabled"),c.find(".weixinlogin").removeClass("disabled")):(t.find(".login-btn").addClass("disabled"),c.find(".qqlogin").addClass("disabled"),c.find(".weixinlogin").addClass("disabled"))})},O=function(e){var t={type:"login",isalert:!1,isbind:!1,isMAPB:!1,isEmailDisabled:!1};h=r.extend(t,e),v=h.isEmailDisabled,c=h.isalert?r("#main_login_content"):r("#loginBox_page"),w(h.type),i.lang==="en"&&(r("#ad-content").addClass("en-box"),c.addClass("en-box")),A()},M=function(e,t,n){e.html("<font color='red'>"+t+"</font>"+u.login31),t<=0&&(e.html(n),e.removeClass("working"))},_=function(e,t,n){n?e.removeData("cooling",!1).removeClass(t):e.data("cooling",!0).addClass(t)};p.init=O,p.INFO=d,n.exports=p}),define("app",["jquery","doT","lang","UI","poshytip","loginCommon"],function(e,t,n,r,i,s){function b(e){var t="",n=e.data;if(n){var r,i=-1,s=n.length-1;while(i<s)r=n[i+=1],t+='<div class="choose-item ',r.status=="N"&&(t+="frozen"),t+='" exchange_key="'+r.exkey+'" index='+r.index+'><span class="item-icon"></span><span class="item-number">'+r.card+'</span><span class="item-name">',e.lang=="en"?r.enName?t+=""+r.enName:t+=""+r.cnName:r.cnName&&/^[*]{0,}[\u4e00-\u9fa5]{1,}$/.test(r.cnName)?t+=""+r.cnName:t+=""+r.enName,t+="</span>",r.status=="N"&&(t+='<span class="item-status">'+u.memberChoose004+"</span>"),t+="</div>"}return t}var o,u=n.login,a=n.flight,f=n.inputNumError,l=n.coupon,c=n.mileage,h=location.href.indexOf("/inter/")>-1?!0:!1,p=location.port=="80"?"":":"+location.port,d=location.protocol+"//",v=d+location.hostname+p,m={memberNo:"",cnName:"",enName:"",exchangeKey:"",tokenId:"",index:""},g="",y={navSide:function(t,r){var i=n.navSide,s='<div class="bar" id="flightbar"><div class="barDot"></div><ul class="clearfix"><li><div class="barNum">1</div>'+i.nav01+'<div class="barDir"></div></li><li><div class="barNum">2</div>'+i.nav02+'<div class="barDir"></div></li><li><div class="barNum">3</div>'+i.nav03+'<div class="barDir"></div></li><li><div class="barNum">4</div>'+i.nav04+'<div class="barDir"></div></li><li><div class="barNum">5</div>'+i.nav05+"</li></ul></div>";r&&(s='<div class="bar isUs" id="flightbar"><div class="barDot"></div><ol class="clearfix"><li><span class="sr-only">'+i.nav06+'</span><div class="barNum">1</div>'+i.nav01+'<div class="barDir"></div></li><li><span class="sr-only">'+i.nav06+'</span><div class="barNum">2</div>'+i.nav02+'<div class="barDir"></div></li><li><span class="sr-only">'+i.nav06+'</span><div class="barNum">3</div>'+i.nav03+'<div class="barDir"></div></li><li><span class="sr-only">'+i.nav06+'</span><div class="barNum">4</div>'+i.nav04+'<div class="barDir"></div></li><li><span class="sr-only">'+i.nav06+'</span><div class="barNum">5</div>'+i.nav05+"</li></ol></div>");var o=e(s);t=parseInt(t,10),t=t>=0&&t<6?t:1,e(s).prependTo("#contenter"),e("#flightbar li").removeClass("current").eq(t).addClass("current").append("<span class='sr-only'>"+i.nav07+"</span>")},searchBox:function(t){var r=n.searchBox,i=h?"预订流程-国际航班选择-重新查询":"预订流程-航班选择-重新查询",s='<form id="ticketbooking" method="post"><div class="flightTab" id="flightTab"><div class="flightTabH"><ul class="clearfix"><li class="current" data-val="1">'+r.search01+'</li><li data-val="2">'+r.search02+'</li><li data-val="3" class="moreTrip">'+r.search03+'<div class="flightTap-tip-icon"><div class="flightTap-tip-content hide"><div class="flightTop-tip-angle"></div><p>'+r.search13+'</p></div></div>&gt;&gt;</li><input id="segtype" type="hidden" value="1" name="segtype"><div id="refresh-flight">'+r.search09+"<span>0</span>"+r.search10+' <a href="javascript:void(0)">'+r.search11+'</a></div></ul></div><div class="flightCon"><ul class="clearfix"><li class="clearfix"><div class="fightTxt">'+r.search04+'</div><div class="flightF nomarginR"><input class="flightInput choose-city" type="text" id="fromcity" name="fromcity" value="" /><input id="city1_code" type="hidden" name="city1_code" value=""></div></li><li class="changeicon"><div class="changecity" id="changecity"></div></li><li class="clearfix"><div class="fightTxt">'+r.search05+'</div><div class="flightF"><input class="flightInput choose-city" id="tocity" type="text" value="" name="tocity" /><input id="city2_code" type="hidden" name="city2_code" value=""></div></li><li class="clearfix"><div class="fightTxt">'+r.search06+'</div><div class="flightF"><input class="flightInput choose-date" id="DepartureDate" type="text" value="" name="DepartureDate" /></div></li><li class="clearfix" style="display:none;" id="returndateli"><div class="fightTxt">'+r.search07+'</div><div class="flightF"><input class="flightInput choose-date" id="ReturnDate" type="text" value="" name="ReturnDate" /></div></li><li class="fr"><a href="javascript:void(0);" class="searchBtn" otype="button" otitle="'+i+'">'+r.search08+'</a></li></ul></div></div><input id="cabin" type="hidden" value="经济舱" name="cabin"><input id="adult" type="hidden" value="1" name="adult"><input id="child" type="hidden" value="0" name="child"><input id="infant" type="hidden" value="0" name="infant"></form>';e(s).prependTo("#contenter"),e("#flightTab .choose-city").setCities();var o=e("#flightTab .choose-date");o.eq(0).bind("change",function(){o.eq(1).setCalendarOpt("minDate",this.value)}).setCalendar({defaultDate:"+0d",minDate:"+0d",maxDate:"+1y"}).end().eq(1).setCalendar({defaultDate:"+1d",minDate:"+0d",maxDate:"+1y"}),e("#fromcity").val(t.n1.split("-")[0]),e("#tocity").val(t.n1.split("-")[1]),e("#city1_code").val(t.c1.split("-")[0]),e("#city2_code").val(t.c1.split("-")[1]),e("#DepartureDate").val(t.d1),e("#ReturnDate").val(y.getDateString(y.getDateWith(t.d1,"+1d"))),e("#segtype").val(1),t.t==="R"&&e("#flightTab li").eq(1).addClass("current").siblings(".current").removeClass("current")&&e("#segtype").val(2)&&e("#ReturnDate").val(t.d2)&&e("#returndateli").show(),e("#flightTab").on("click",".searchBtn",function(n){n.preventDefault();var r=e("#segtype").val(),i=e("#fromcity").val(),s=e("#city1_code").val(),o=e("#tocity").val(),u=e("#city2_code").val(),a=e("#DepartureDate").val(),f=e("#ReturnDate").val(),l=t.hasOwnProperty("preUrl")?t.preUrl:"",c=t.activitiesId?t.activitiesId:"";e(this).flightSearch(r,i,s,o,u,a,f,t.at,t.ct,t.it,l,t.lang,c)}).find("ul").eq(0).on("click","li",function(){var n=e(this).data("val");e(this).addClass("current").siblings(".current").removeClass("current"),n=="2"?e("#returndateli").show():n=="1"?e("#returndateli").hide():n=="3"&&(t&&t.lang&&t.lang==="en"?window.location.href=e.csairUrl().b2cUrl+"/B2C40/modules/bookingnew/manage/ticket_booking.jsp?fl=M&lang=en":window.location.href=e.csairUrl().b2cUrl+"/B2C40/modules/bookingnew/manage/ticket_booking.jsp?fl=M"),e("#segtype").val(n)}),e(".flightTap-tip-icon").on("mouseenter",function(){e(this).find(".flightTap-tip-content").removeClass("hide")}).on("mouseleave",function(){e(this).find(".flightTap-tip-content").addClass("hide")}),e("#changecity").changeCity("fromcity","tocity","city1_code","city2_code"),requirejs(["switcher"])},login:function(t,r,i,o,u,a,f,l,c){var h=n.lang,p='<div class="shadow-box shadow-blue hide login '+h+'" id="login-dialog"><iframe class="shadow-bg" title="background" aria-hidden="true"></iframe><div class="content-box" tabindex="0"><div class="logintitle"><div class="close-btn">x</div></div><div id="main_login_content"></div></div></div>',d=location.href.indexOf("flightSelectDirect.html")>-1||location.href.indexOf("flightSelectDirectold.html")>-1?!0:!1;e("body").append(p);var v="login";v=u?"mem":a?"all":v,i=!1,s.init({isalert:!0,type:v,nolog:!0,isMAPB:l,isEmailDisabled:c});if(i){var m=h==="en"?"favclass":"",g=i?'<div class="form-alert-count form-action clearfix '+m+'" id="form-alert-count">'+o+"</div>":"";e(".login-box").append(g)}d||y.user.otherLogin(function(){var t=window.location.href;e.cookie("jumpPage",t,{path:"/",domain:"csair.com"})}),e("body").unbind("uLogged").bind("uLogged",function(){y.user.INFO=s.INFO,y.user.logged=!0,e("body").trigger("userLogged")}),e(".close-btn").on("click",function(){var t=location.href;if(t.indexOf("B2C40/modules/bookingnew/mileage/search.html")!=-1){var n=e.cookie("language").substring(0,2);n=n=="en"?"en":"cn";var r=location.protocol,i=location.host.indexOf("b2c.csair.com")!=-1?"www.csair.com":"www.test.csair.com";location.href=r+"//"+i+"/"+n+"/index.shtml";return}e(this).closest("#login-dialog").addClass("hide")})},login_us:function(){var t=u.login04,r=n.lang==="zh"?"cn":n.lang,i=n.lang==="zh"?"":"isen",s='<div class="shadow-box shadow-blue login hide" id="login-dialog"><iframe class="shadow-bg" title="background" aria-hidden="true"></iframe><div class="content-box isNolog" tabindex="0"><div class="logintitle"><div class="close-btn">x</div></div><div class="login-box"><div class="lg-left"><h1 class="login-title langClass">'+u.login95+'</h1><div class="tab-content"><form class="form-box" autocomplete="off" id="isMemberLogin"><div class="error-info" tabindex="0"><div class="error-icon" aria-hidden="true"></div><div class="error-message"></div><span class="title"></span><span class="sr-only" tabindex="0"></span><ul class="error-list"></ul></div><div class="lg-unit"><div  class="lg-label"><div class="loginname"></div><label class="sr-only" for="login-userId">'+u.login02+'<span class="redstar">*</span></label></div><input type="text" id="login-userId" autocomplete="off" aria-required="true"  placeholder="'+u.login37+'" class="input userId greyfont" name="userId" value="'+u.login37+'"/><img src="../../../common/images/validation-err.png" alt="'+c.mil699+'" class="i-error userId_error" /></div><div class="lg-unit"><div class="lg-label psw-lable"><div class="loginpsw"></div><label for="login-pwd" class="sr-only">'+u.login03+'<span class="redstar">*</span></label></div><input aria-required="true" id="login-pwd" type="password" autocomplete="off" class="input passWord" name="passWord"><img src="../../../common/images/validation-err.png" alt="'+c.mil699+'" class="i-error pwd_error" /></div><div class="lg-msg"></div><div class="forget-psw"><a class="btn" href="//skypearl.csair.com/skypearl/'+r+'/dot/memberArea.action?&NOSSL&rem=true#pwdrevi" target="_blank">'+u.login05+'</a></div><button type="submit"  class="btn login-btn long-btn">'+t+'</button></form></div></div><div class="clear"></div><div role="button" tabindex="0" aria-label="close dialog" class="close-btn">x</div></div></div></div>';e("body").append(s),e(".userId").bind("focus",function(){e(".userId").val()===u.login37&&e(".userId").val("").removeClass("greyfont")}).bind("blur",function(){e(".userId").val()===""&&e(".userId").val(u.login37).addClass("greyfont")}),e(".input").on("change",function(){e(this).val()!=""&&e(this).closest(".lg-unit").removeClass("error")}),e("#isMemberLogin").bind("submit",function(t){t.preventDefault();var n=e(this);n.find(".error-info").hide().find(".error-list").html(""),n.find(".lg-unit").removeClass("error");if(n.hasClass("working"))return!1;n.addClass("working");var r=n.find(".userId"),i=n.find(".passWord");r.closest(".lg-unit").removeClass("error"),i.closest(".lg-unit").removeClass("error");var s={accountName:e.trim(r.val()),pwd:i.val(),memtype:"1"},o="";if(s.accountName===""||s.accountName===u.login37)o+='<li tabindex="0" data-error="login-userId">'+u.dot_error01+"</li>",r.closest(".lg-unit").addClass("error");s.pwd===""?(o+='<li tabindex="0" data-error="login-pwd">'+u.dot_error02+"</li>",i.closest(".lg-unit").addClass("error")):/^\d{4,}$/.test(s.pwd)||(o+='<li tabindex="0" data-error="login-pwd">'+u.login16+"</li>",i.closest(".lg-unit").addClass("error"),r.closest(".lg-unit").addClass("error"));if(o!=="")return n.find(".error-info").show().focus().find(".error-list").html(o),n.removeClass("working").closest(".login-box").removeClass("loading"),!1;n.addClass("working").closest(".login-box").addClass("loading"),o==""&&y.user.isMemberLogin(s,function(t){n.removeClass("working").closest(".login-box").removeClass("loading");if(t&&t.success)y.user.logged=t.success,e("body").triggerHandler("userLogged");else{var r=t.exceptionMessage.code==="600005"?f.numError03:t.exceptionMessage.message,i='<li tabindex="0">'+r+"</li>";n.find(".error-info").show().focus().find(".error-list").html(i)}},function(){var e='<li tabindex="0">'+u.login44+"</li>";n.find(".error-info").show().focus().find(".error-list").html(e),n.removeClass("working").closest(".sp-bookway-box").removeClass("loading")})}),e(".error-list").on("click","li",function(t){var n=e(this).data("error");!n||e("#"+n).focus()}).on("keydown","li",function(t){t.keyCode===13&&e(this).trigger("click")}),e("#login-dialog").on("click",".close-btn",function(){e(this).closest("#login-dialog").addClass("hide"),y.deforceFocus(!0)})},refreshTimeMsg:function(t){--o,e("#"+t).html("<font color='red'>"+o+"</font>"+u.login31),o<=0&&(e("#"+t).html(u.login30),e("#phoneMsg").closest(".control-group").removeClass("error").find("input ~.help-text").html(""),clearInterval(timmer),e("#"+t).removeClass("working").removeClass("loading"))},alert:function(t){var r=n.login,i='<div class="alert-box loadingArea"><iframe class="shadow-bg loading-bg" title="background"></iframe><div id="flight-loading" class="xbmutling"><div class="logindop"></div><div class="haerbmnmb"></div><div class="blintkyongh"></div><div class="fjlotnfliagh"></div><div class="loadingtxt"><h2>'+n.flight.wait+'</h2><div><iframe frameborder="0" scrolling="no" style="Z-INDEX: 2; VISIBILITY: inherit; WIDTH: 100%; HEIGHT: 58px" src="'+t+'"></iframe></div></div><div class="loadsfbootm"></div></div></div>';e(i).prependTo("body")},AlertMsgBox:function(t,r,i,s){if(e("#alert_msg_box").length>0){if(e("#alert_msg_box").css("display")==="none"){e("#alert_msg_box .confirm-info p").html(t);var o=i?n.flight.fl0117:u.login32,a=i?n.flight.fl0118:u.login33,f=e("#alert_msg_box .btn-primary");f.html(o),i?e("#alert_msg_box .btn-del").length>0?"":f.after('<button class="btn btn-del">'+n.login.login33+"</button>"):e("#alert_msg_box .btn-del").remove(),i&&e("#alert_msg_box .btn-del").bind("click",function(){e("#alert_msg_box").hide(),y.deforceFocus(!0),e(document).off("focusin.dialog")}),e("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){e("#alert_msg_box").hide(),y.deforceFocus(!0),e(document).off("focusin.dialog"),typeof r=="function"?r():""}),e("#alert_msg_box").show(),y.enforceFocus(e("#alert_msg_box .confirm-window")),e("#skip-to-main-link").attr("tabindex","-1")}}else{var o=i?n.flight.fl0117:u.login32,l='<div id="alert_msg_box" class="confirm-window-box"><iframe class="shadow-bg" title="background"></iframe> <div class="confirm-window" tabindex="0"><div class="right confirm-info"><div class="left img"></div><p>'+t+'</p></div><a class="close-window close-w" href="javascript:;" role="button">&times;</a><div class="a-center top10"><button class="btn btn-primary">'+o+"</button></div></div></div>";e(l).prependTo("body"),e("#alert_msg_box .close-window").bind("click",function(t){t.preventDefault(),e("#alert_msg_box").hide(),y.deforceFocus(!0)}),e("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){e("#alert_msg_box").hide(),y.deforceFocus(!0),typeof r=="function"?r():""})}i&&e("#alert_msg_box .btn-del").length<=0&&(e("#alert_msg_box .btn-primary").after('<button class="btn btn-del">'+n.flight.fl0118+"</button>"),e("#alert_msg_box .btn-del").bind("click",function(){e.cookie("showSHAPVG",!0),e("#alert_msg_box").hide()})),y.enforceFocus(e("#alert_msg_box .confirm-window")),e("#skip-to-main-link").attr("tabindex","-1")},alertBox:function(t,r,i,s,o,u){if(e("#alertBox").length>0){if(e("#alertBox").css("display")==="none"){e("#alertBox .confirm-info p").html(t);var a=r,f=i,l=e("#alertBox .btn-primary");l.html(a),s?e("#alertBox .btn-del").length>0?"":l.after('<button class="btn btn-del">'+n.login.login33+"</button>"):e("#alert_msg_box .btn-del").remove(),s&&e("#alertBox .btn-del").bind("click",function(){e("#alertBox").hide(),y.deforceFocus(!0),e(document).off("focusin.dialog"),typeof u=="function"?u():""}),e("#alertBox .btn-primary").unbind("click").bind("click",function(){e("#alertBox").hide(),y.deforceFocus(!0),e(document).off("focusin.dialog"),typeof o=="function"?o():""}),e("#alertBox").show(),y.enforceFocus(e("#alertBox .confirm-window")),e("#skip-to-main-link").attr("tabindex","-1")}}else{var a=r,c='<div id="alertBox" class="confirm-window-box"><iframe class="shadow-bg" title="background"></iframe> <div class="confirm-window" tabindex="0"><div class=" confirm-info"><p>'+t+'</p></div><a class="close-window close-w" href="javascript:;" role="button"></a><div class="a-center top10"><button class="btn btn-primary">'+a+"</button></div></div></div>";e(c).prependTo("body"),e("#alertBox .close-window").bind("click",function(t){t.preventDefault(),e("#alertBox").hide(),y.deforceFocus(!0)}),e("#alertBox .btn-primary").unbind("click").bind("click",function(){e("#alertBox").hide(),y.deforceFocus(!0),typeof o=="function"?o():""})}s&&e("#alertBox .btn-del").length<=0&&(e("#alertBox .btn-primary").after('<button class="btn btn-del">'+i+"</button>"),e("#alertBox .btn-del").bind("click",function(){e("#alertBox").hide(),typeof u=="function"?u():""})),y.enforceFocus(e("#alertBox .confirm-window")),e("#skip-to-main-link").attr("tabindex","-1")},otherLogin:function(e){var t=location.protocol+"//b2c.csair.com",n=encodeURI(t+"/portal/user/login"),r=e.name=="QQ"?4:5,i=e.name=="QQ"?"client_id":"appid",s=e.url+"?response_type=code&"+i+"="+e.client_id+"&redirect_uri="+n+"&scope="+e.scope+"&state="+r;location.href=s},setPhoneType:function(t){var n,r=e(t);e.each(CountryCode,function(e,t){e==0?n='<li class="checked option"  data-value="'+(e+1)+'">'+t.name+"</li>":n+='<li data-num="'+t.num+'" data-value="'+(e+1)+'" class="option">'+t.name+"</li>"});var i=r.find("#phoneCode");e(n).appendTo(i),r.find(".select").setSelect()},SelectMsgBox:function(t,n,r){if(!typeof t==="object")return!1;var i="";t.hasOwnProperty("content")&&(i=t.content);var s="";t.hasOwnProperty("submit")&&(s+='<button class="btn btn-primary">'+t.submit+"</button>"),t.hasOwnProperty("delBtn")&&(s+='<button class="btn btn-del">'+t.delBtn+"</button>");var o='<div id="alert_msg_box" class="confirm-window-box"><iframe class="shadow-bg"></iframe> <div class="confirm-window"><div class="right confirm-info"><div class="left img"></div><p>'+i+'</p></div><a class="close-window close-w">&times;</a><div class="a-center top10">'+s+"</div></div></div>";e(o).prependTo("body"),e("#alert_msg_box .close-window").bind("click",function(){e("#alert_msg_box").remove()}),e("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){e("#alert_msg_box").remove(),typeof n=="function"?n():""}),e("#alert_msg_box .btn-del").unbind("click").bind("click",function(){e("#alert_msg_box").remove(),typeof r=="function"?r():""})},PsgAlertMsgBox:function(t,r,i){if(e("#alert_msg_box").length>0)e("#alert_msg_box").css("display")==="none"&&(e("#alert_msg_box .confirm-info p").html(t),e("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){e("#alert_msg_box").hide(),y.deforceFocus(),typeof r=="function"?r():""}),e("#alert_msg_box").show(),y.enforceFocus(e("#alert_msg_box .confirm-window")));else{var s='<div id="alert_msg_box" class="confirm-window-box"><iframe class="shadow-bg"></iframe> <div class="confirm-window confirm-window-passager" tabindex="0"><div class="right confirm-info"><div class="left img"></div><p>'+t+'</p></div><a href="#" class="close-window close-w">&times;</a><div class="a-center top10"><button class="btn btn-primary">'+n.login.login32+"</button></div></div></div>";e(s).prependTo("body"),e("#alert_msg_box .close-window").bind("click",function(t){t.preventDefault(),y.deforceFocus(),e("#alert_msg_box").hide()}),e("#alert_msg_box .btn-primary").unbind("click").bind("click",function(){y.deforceFocus(),e("#alert_msg_box").hide(),typeof r=="function"?r():""})}i&&e("#alert_msg_box .btn-del").length<=0&&(e("#alert_msg_box .btn-primary").after('<button class="btn btn-del">'+n.login.login33+"</button>"),e("#alert_msg_box .btn-del").bind("click",function(){typeof recallback=="function"?recallback():"",y.deforceFocus(),e("#alert_msg_box").hide()}))},setSearch:function(t){var n="";if(typeof t=="object"){var r=[];for(var i in t)t.hasOwnProperty(i)&&r.push(i+"="+e.trim(t[i]));n=r.join("&")}return n},getSearch:function(e){var t=(e||window.location.search).replace("?",""),n={};if(t.length===0)return{};t=t.split("&");for(var r=t.length-1;r>=0;r--){var i=t[r].match(/^(.*?)=(.*?)$/i);i&&(n[i[1]]=i.length===3?i[2]:!0)}return n},getDateString:function(e){return e?e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2):""},getTimeString:function(e){return e?e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2):""},getDate:function(e){return e&&typeof e=="string"?e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substr(6,2):""},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},getHanziNum:function(e){var e=Number(e);return"一二三四五六七八九".split("")[e]},getEnglishNum:function(e){var e=Number(e);return["One","Two","Three","Four","Five","Six","Seven","Eight","Nine"][e]},getSubSite:function(){var t=e.cookie("language");return!!t&&/^[a-z]{2}_[a-z]{2}$/.test(t.toLowerCase())?(t=t.split("_")[0],t=t==="en"?"en":"cn"):t="cn",t},appendArray:function(t){var n="[";return e.each(t,function(e,t){n+="{";for(var r in t)n+='"'+r+'":"'+t[r]+'",';n=n.substring(0,n.length-1)+"},"}),n=n.substring(0,n.length-1)+"]",n},getDateObj:function(e){e=e||"";var t=new Date;if(y.getType(e)==="Number")return t.setTime(e),t;var n=e.match(/^(\d{4}).*?(\d{1,2}).*?(\d{1,2})$/i);return n&&n.length===4?(t.setFullYear(n[1],parseInt(n[2],10)-1,n[3]),t):!1},checkDateObj:function(e){var t=y.getDateObj(e);return t?!isNaN(t.getTime()):!1},getDateUnit:function(e){var t=y.getType(e);return t==="date"?{d:e,s:y.getDateString(e)}:t==="string"?{s:type,d:y.getDateObj(e)}:null},uAsterisk:function(e){var t="";return t=e.substr(0,4)+e.substr(4,4).replace(/\w/g,"*")+e.substr(8,4),t},getDateWith:function(t,n,r){var i={y:function(e){return this.setFullYear(this.getFullYear()+e),this},m:function(e){return this.setMonth(this.getMonth()+e),this},d:function(e){return this.setTime(this.getTime()+e*864e5),this},w:function(e){return i.d.call(this,e*7)}},s=function(e){var t=new Date;return t.setTime(e.getTime()),t},o=y.getType(t)==="date"?r?s(t):t:y.getDateObj(t);return e.each(n.match(/[+-]\d+[ymwd]/ig),function(e,t){var n=t.match(/[ymwd]/i).join("").toLowerCase();typeof i[n]=="function"&&i[n].call(o,parseInt(t,10))}),o},arraySum:function(e){var e=e,t=0;for(var n=0,r=e.length;n<r;n++)t+=parseInt(e[n]);return t},isMemberNumber:function(e){if(e.length==12){var t=/^[0-9]{12}$/;if(t.test(e)){var n=0,r=parseInt(e.substring(0,1));for(var i=1;i<12;i++)n+=parseInt(e.substring(i,i+1));if(r==n%7)return!0}}return!1},isChinaIDCard:function(e){e=e.toString();if(e.length==15){if(!y.isValidDate("19"+e.substr(6,2),e.substr(8,2),e.substr(10,2)))return!1}else{if(e.length!=18)return!1;if(!y.isValidDate(e.substr(6,4),e.substr(10,2),e.substr(12,2)))return!1}if(e.length==18){var t,n,r;if(!y.isNumber(e.substr(0,17)))return!1;t=parseInt(e.substr(0,1))*7+parseInt(e.substr(1,1))*9+parseInt(e.substr(2,1))*10,t=t+parseInt(e.substr(3,1))*5+parseInt(e.substr(4,1))*8+parseInt(e.substr(5,1))*4,t=t+parseInt(e.substr(6,1))*2+parseInt(e.substr(7,1))*1+parseInt(e.substr(8,1))*6,t=t+parseInt(e.substr(9,1))*3+parseInt(e.substr(10,1))*7+parseInt(e.substr(11,1))*9,t=t+parseInt(e.substr(12,1))*10+parseInt(e.substr(13,1))*5+parseInt(e.substr(14,1))*8,t=t+parseInt(e.substr(15,1))*4+parseInt(e.substr(16,1))*2,n=t%11,n==2?r=e.substr(17,1).toUpperCase():r=parseInt(e.substr(17,1));switch(n){case 0:if(r!=1)return!1;break;case 1:if(r!=0)return!1;break;case 2:if(r!="X")return!1;break;case 3:if(r!=9)return!1;break;case 4:if(r!=8)return!1;break;case 5:if(r!=7)return!1;break;case 6:if(r!=6)return!1;break;case 7:if(r!=5)return!1;break;case 8:if(r!=4)return!1;break;case 9:if(r!=3)return!1;break;case 10:if(r!=2)return!1}}else if(!y.isNumber(e))return!1;return!0},isValidDate:function(e,t,n){return e>2200||e<1900||!y.isNumber(e)?!1:t>12||t<=0||!y.isNumber(t)?!1:n>31||n<=0||!y.isNumber(n)?!1:!0},isNumber:function(e){if(!e)return!1;var t=new RegExp("^[0-9]*$");if(!t.test(e))return!1;try{if(parseInt(e,10)!=e)return!1}catch(n){return!1}return!0},istelNum:function(e){if(!e)return!1;var t=new RegExp("^1[0-9]{10}$");return t.test(e)?!0:!1},isemail:function(e){if(!e)return!1;var t=new RegExp("^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$");return t.test(e)?!0:!1},getlogtype:function(e){var t=1,n=y.isMemberNumber(e);if(y.istelNum(e))t=4;else if(y.isemail(e))t=5;else if(n)t=1;else{var r=y.isChinaIDCard(e);r?t=2:t=3}return t},user:{checking:0,logged:!1,INFO:{},checkLogged:function(e){y.user.checking=1,userFunc("/B2C40/newBookingSimLoginServlet.do?type=ISLOGIN",null,function(t){y.user.checking=0,typeof e=="function"&&e(t)},!0)},getMemType:function(){var t=e.cookie("identifyStatus")==="Y",n=e.cookie("eBindMemberFlag")==="Y";if(y.user.logged){var t=e.cookie("identifyStatus")==="Y",n=e.cookie("eBindMemberFlag")==="Y",r=y.user.INFO.userType;return r==="1"?"mem":r==="8"?t&&n?"vmem":"bmem":"nomem"}return""},isMemberLogin:function(e,t,n,r){var i={};i.userId=e.accountName,i.passWord=e.pwd,i.memberType=e.memtype,i.loginType="1";if(r)var s=v+"/B2C40/user/login.ao?channel=MAP-B";else var s=v+"/portal/user/login";y.userFunc(s,i,t,!0,"",n)},memberLogin:function(e,t){e.certType="MemberNo";var n=e.accountName,r=e.pwd,i=y.getlogtype(n);e.userId=n,e.PWD=r,e.logtype=i;var s=v+"/B2C40/newBookingSimLoginServlet.do?type=MEMBER";y.userFunc(s,e,t,!0)},isNotMenberLogin:function(e,t,n){var r={};r.userId=e.phoneNo,r.vcode=e.vcode,r.memberType="2",r.loginType="2";var i=v+"/B2C40/user/login.ao";y.userFunc(i,r,t,!0,"",n)},notMenberLogin:function(t,n){var r=e("#userPhone").val(),i=e("#phoneMsg").val(),s=v+"/B2C40/newBookingSimLoginServlet.do?type=NOMEMBER&phoneNo="+r+"&configNo="+i;y.userFunc(s,t,n,!0)},otherLogin:function(t){e("body").unbind("QQuserLogged").bind("QQuserLogged",function(){y.otherLogin({client_id:"101195994",url:"https://graph.qq.com/oauth2.0/authorize",name:"QQ",scope:"get_user_info"})}),e("body").unbind("WXuserLogged").bind("WXuserLogged",function(){y.otherLogin({client_id:"wxb84b459d0ef05bf6",url:"https://open.weixin.qq.com/connect/qrconnect",name:"WX",scope:"snsapi_login"})}),typeof t=="function"&&t()},sendCode:function(e,t,n){var r={};r.userId=e.phoneNo,e.vcode!==""&&(r.vcode=e.vcode);var i=v+"/B2C40/user/passwordReset.ao";y.userFunc(i,r,t,!1,"get",n)},sendPhoneMsg:function(t,n){var r=e("#userPhone").val(),i="/B2C40/newBookingSimLoginServlet.do?type=GETCONFIG&phoneNo="+r;y.userFunc(i,t,n)},checkLogged:function(){e("body").triggerHandler("userChecked")},checklogined:function(){var t=!1;e.ajax({type:"post",url:"/B2C40/checkLogin/jaxb/checkLogin.ao",data:{flag:""},async:!1,dataType:"json",success:function(e){return e.success&&(t=!0,y.user.logged=e.success,y.user.INFO=e.data),t},error:function(){return t}})},checktyped:function(){var t=!1;return e.ajax({type:"post",url:"/B2C40/userRaffle/jaxb/queryAssociateType.ao",async:!1,dataType:"json",success:function(e){e&&e.hasOwnProperty("success")&&e.success&&(t=!0)}}),t},verifySMember:function(r,i,s){var o=n.ordermanager;tpl=t.template('<div class="shadow-box {{?it.lang==="en"}}enbox{{?}}" id="vf-dialog"><div class="shadow-bg"></div><div class="content-box"><div class="vf-top"><div class="vf-title">'+o.vf01+'</div><span class="vf-uid">{{=it.userId}}</span></div><form id="vf-form"><div class="vf-middle">'+o.vf02+' <input type="password" class="vf-ipt hide" id="vf-pwd" data-placeHolder="'+o.vf03+'" maxlength="10" name="passWord" ><input type="text" id="vf-pwdPH" class="vf-ipt place-holder" value="'+o.vf03+'"><div class="vf-msg"></div></div><div class="vf-bottom"><button type="button" class="vf-btn cancel">'+o.vf04+'</button> <button type="submit" class="vf-btn confirm">'+o.vf05+"</button></div></form></div></div>"),e("body").append(tpl({userId:y.uAsterisk(r),lang:n.lang}));var u=e("#vf-dialog");u.on("submit","#vf-form",function(t){t.preventDefault();if(u.hasClass("loading"))return;var a=e(this),f={userId:r},l=a.find("#vf-pwd"),c=l.val(),h=a.find(".vf-msg"),p=!0;a.removeClass("error"),h.text(""),!c||c===o.vf03?(p=!1,a.addClass("error"),h.text(o.errorMsg029)):/^\d{6,10}$/.test(c)||(p=!1,a.addClass("error"),h.text(o.vf03)),p&&(f.passWord=c,i==="mileage"&&(f.checkPwdType="mileage"),u.addClass("loading"),e.ajax({url:"/portal/user/checkMemberPwd",data:f,type:"POST",success:function(e){if(e.success)typeof s=="function"&&s(),u.remove();else{u.removeClass("loading");var t=e.errorCode;t==="SVC_0002"?(a.addClass("error"),h.text(o.vf07)):t==="SVC_0001"?(a.addClass("error"),h.text(o.vf08)):(a.addClass("error"),h.text(n.login.login61))}},error:function(){u.removeClass("loading"),y.AlertMsgBox(n.login.login61)}}))}).on("click",".cancel",function(){u.remove()}).find("input").each(function(){var t=e(this).data("placeHolder");e(this).on("focus",function(){if(e(this).hasClass("place-holder")){e(this).addClass("hide");var t=e(this).attr("id"),n=t.substr(0,t.length-2);e("#"+n).removeClass("hide").focus()}}).on("blur",function(){e(this).val()==""&&(e(this).addClass("hide"),e("#"+e(this).attr("id")+"PH").removeClass("hide"))})})}},getCode:function(t,n,r){if(e("#getCodeBox").length>0)return!1;var i=n?"&flag=nomemberLogin":"",s=r?"&userId="+r:"",o=e('<div class="alert-box" id="getCodeBox"><iframe class="shadow-bg"></iframe><div class="closer-filter"></div><div class="box-content"><form class="form" id="get-code-form"><div class="imgBox"><img src="" id="kaptchaImage" /><div class="img-helper">'+a.fl0102+'</div></div><div class="control-group"><div class="control-label">'+a.fl0103+'</div><div class="controls"><input type="text" maxlength="4" class="input" id="kaptchaInput" /><button class="flat-btn flat-main" type="submit">'+a.fl0104+'</button><div class="help-text"></div></div></div></form></div></div>');o.find(".form").bind("submit",function(r){r.preventDefault();var i=e("#kaptchaInput"),o=i.val();o.length===4?n&&typeof t=="function"?(e("#getCodeBox").remove(),t(o)):y.verifyDialoglogin(t,1,!1,s):i.closest(".control-group").addClass("error").find("input ~.help-text").html(a.fl0086)}).find("#kaptchaImage").bind("click",function(t){t.preventDefault(),e(this).attr("src","/B2C40/GenerateVerifyCodeServlet.do?r="+Math.random()+i+s)}).trigger("click"),o.appendTo("body").find("#kaptchaInput").bind("keydown",function(t){t.keyCode==27&&e("#getCodeBox").remove()}).focus()},verifyDialoglogin:function(t,n,r,i){var s=e("#kaptchaInput").val(),o=i?i:"";e.ajax({type:"POST",url:"/B2C40/VerifyCodeServlet.do?verifyCode="+s,dataType:"xml",async:!1,complete:function(n){var r=n.responseText;if(r=="ok"){var i=e("#kaptchaInput"),s=i.val();e("#getCodeBox").remove(),t(s)}else alert(a.fl0087),e("#kaptchaImage").attr("src","/B2C40/GenerateVerifyCodeServlet.do?r="+Math.random()+o),e("#kaptchaInput").val("")}})},reloadflight:function(t,n){var r="";e.cookie("cache",!0);if(t.t==="S")r="t=S&c1="+t.c1.split("-")[0]+"&c2="+t.c1.split("-")[1]+"&d1="+t.d1+"&at="+t.at+"&ct="+t.ct+"&it="+t.it;else if(t.t==="R")r="t=R&c1="+t.c1.split("-")[0]+"&c2="+t.c1.split("-")[1]+"&d1="+t.d1+"&d2="+t.d2+"&at="+t.at+"&ct="+t.ct+"&it="+t.it;else if(t.t==="M"){r="t=M&at="+t.at+"&ct="+t.ct+"&it="+t.it+"&fl=";for(var i=1;t["d"+i.toString()];i++){var s=t["c"+i.toString()].split("-");i!==1&&(r+="|"),r+=s[0]+":"+s[1]+":"+t["d"+i.toString()].replace(/-/g,"")}}t.lang&&t.lang==="en"&&(r+="&lang=en");var o=t.preUrl;r=o?r+"&preUrl="+o:r;var u=t.nb?"&nb="+t.nb:"";n&&window.open?window.open("/B2C40/modules/bookingnew/main/flightSelectDirect.html?"+r+u):window.location.href="/B2C40/modules/bookingnew/main/flightSelectDirect.html?"+r+u},userFunc:function(t,n,r,i,s,o){s=s==="get"?s:"post",e.ajax({type:s,url:t,data:n,async:!1,dataType:"json",success:function(e){i&&e&&e.success&&(y.user.INFO=e.data,y.user.logged=!!e.data.userId),typeof r=="function"&&r(e)},error:function(e){typeof o=="function"&&o(e)}})},setTooltip:function(t,n){var r={direction:"r",width:"300px",height:"auto",padding:"0",delay:100},i,s=e(".tooltip-box"),o=function(t,n){var r=t.offset(),i={},o=e("body").height(),u=s.innerHeight(),a=0;switch(n.direction){case"t":i={top:r.top-u-7,left:r.left-(s.innerWidth()-t.innerWidth())/2},i.top<0&&(a=-i.top);break;case"b":i={top:r.top+t.innerHeight()+7,left:r.left-(s.innerWidth()-t.innerWidth())/2},o<i.top+u&&(a=o-i.top-u);break;case"l":i={top:r.top-(u-t.innerHeight())/2,left:r.left-s.innerWidth()-7};break;case"br":i={top:r.top+t.innerHeight()+7,left:r.left};break;case"bl":i={top:r.top+t.innerHeight()+7,left:r.left+t.innerWidth()-s.innerWidth()};break;default:n.direction="r",i={top:r.top-(u-t.innerHeight())/2,left:r.left+t.innerWidth()+7}}s.data("owner",t).removeClass("tooltip-l tooltip-r tooltip-t tooltip-b tooltip-br tooltip-bl").addClass("tooltip-"+n.direction).css(i).show(n.delay||0),s.find(".tooltip-content").css({top:a+"px"})};s.length===0&&(s=e('<div class="tooltip-box tooltip-r" id="tooltip-box" role="tooltip" aria-hidden="true"><div class="tooltip-arrows"><span class="arrow-left"></span><span class="arrow-right"></span></div><div class="tooltip-content"></div></div>').appendTo("body"),s.on("mouseenter",function(){u.show()}).on("mouseleave",function(){u.hide()}).on("fixPosition",function(e){var t=s.data("owner");o(t,t.data("tooltip-setting"))}));var u={show:function(){i&&clearTimeout(i);if(this.jquery){var e=this,t=e.data("tooltip-setting");i=setTimeout(function(){var n=typeof t.width=="function"?t.width.call(e):t.width,i=typeof t.content=="function"?t.content.call(e):t.content;if(i===!1||i===undefined||i.length<=0)return s.hide(),!1;s.css({width:n||r.width,height:t.height||"auto"}).attr("aria-hidden","false").find(".tooltip-content").css({padding:t.padding||""}).html(i),o(e,t)},t.delay)}},hide:function(e){i&&clearTimeout(i);var t=s.data("owner"),n=t&&t.data("tooltip-setting").delay||100;i=setTimeout(function(){s.attr("aria-hidden","true").removeAttr("style").find(".tooltip-content").empty()},n)},init:function(t){var n=this,i=e.extend({},r,{direction:n.data("direction")},t);this.data("tooltip-setting",i).addClass("hasTooltip").bind({mouseenter:function(e){u.show.call(n)},mouseleave:function(e){u.hide.call(n)}})},initOnDelgate:function(t,n){var i=this;this.on("mouseenter",n,function(n){var i=e(this),s=i.data("tooltip-setting");s==undefined&&(s=e.extend({},r,{direction:i.data("direction")},t),i.data("tooltip-setting",s)),u.show.call(i)}).on("mouseleave",n,function(t){u.hide.call(e(this))})}};return this.each(function(){var r=e(this);if(n&&n.length){var i=r.data("tooltip-delegate")||{};if(i[n])return!0;i[n]=!0,r.data("tooltip-delegate",i),u.initOnDelgate.call(r,t,n)}else r.hasClass("hasTooltip")||u.init.call(r,t)}),this},IsEmail:function(e){return(new RegExp("^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$")).test(e)},timestamp:function(e){var t=e.substring(0,4),n=e.substring(5,7),r=e.substring(8,10),i=e.substring(11,13),s=e.substring(14,16),o=e.substring(17,19),u={year:t,month:n,date:r,hour:i,minute:s,second:o},a=[u.year||"3000",u.month||"01",u.date||"01"],f=[u.hour||"0",u.minute||"0",u.second||"0"],l=Date.parse(new Date(u.year,u.month-1,u.date,u.hour,u.minute,u.second));return isNaN(l)?null:l},dateCompare:function(e,t,n){return e==null||n==null?!1:(e=y.timestamp(e+" 00:00:01"),t=y.timestamp(t),n=y.timestamp(n+" 23:59:59"),e<t&&t<n)},openNewWindow:function(e){window._open?window.open(e,n.payment.pl0068):(window._open=window.open,window.open=function(e,t,r,i){t==undefined&&(t="_blank"),r==undefined&&(r=""),i==undefined&&(i=!1);var s=window._open(e,t,r,i);return s?!0:(alert(n.payment.pl0067),!1)},window.open(e,n.payment.pl0068))},getCourrentDate:function(){return Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},(new Date).format("yyyy-MM-dd hh:mm:ss")},getWebByType:function(t,n){var r=[];return t.length==0&&t[0].idcard===n?1:(e.each(t,function(e,t){r.push(t.idcard)}),e.inArray(n,r)>-1?3:2)},showtip:function(e,t,n,r,i,s,o){e.poshytip({content:t,alignTo:"target",alignX:n,alignY:r,className:"tip-bluesimple",showTimeout:100,offsetX:i,offsetY:s,eleId:o})},showposhytip:function(e,t){e.poshytip({content:t,className:"inter-tip-bluesimple",alignTo:"target",alignY:"inner-top",offsetX:10,offsetY:-260,showTimeout:1,hideTimeout:50})},showposhytip1:function(e,t){e.poshytip({content:t,className:"inter-tip-bluesimple",alignTo:"target",alignX:"left",alignY:"bottom",offsetX:-40,offsetY:8,showTimeout:1,hideTimeout:50})},showposhytip2:function(e,t){e.poshytip({content:t,className:"inter-tip-bluesimple",showOn:"none",alignTo:"target",alignY:"inner-top",offsetX:10,offsetY:-260,showTimeout:1,hideTimeout:50})},settip:function(t){var n=e(this).closest(".control-group");n=n.length>0&&n.css("display")==="none"?!1:!0,n&&(e(this).poshytip({content:t,className:"tip-redsimple",showOn:"none",alignTo:"target",alignX:"center",alignY:"top",offsetX:0,offsetY:5,showTimeout:100,hideTimeout:50}),e(this).toggleClass("error",!!t),e(this).hasClass("error")?e(this).poshytip("show").on("focus",function(t){e(this).poshytip("hide")}):e(this).poshytip("hide"))},settippay:function(t){e(this).poshytip({content:t,className:"tip-redsimple",showOn:"none",alignTo:"target",alignX:"right",alignY:"center",offsetX:10,offsetY:5,showTimeout:100,hideTimeout:50}),e(this).toggleClass("error",!!t),e(this).hasClass("error")?e(this).poshytip("show").off("focus").on("focus",function(t){e(this).poshytip("hide")}):e(this).poshytip("destroy")},settip5:function(t){e(this).poshytip({content:t,className:"tip-redsimple",showOn:"none",alignTo:"target",alignX:"right",alignY:"center",offsetX:10,offsetY:5,showTimeout:100,hideTimeout:50}),e(this).toggleClass("error",!!t),e(this).hasClass("error")?e(this).poshytip("show").off("focus").on("focus",function(t){e(this).poshytip("hide")}):e(this).poshytip("destroy")},settip2:function(t){e(this).poshytip({content:t,className:"tip-yellowsimple",showOn:"none",alignTo:"target",alignX:"center",alignY:"top",offsetX:0,offsetY:5}),e(this).poshytip("show").off("focus").on("focus",function(t){e(".tip-yellowsimple").remove()})},settip3:function(){e(this).poshytip({content:e(this).attr("rel"),bgImageFrameSize:19,className:"inter-tip-yellowsimple",alignTo:"target",alignX:"inner-left",offsetX:0,offsetY:5,showTimeout:1,hideTimeout:50})},showAlertBox:function(t){e("#alert_box").removeClass("hide").find("p").html(t),y.enforceFocus(e("#alert_box"))},stringFormat:function(e){if(typeof e=="undefined"||e==null)return"";var t="PREFIX ".concat(e),n=t.split("%s"),r=t;if(n!=null&&n.length>1){r=n[0];for(var i=1;i<n.length;i++)i<arguments.length?r=r.concat(arguments[i]):r=r.concat("%s"),r=r.concat(n[i])}return r.substring(7)},trim:function(e,t){var n;return n=e.replace(/(^\s+)|(\s+$)/g,""),t.toLowerCase()=="g"&&(n=n.replace(/\s/g,"")),n},checkNumformat:function(e,t,n){return e=Number(e),t=Number(t),n=Number(n),e&&e>0&&t>=0&&n>=0&&e+t+n<=9&&e>=n&&t<=e*2},getDivPos:function(e){if(e.length>0){var t=e.offset();return t}return!1},creaDropDown:function(t,n,r){var i=e("#"+n);if(!(i.length>0&&t))return!1;var s="",o=e("#"+r),u=e("input[name=c_email]");for(var a=0;a<t.length;a++)(t[a].mobilePhone||t[a].mobilePhone==="")&&t[a].contactName&&(s+='<li data-mobile="'+t[a].mobilePhone+'" data-email="'+t[a].email+'" data-cpid="'+t[a].cpId+'" class="key">'+t[a].contactName+"</li>");if(s==="")return!1;var f=y.getDivPos(i),l=Number(f.top)+Number(i.outerHeight())-1;s='<div class="contactorSelector" style="top:'+l+"px; left:"+f.left+'px; display:none;"><div class="contactorBox" id="contactorBox"><div class="allContactor"><ul>'+s+"</ul></div></div></div>",e("body").append(s);var c=e("#contactorBox"),h=c.closest(".contactorSelector");i.bind("click",function(){f=y.getDivPos(i),i.removeClass("error"),l=Number(f.top)+Number(i.outerHeight())-1,h.css({top:l,left:f.left}).show().find("li").addClass("key").show();var t=c.find("li");e.trim(i.val())!=""&&t.removeClass("key")&&t.hide();for(var n=0;n<t.length;n++)t.eq(n).html().indexOf(i.val())==0&&t.eq(n).addClass("key").show()}).bind("blur",function(){setTimeout(function(){h.hide().find("li.on").removeClass("on")},200)}).bind("keyup",function(t){var n=c.find("li.key"),r=Number(n.outerHeight()),s=Number(c.outerHeight()),a=-1,f=t.which;if(f==38||f==40||f==13)for(var l=0;l<n.length;l++)if(n.eq(l).hasClass("on")){a=l;break}switch(f){case 38:a>0&&(n.eq(a).removeClass("on"),n.eq(a-1).addClass("on"),s<a*r&&c.scrollTop(Number(c.scrollTop())-r));break;case 40:a<n.length-1&&(n.eq(a).removeClass("on"),n.eq(a+1).addClass("on"),s<(a+1)*r&&c.scrollTop(Number(c.scrollTop())+r));break;case 13:i.val(n.eq(a).html()),i.removeClass("error"),o.length>0&&n.eq(a).data("mobile")&&o.attr("mobile",n.eq(a).data("mobile")).val(y.mobliehide(n.eq(a).data("mobile"))),u.length>0&&u.val(n.eq(a).data("email")),h.hide()}var p=c.find("li");if(f>=48&&f<=57||f>=65&&f<=90||f==32||f==8||f==191){e.trim(i.val())!=""&&p.removeClass("key")&&p.hide();for(var l=0;l<p.length;l++)p.eq(l).html().indexOf(i.val().toUpperCase())==0&&p.eq(l).addClass("key").show();p.closest("ul").find(".disableclick").show()}}),e("#contactorBox").on("click","li",function(){var t=e(this);if(t.hasClass("disableclick"))return!1;i.removeClass("error").poshytip("hide"),i.val(t.html()).data("cpid",t.data("cpid")),o.length>0&&t.data("mobile")&&o.val(y.mobliehide(t.data("mobile")))&&o.attr("mobile",t.data("mobile")),u.length>0&&u.val(t.data("email")),h.hide()}).on("mouseover","li",function(){e(this).addClass("on").siblings(".on").removeClass("on")}).on("mouseout","li",function(){e(this).removeClass("on")})},clearErrorInfo:function(){e(".tip-redsimple").each(function(t){e(this).remove()})},checkOrderPayd:function(t){var n=!1;return e.ajax({type:"POST",url:"/B2C40/showPay/PaySuccess/jaxb/checkPaySuccess.ao",data:{orderno:t},dataType:"json",async:!1,error:function(){n=!1},success:function(e){payStatus=e.payStatus?e.payStatus.toUpperCase():"",payStatus=="B"||payStatus=="T"||payStatus=="O"||payStatus=="R"||payStatus=="E"?n=!0:n=!1}}),n},checkMesInput:function(t,n){var r=!0;if(arguments.length==0){var i=e("#userMes .ctrl-unit");i.each(function(){var t=e(this),n=t.find(".input"),i=n.val(),s=t.find(".help-text");t.css("display")!=="none"&&(i?t.hasClass("memberNo")&&!/^[0-9a-zA-Z]*\d+[0-9a-zA-Z]*$/i.test(i)&&!/^\d{4}\-\d{2}\-\d{2}$/i.test(i)?(t.addClass("error"),s.html(l.cp002),r=!1):t.hasClass("mobile")&&!/^\d{11}$/i.test(i)?(t.addClass("error"),s.html(l.cp004),r=!1):t.hasClass("email")&&!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(i)&&(t.addClass("error"),s.html(l.cp005),r=!1):(t.addClass("error"),s.html(l.cp001),r=!1))})}else e("."+t).addClass("error"),e("."+t).find(".help-text").html(n),r=!1;return r},couponFailDialog:function(t,n){var r,i,s="",o="";n&&(r=n.url,i=n.txt,s='<a href="'+r+'" class="btn red">'+i+"</a>"),o='<div class="shadow-box" id="couponFail"><iframe class="shadow-bg"></iframe><div class="content-box"><div class="text-content"></div><div class="btn-group"><a href="javascript:;" class="btn red close-btn">返回</a>'+s+"</div></div></div>",e(o).appendTo("body"),e("#couponFail .text-content").html(t),e(".close-btn").on("click",function(){e("#couponFail").remove()})},getMesValue:function(t){var n=e(".ctrl-unit"),r={};for(var i in t)if(i!="mobileRandCode"){var s=e("."+i).find(".input").val();r[i]=s}return r.randCode=t&&t.mobileRandCode?e(".mobileRandCode").find(".input").val():e(".userRandCode").find(".input").val(),r},userMesDialog:function(t,n){var r='<div class="shadow-box shadow-blue" id="userMes"><iframe class="shadow-bg"></iframe><div class="content-box"><div class="shadow-box-head"><a href="javascript:;" class="icon-closer closer">x</a></div><div class="sp-bookway-box"><div class="sp-bookway-head">'+l.cp006+'</div><div class="sp-bookway-content"><p>'+l.cp007+'</p><form class="form form-horizontal"><div class="ctrl-unit idCard" ><div class="ctrl-label"><span class="space3">'+l.cp008+'</span></div><input type="text" class="input greyfont"  maxlength="30"/><span class="help-text"></span></div><div class="ctrl-unit memberNo" name><div class="ctrl-label">'+l.cp009+'</div><input type="text" class="input greyfont" maxlength="30"/><span class="help-text"></span></div><div class="ctrl-unit mobile"><div class="ctrl-label"><span class="space1">'+l.cp010+'</span></div><input type="text" class="input greyfont" id="userPhone" maxlength="30"/><span class="help-text"></span></div><div class="ctrl-unit mobileRandCode"><input type="text" class="input greyfont code"  maxlength="6" id="phoneMsg"/><a class="flat-btn auto getcode" id="sendPhone" href="javascript:;">'+l.cp011+'</a><span class="help-text"></span></div><div class="ctrl-unit userRandCode"><div class="ctrl-label"><span class="space3">'+l.cp011+'</span></div><input type="text" class="input greyfont code" id="captcha" name="captcha" maxlength="6" name=""/><img src="" id="checkImg" src="captcha"/><a href="javascript:;" id="changeImg">换一张?</a><span class="help-text"></span></div><div class="ctrl-unit email"><div class="ctrl-label"><span class="space1">'+l.cp012+'</span></div><input type="text" class="input greyfont" maxlength="30"/><span class="help-text"></span></div><div class="form-action"><button class="flat-btn submit" type="submit">'+l.cp013+"</button></div></form></div></div></div></div>";e("body").append(r),e("#changeImg").on("click",function(){e(this).siblings("#checkImg").attr("src","/B2C40/query/jaxb/captcha/image.ao?d="+(new Date).getTime())}).trigger("click"),n||e(".idCard").find(".ctrl-label").html('<span class="space1">姓</span>名'),e(".userRandCode").hide();for(var i in t)t[i]||(e("."+i).hide(),i=="mobileRandCode"&&e(".userRandCode").show());e("#userMes .closer").on("click",function(){e("#userMes").remove()}),e(".input").on("change",function(){e(this).val()!=""&&(e(this).closest(".ctrl-unit").removeClass("error"),e(this).siblings(".help-text").html(""))}),e("#sendPhone").unbind("click").bind("click",function(t){t.preventDefault(),e(".mobile").remove("error").children(".help-text").html(""),e(".mobileRandCode").remove("error").children(".help-text").html("");var n=e(this);if(n.hasClass("working"))return!1;var r=!0,i=e(".mobile").children(".input").val();i==""?(y.checkMesInput("mobile",l.cp001),r=!1):/^\s*([\d]{11})\s*$/.test(i)||(y.checkMesInput("mobile",l.cp004),r=!1),r&&(n.addClass("working").addClass("loading"),e.ajax({type:"post",url:"/B2C40/data/account/getVcode.xsql?method=H&mobilestr="+i+"&code=",dataType:"text",contentType:"application/text; charset=utf-8",complete:function(t){var r=t.responseXML;if(e(r).find("xsql-error").length>0){n.removeClass("loading").removeClass("working");if(e(r).find("message:first").text()=="refused send"||e(r).find("message:first").text()=="already 5 times"){alert(l.cp014);return}if(e(r).find("message:first").text()=="less than 10s"){alert(l.cp015);return}}n.removeClass("loading").addClass("working"),o=120,timmer=setInterval(function(){y.refreshTimeMsg("sendPhone")},1e3),alert(l.cp016)}}))}),e("#userMes").bind("submit",function(r){r.preventDefault();var i=y.checkMesInput();if(i)if(!n){t||(t={mobile:e("#userPhone").val(),mobileRandCode:!0});var s=y.getMesValue(t);e.ajax({type:"post",url:"/B2C40/userRaffle/jaxb/saveAssociateType.ao",data:s,dataType:"json",success:function(t){t?t.success?e("body").triggerHandler("userMesChecked"):t.data=="验证码不正确"?y.checkMesInput("mobileRandCode",l.cp022):t.data.indexOf("该手机使用次数达到或超过5次")>-1?alert("该手机使用次数达到或超过5次，建议您更换一个手机号绑定。"):alert(t.data):y.AlertMsgBox(l.cp024)}})}else e("body").triggerHandler("userMesChecked")})},checksendUserInfo:function(){var t=!0,n=e("#saveUserInfo .ctrl-unit");return n.each(function(){var n=e(this),r=n.find(".input"),i=r.val(),s=n.find(".help-text");i?n.hasClass("mobile")&&!/^\d{11}$/i.test(i)&&(n.addClass("error"),s.html(l.cp004),t=!1):(n.addClass("error"),s.html(l.cp001),t=!1)}),t},sendUserInfo:function(t){var n=e("#saveUserInfo .input"),r={};return r.consigneeName=n.eq(0).val(),r.consigneePhone=n.eq(1).val(),r.consigneeAddress=n.eq(2).val(),r.activitiesId=t,r},saveUserInfoShow:function(t){var n='<div class="shadow-box shadow-blue" id="saveUserInfo"><iframe class="shadow-bg"></iframe><div class="content-box"><div class="shadow-box-head"><a href="javascript:;" class="icon-closer closer">x</a></div><div class="sp-bookway-box"><div class="sp-bookway-head">'+l.cp032+'</div><div class="sp-bookway-content"><form class="form form-horizontal"><div class="ctrl-unit idCard" ><div class="ctrl-label"><span class="space3">'+l.cp028+'</span></div><input type="text" class="input greyfont"  maxlength="30"/><span class="help-text"></span></div><div class="ctrl-unit mobile" name><div class="ctrl-label">'+l.cp029+'</div><input type="text" class="input greyfont" maxlength="30"/><span class="help-text"></span></div><div class="ctrl-unit address"><div class="ctrl-label">'+l.cp030+'</div><input type="text" class="input greyfont" id="userPhone" maxlength="30"/><span class="help-text"></span></div><div class="form-action"><button class="flat-btn submit" type="submit">'+l.cp031+"</button></div></form></div></div></div></div>";e("body").append(n),e("#saveUserInfo .closer").on("click",function(){e("#saveUserInfo").remove()}),e("#saveUserInfo .input").on("change",function(){e(this).val()!=""&&(e(this).closest(".ctrl-unit").removeClass("error"),e(this).siblings(".help-text").html(""))}),e("#saveUserInfo").bind("submit",function(n){n.preventDefault();var r=y.checksendUserInfo();if(r){var i=y.sendUserInfo(t);e.ajax({type:"post",url:"/B2C40/userRaffle/jaxb/saveConsigneeInfo.ao",data:i,dataType:"json",success:function(t){t&&t.hasOwnProperty("result")&&t.result?e("body").triggerHandler("saveUserInforesult"):y.AlertMsgBox(l.cp033)}})}})},mobliehide:function(e){return this.moblie=e.toString(),/^\d{3,14}$/.test(e)?(this.len=this.moblie.length,this.moblie.substr(0,this.len/3)+this.moblie.substr(Math.round(this.len*2/3)).replace(/\d/g,"*")+this.moblie.substr(this.len*2/3)):""},mileageSearchBox:function(t){var r=n.searchBox,i=h?"预订流程-国际航班选择-重新查询":"预订流程-航班选择-重新查询",s='<form id="ticketbooking" method="post"><div class="flightTab" id="flightTab"><div class="flightTabH"><ul class="clearfix" role="listbox" tabindex="0" aria-label="'+n.mileage.mil712+'"><li class="current" tabindex="0" role="option" aria-label="'+r.search01+'" aria-pressed="true" data-val="1">'+r.search01+'</li><li data-val="2" role="option" aria-pressed="false" aria-label="'+r.search02+'">'+r.search02+'</li><input id="segtype" type="hidden" value="1" name="segtype"><div class="search-radio"></div></ul></div><div class="flightCon" id="searchForm"><ul class="clearfix"><li class="clearfix"><label for="fromcity" class="fightTxt">'+r.search04+'</label><div class="flightF nomarginR"><input class="flightInput choose-city" type="text"  role="combobox" aria-activedescendant="ui-city-list" aria-controls="fromcity-info" id="fromcity" name="fromcity" value="" /><input id="city1_code" type="hidden" name="city1_code" value=""></div></li><li class="changeicon"><a href="javascript:;" role="button" aria-label="Reverse Origin And Destination" class="changecity" id="changecity"></a></li><li class="clearfix"><label for="tocity" class="fightTxt">'+r.search05+'</label><div class="flightF"><input class="flightInput choose-city" role="combobox" aria-activedescendant="ui-city-list" aria-controls="tocity-info" id="tocity" type="text" value="" name="tocity" /><input id="city2_code" type="hidden" name="city2_code" value=""></div></li><li class="clearfix"><label for="DepartureDate" class="fightTxt">'+r.search06+'</label><div class="flightF"><input class="flightInput choose-date" id="DepartureDate" aria-controls="DepatureDate-info" type="text" value="" name="DepartureDate" /></div></li><li class="clearfix" aria-hidden="true" style="display:none;" id="returndateli"><label for="ReturnDate" class="fightTxt">'+r.search07+'</label><div class="flightF"><input class="flightInput choose-date" aria-controls="ReturnDate-info" id="ReturnDate" type="text" value="" name="ReturnDate" /></div></li><li class="fr"><a href="javascript:void(0);" class="searchBtn" otype="button" otitle="'+i+'">'+r.search08+'</a></li></ul></div></div><input id="cabin" type="hidden" value="经济舱" name="cabin"><input id="adult" type="hidden" value="1" name="adult"><input id="child" type="hidden" value="0" name="child"><input id="infant" type="hidden" value="0" name="infant"></form>';e(s).insertAfter("#mbx"),e("#flightTab .choose-city").setCities();var o=e("#flightTab .choose-date");o.eq(0).bind("change",function(){o.eq(1).setCalendarOpt("minDate",this.value)}).setCalendar({defaultDate:"+0d",minDate:"+0d",maxDate:"+1y"}).end().eq(1).setCalendar({defaultDate:"+1d",minDate:"+0d",maxDate:"+1y"}),e("#fromcity").val(t.n1.replace("--",":").split("-")[0].replace(":","--")),e("#tocity").val(t.n1.replace("--",":").split("-")[1].replace(":","--")),e("#city1_code").val(t.c1.split("-")[0]),e("#city2_code").val(t.c1.split("-")[1]),e("#DepartureDate").val(t.d1),e("#ReturnDate").val(y.getDateString(y.getDateWith(t.d1,"+1d"))),e("#segtype").val(1),t.t==="R"&&e("#flightTab li").eq(1).addClass("current").attr("aria-pressed","true").attr("tabindex","0").siblings(".current").removeClass("current").removeAttr("tabindex").attr("aria-pressed","false")&&e("#segtype").val(2)&&e("#ReturnDate").val(t.d2)&&e("#returndateli").show().attr("aria-hidden","false"),e("#flightTab").on("click",".searchBtn",function(n){n.preventDefault();var r=e("#segtype").val(),i=e("#fromcity").val(),s=e("#city1_code").val(),o=e("#tocity").val(),u=e("#city2_code").val(),a=e("#DepartureDate").val(),f=e("#ReturnDate").val(),l=t.hasOwnProperty("preUrl")?t.preUrl:"",c="CZ",h="",p="";e(this).mileageFlightSearch(r,i,s,o,u,a,f,t.at,t.ct,t.it,c,t.lang,l,p,h)}).find("ul").eq(0).on("click","li",function(){var n=e(this).data("val");e(this).addClass("current").attr("aria-pressed","true").attr("tabindex","0").siblings(".current").removeClass("current").attr("aria-pressed","false").removeAttr("tabindex"),n=="2"?e("#returndateli").show().attr("aria-hidden","false"):n=="1"?e("#returndateli").hide().attr("aria-hidden","true"):n=="3"&&(t&&t.lang&&t.lang==="en"?window.location.href=e.csairUrl().b2cUrl+"/B2C40/modules/bookingnew/manage/ticket_booking.jsp?fl=M&lang=en":window.location.href=e.csairUrl().b2cUrl+"/B2C40/modules/bookingnew/manage/ticket_booking.jsp?fl=M"),e("#segtype").val(n)}).on("keydown","li",function(t){if(/37|39/.test(t.keyCode)){t.preventDefault();var n=e(this).closest("ul"),r=n.find("li").index(t.target),i=n.find("li").length-1;t.keyCode===37&&(r=r>0?--r:i),t.keyCode===39&&(r=r<i?++r:0),n.find("li").eq(r).trigger("click").focus()}}),e("#changecity").changeCity("fromcity","tocity","city1_code","city2_code")},enforceFocus:function(t){e("#skip-to-main-link").attr("tabindex","-1"),e(".header").attr("aria-hidden","true"),e(".footer").attr("aria-hidden","true"),e("#contenter").attr("aria-hidden","true"),e(document).off("focusin.dialog").on("focusin.dialog",e.proxy(function(e){document!==e.target&&t[0]!==e.target&&!t.has(e.target).length&&t.trigger("focus")},t[0]))},deforceFocus:function(t){t&&(e(document).off("focusin.dialog"),e("#skip-to-main-link").attr("tabindex","0"),e(".header").attr("aria-hidden","false"),e(".footer").attr("aria-hidden","false"),e("#contenter").attr("aria-hidden","false"))},JPlaceHolder:{_check:function(){return"placeholder"in document.createElement("input")},init:function(e){this.fix(e)},initAlartLogin:function(e){this.fix(e)},fix:function(t){e("."+t+" :input[placeholder]").each(function(t,n){if(e(this).attr("type")==="text"){var r=e(this),i=r.attr("placeholder");r.val(i),r.addClass("greyfont"),r.on("focus",function(){r.val()==i&&(r.val(""),r.removeClass("greyfont"))}).on("blur",function(){r.val()==""&&(r.val(i),r.addClass("greyfont"))})}else if(e(this).attr("type")==="password")if(!y.JPlaceHolder._check()){var r=e(this),i=r.attr("placeholder"),s=e('<input type="text" value="'+i+'"/>');if(r.data("hasPlaceholder")==undefined||!r.data("hasPlaceholder"))r.after(s),r.data("hasPlaceholder",!0),s.attr("class",r.attr("class")),r.attr("id")==="passwordBus"&&(s.css("display","inline"),s.css({width:"128px"})),s.addClass("greyfont"),r.removeClass("greyfont"),r.hide(),r.val(""),s.on("focus",function(){s.hide(),r.show().focus()}),r.on("blur",function(){r.val()===""&&(r.hide(),s.show())})}else{var r=e(this);r.addClass("greyfont"),r.on("focus",function(){r.removeClass("greyfont")}).on("blur",function(){r.val()==""&&r.addClass("greyfont")}).on("change",function(){})}})}}};return e.fn.extend({refreshTimeMes:function(t,n){var r=e(this);r.html("<font color='red'>"+t+"</font>"+u.login31),t<=0&&(n!=undefined?r.html(n):r.html(u.login05),r.siblings(".phone").closest(".ctrl-unit").removeClass("error").find("input ~.help-text").html(""),r.removeClass("working").removeData("cooling"))},cooling:function(t){var n=e(this),r=!!n.data("cooling");return t?n.data("cooling",!0):n.removeData("cooling"),e(this)},setPhoneType:function(){var t,n=e(this);e.each(CountryCode,function(e,n){e==0?t='<li class="checked option"  data-value="'+(e+1)+'">'+n.name+"</li>":t+='<li data-num="'+n.num+'" data-value="'+(e+1)+'" class="option">'+n.name+"</li>"});var r=n.find(".phoneCode");e(t).appendTo(r),n.find(".select").setSelect()}}),y}),define("validator",["jquery","lang","app"],function(e,t,n){var r={Wi:[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],ValideCode:[1,0,"X",9,8,7,6,5,4,3,2],REG:{15:/^(\d{6})(\d{6})(\d{2})(\d)$/i,18:/^(\d{6})(\d{8})(\d{3})([0-9]|X)$/i,8:/^(\d{4})(\d{2})(\d{2})$/i},d_val:new Date,_checkIsDate:function(e){var t=e.match(this.REG[8]),n=this.d_val;return t.length===4?(t.shift(),t[1]=parseInt(t[1],10)-1,Date.prototype.setFullYear.apply(n,t),!isNaN(n.getTime())&&t[0]==n.getFullYear()&&t[1]==n.getMonth()&&t[2]==n.getDate()):!1},checkDate:function(e,t){return t===15?this._checkIsDate("19"+e)||this._checkIsDate("18"+e):this._checkIsDate(e)},checkValidateCode:function(e){var t=e.split(""),n=0;if(t.length===18){for(var r=0;r<17;r++)n+=parseInt(t[r],10)*this.Wi[r];return t[17].toUpperCase()==this.ValideCode[n%11]}return!1},checkCard:function(e,t){var n=e.match(this.REG[t]),r=!0;if(n&&n.length===5){var r=!0;r=this.checkDate(n[2],t),r&&t===18&&(r=this.checkValidateCode(e)),r&&t===15&&(r=15)}else r=!1;return r},isNIcard:function(e){var t=e.length;return t===15||t===18?this.checkCard(e,t):!1},formError:function(e){return this.closest(".control-group").toggleClass("error",!!e).find(".help-text").text(e||""),this},getDateStr:function(e){return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")},formateDate:function(e){var t=n.getDateObj(e);return t?this.getDateStr(t):""},psgNameREG:[/^[\u4E00-\u9fA5]{2,20}$/i,/^(?:(?:[A-Za-z]{2,53}\/[A-Za-z]{2,53})|(?:[A-Za-z]{1,49}\s[A-Za-z]{2,50}\/[A-Za-z]{2,50})|(?:[A-Za-z]{2,50}\/[A-Za-z]{2,50}\s[A-Za-z]{1,49}))$/i,/^[\u4E00-\u9fA5]{1,20}[A-Za-z]{2,}\s?[A-Za-z]{0,52}$/i],contactNameREG:[/^[\u4E00-\u9fA5]{0,9}$/i,/^(?:(?:[A-Za-z]{1,53}\/[A-Za-z]{1,53})|(?:[A-Za-z]{1,49}\s[A-Za-z]{1,50}\/[A-Za-z]{1,50})|(?:[A-Za-z]{1,50}\/[A-Za-z]{1,50}\s[A-Za-z]{1,49})|(?:[A-Za-z]{1,50})|(?:[A-Za-z]{1,49}\s[A-Za-z]{1,50}))$/i,/^[\u4E00-\u9fA5]{1,9}[A-Za-z]{0,}\s?[A-Za-z]{1,52}$/i],isPsgName:function(e,t){var n=e.length;return n>=2&&n<=55&&this.psgNameREG[0].test(e)||(t?!1:this.psgNameREG[1].test(e))||this.psgNameREG[2].test(e)},isContactName:function(e){var t=e.length;return t>=1&&t<=55&&this.contactNameREG[0].test(e)||this.contactNameREG[1].test(e)||this.contactNameREG[2].test(e)},isPName2:function(e){var t=e.length;return t<=28&&/^[a-z]+(?:\s?[a-z]+){0,2}\s?[a-z]+$/i.test(e)},isPName:function(e){var t=e.length;return t<=28&&/^[a-z]+\s?[a-z]+$/i.test(e)},isIntlLName:function(e){return e&&/^[a-z]+\s?[a-z]*$/i.test(e)},isIntlFName:function(e){return e&&/^[a-z]+(?:\s?[a-z]+){0,3}$/i.test(e)},checkIsDate:function(e){var t=e.split("-");if(t.length===3){var n=new Date(t[0],parseInt(t[1],10)-1,t[2]),r=this.getDateStr(n);return e===r}return!1},changeUpper:function(e){return e.toUpperCase()},isUnionpayCard:function(e){return/^[0-9]*$/g.test(e)}};return r}),jQuery.extend({Scroll:function(e){function n(e,n){var e=e||t.stepWidth,n=n-1||0,r=$(t.inner).css("margin-left");$(t.inner).stop().animate({"margin-left":"-="+e},t.animateTime,function(){var e=$(t.inner).find("li").toArray(),r=[];for(var o=0;o<e.length;o++)r[o]="<li>"+e[o].innerHTML+"</li>";var u=$.grep(r,function(e,t){return t>n}),a=$.grep(r,function(e,t){return t>n},!0);$(t.inner).children("ul").html(""),$(u).each(function(e,n){$(t.inner).children("ul").append(n)}),$(t.inner).children("ul").append(a.join("")),$(t.inner).css("margin-left",0),$(t.inner).find("ul li a").each(function(e,t){$(t).attr("name",e).click(function(){i($(this)),s($(this))})})})}function r(e,n){var e=e||t.stepWidth,n=-n||1,r=$(t.inner).css("margin-left"),o=$(t.inner).find("li").toArray(),u=[];for(var a=0;a<o.length;a++)u[a]="<li>"+o[a].innerHTML+"</li>";var f=$.grep(u,function(e,t){return t<o.length-n}),l=$.grep(u,function(e,t){return t<o.length-n},!0);$(t.inner).children("ul").html("").append(l.join("")),$(f).each(function(e,n){$(t.inner).children("ul").append(n)}),$(t.inner).css("margin-left","-="+e),$(t.inner).stop().animate({"margin-left":parseInt(r)},t.animateTime),$(t.inner).find("ul li a").each(function(e,t){$(t).attr("name",e).click(function(){i($(this)),s($(this))})})}function i(e){var i=t.cennum,s=e.attr("name"),o=s-i,u=Math.abs(t.stepWidth*o);return $(t.inner).is(":animated")||(o>0?n(u,o):o<0&&r(u,o)),!1}function s(e){var t=$("<div id='tooltip' class='closeX'><div></div><span class='closeImg'></span><p><img id='upimg' src=''/></p></div>");$("#tooltip").length<1&&$("body").after(t);var n=e.attr("data-src");n=$.cookie("language")==="en_CN"?n.split(".")[0]+"_en."+n.split(".")[1]:n,$("#upimg").attr("src",n),$("#tooltip").show(),$(".closeImg").click(function(){$(this).parent(".closeX").hide()}),$(".closebtn").click(function(){$("#tooltip").hide()}),$("body").one("click",function(){$("#tooltip").hide()})}var t=$.extend({stepWidth:130,waitTime:4e3,animateTime:500,inner:"",left:"",right:""},e);$(t.inner).find("ul li a").bind("click",function(){i($(this)),s($(this))}),$(t.left).click(function(){$(t.inner).is(":animated")||r()}),$(t.right).click(function(){$(t.inner).is(":animated")||n()})}}),define("scroll",function(){}),define("upgrades",["jquery","doT","lang","UI","app"],function(e,t,n,r,i){var s=!1,o="",u=n.flight,a=function(e,t){var t=t.toUpperCase();if(e==="A")return t==="F"?u.fl0008:u.fl0080;if(e==="F")return t==="P"?u.fl0008:u.fl0008;if(e==="J")return t==="J"?u.fl0009:u.fl0009;if(e==="W")return t==="S"?u.fl0010:u.fl0010;if(e==="SW")return u.fl0017;if(e==="LX")return u.fl0018;if(e==="BX")return u.fl0019},f={checkPsgBlock:function(){var t=e(".psgType1"),n=e(".psgType2"),r=!0;if(t.length!=0||n.length!=0)r=!1;return r},showNav:function(t){e(t).parents(".openClose").hide().siblings(".openClose").show()},closeNav:function(t){e(t).parents(".openClose").hide().siblings(".openClose").show()},checkFlightUpgrades:function(t){var n=[],r=t.checkflightUpgradeData,i=t.fgprice,s=t.oldprice,u=t.pinfo;return e.ajax({type:"POST",url:"/B2C40/query/jaxb/upgrades/check.ao",data:{xmlStr:r},async:!1,dataType:"json",success:function(e){if(e&&e.success&&e.data){var r=e.data,f=[];for(var l=0;l<r.segment.length;l++){var c=r.segment[l];if(c.segorder&&Number(c.segorder)>=0){upnum=Number(c.segorder);var h=u[upnum].hasOwnProperty(c.afterCabin)?u[upnum][c.afterCabin]:"";h=c.afterCabin=="O"?">9":h,f[upnum]=f[upnum]?f[upnum]:!1,!f[upnum]&&c.flag==="true"&&i[upnum][c.afterBasicCabin]&&h&&Number(/\d/.exec(h))>0&&(afterData={segorder:upnum,depport:c.depport,arrport:c.arrport,depportname:UI.getCityName(c.depport),arrportname:UI.getCityName(c.arrport),farediffer:c.farediffer,fgprice:i[upnum][c.afterBasicCabin],aftercabin:c.afterCabin,oldprice:s[upnum],newprice:c.price,farebasis:c.farebasis,fareno:c.fareno,condition:c.conditions,afterBasicCabin:c.afterBasicCabin,aftercabinname:a(c.afterBasicCabin,c.afterCabin),afterinfo:h,afterprice:c.price,beforecabin:t.beforecabin[upnum]},f[upnum]=!0,o+="<FLIGHT><DEPPORT>"+c.depport+"</DEPPORT>"+"<ARRPORT>"+c.arrport+"</ARRPORT>"+"<FLIGHTDATE>"+c.flightdate+"</FLIGHTDATE>"+"</FLIGHT>",n.push(afterData))}}}}}),n},checkPsgUpgrades:function(){var t=null;if(this.checkPsgBlock()&&o){var n="",r=e(".psgType0");if(!r||!r.length)return;for(var i=0;i<r.length;i++){var u=r[i],a=e(u),f=a.find(".psg-name-input").val(),l=a.find(".p-idType-sel").getSval().value,c=a.find(".psg-idType-input").val();if(!(a.hasClass("form-passed")&&f&&c))return;n+="<page><PASSENGER><PSGNAME>"+f+"</PSGNAME>"+"<IDTYPE>"+l+"</IDTYPE>"+"<IDCARD>"+c+"</IDCARD>"+"</PASSENGER><FLIGHTS>"+o+"</FLIGHTS><CHECKFLAG>false</CHECKFLAG></page>"}var h=n;e.ajax({type:"POST",url:"/B2C40/query/jaxb/upgrades/checkForTravelersUpgrade.ao",data:{xmlStr:h},dataType:"json",async:!1,success:function(e){if(e&&e.success&&e.data){var n=e.data;n.status==="true"&&(n.checkFlag&&(s=n.checkFlag),n.UUID&&(t={uuid:n.UUID,createdate:n.createdate}),t||(t=!0))}}})}return t}};return f});var cal,isFocus=!1,pickMode={second:1,minute:2,hour:3,day:4,month:5,year:6},topY=0,leftX=0;String.prototype.toDate=function(style){var y=this.substring(style.indexOf("y"),style.lastIndexOf("y")+1),M=this.substring(style.indexOf("M"),style.lastIndexOf("M")+1),d=this.substring(style.indexOf("d"),style.lastIndexOf("d")+1),h=this.substring(style.indexOf("h"),style.lastIndexOf("h")+1),m=this.substring(style.indexOf("m"),style.lastIndexOf("m")+1),s=this.substring(style.indexOf("s"),style.lastIndexOf("s")+1);if(s==null||s==""||isNaN(s))s=(new Date).getSeconds();if(m==null||m==""||isNaN(m))m=(new Date).getMinutes();if(h==null||h==""||isNaN(h))h=(new Date).getHours();if(d==null||d==""||isNaN(d))d=(new Date).getDate();if(M==null||M==""||isNaN(M))M=(new Date).getMonth()+1;if(y==null||y==""||isNaN(y))y=(new Date).getFullYear();var dt;return eval("dt = new Date('"+y+"', '"+(M-1)+"','"+d+"','"+h+"','"+m+"','"+s+"')"),dt},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"天一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Calendar.prototype.ReturnDate=function(e){this.dateControl!=null&&(this.dateControl.value=e),calendar.hide();if(this.dateControl.onchange==null)return;var t=this.dateControl.onchange.toString();t=t.substring(t.indexOf("ValidatorOnChange();")>0?t.indexOf("ValidatorOnChange();")+20:t.indexOf("{")+1,t.lastIndexOf("}"));var n=new Function(t);this.dateControl.changeEvent=n,this.dateControl.changeEvent()},Calendar.language={year:[[""],[""]],months:[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]],weeks:[["日","一","二","三","四","五"," 六"],["SUN","MON","TUR","WED","THU","FRI","SAT"]],hour:[["时"],["H"]],minute:[["分"],["M"]],second:[["秒"],["S"]],clear:[["清空"],["CLS"]],today:[["今天"],["TODAY"]],pickTxt:[["确定"],["OK"]],close:[["关闭"],["CLOSE"]]},Calendar.prototype.draw=function(){calendar=this;var mvAry=[];mvAry[mvAry.length]=' <div name="calendarForm" style="margin: 0px;">',mvAry[mvAry.length]='    <table width="100%" border="0" cellpadding="0" cellspacing="1" style="font-size:12px; background-color:#0093d0; height: 30px;">',mvAry[mvAry.length]="      <tr>",mvAry[mvAry.length]='        <th align="left" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+";width:16px;height:20px;",calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" name="prevMonth" type="button" id="prevMonth" value="&lt;" /></th>',mvAry[mvAry.length]='        <th align="center" width="98%" nowrap="nowrap"><select name="calendarYear" id="calendarYear" style="font-size:12px;"></select><select name="calendarMonth" id="calendarMonth" style="font-size:12px;',calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"></select></th>',mvAry[mvAry.length]='        <th align="right" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+";width:16px;height:20px;",calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" name="nextMonth" type="button" id="nextMonth" value="&gt;" /></th>',mvAry[mvAry.length]="      </tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]='    <table id="calendarTable" width="100%" style="border:0px solid #098bc4;background-color:#FFFFFF;font-size:12px;',calendar.DateMode>=pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" border="0" cellpadding="3" cellspacing="1">',mvAry[mvAry.length]="      <tr>";for(var i=0;i<7;i++)mvAry[mvAry.length]='      <th style="font-weight:normal;background-color:'+calendar.colors.tr_bg+";color:"+calendar.colors.tr_word+';">'+Calendar.language.weeks[this.lang][i]+"</th>";mvAry[mvAry.length]="      </tr>";for(var i=0;i<6;i++){mvAry[mvAry.length]='    <tr align="center">';for(var j=0;j<7;j++)j==0?mvAry[mvAry.length]=' <td style="cursor:default;color:'+calendar.colors.sun_word+';"></td>':j==6?mvAry[mvAry.length]=' <td style="cursor:default;color:'+calendar.colors.sat_word+';"></td>':mvAry[mvAry.length]=' <td style="cursor:default;"></td>';mvAry[mvAry.length]="    </tr>"}mvAry[mvAry.length]='      <tr style="',calendar.DateMode>=pickMode.day&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><td align="center" colspan="7">',mvAry[mvAry.length]='      <select name="calendarHour" id="calendarHour" style="font-size:12px;"></select>'+Calendar.language.hour[this.lang],mvAry[mvAry.length]='<span style="',calendar.DateMode>=pickMode.hour&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><select name="calendarMinute" id="calendarMinute" style="font-size:12px;"></select>'+Calendar.language.minute[this.lang]+"</span>",mvAry[mvAry.length]='<span style="',calendar.DateMode>=pickMode.minute&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><select name="calendarSecond" id="calendarSecond" style="font-size:12px;"></select>'+Calendar.language.second[this.lang]+"</span>",mvAry[mvAry.length]="      </td></tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]='      <div align="center" style="padding:4px 4px 4px 4px;background-color:'+calendar.colors.input_bg+';">',mvAry[mvAry.length]='        <input name="calendarClear" type="button" id="calendarClear" value="'+Calendar.language.clear[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:40px;height:20px;font-size:12px;cursor:pointer;"/>',mvAry[mvAry.length]='        <input name="calendarToday" type="button" id="calendarToday" value="',mvAry[mvAry.length]=calendar.DateMode==pickMode["day"]?Calendar.language.today[this.lang]:Calendar.language.pickTxt[this.lang],mvAry[mvAry.length]='" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:60px;height:20px;font-size:12px;cursor:pointer"/>',mvAry[mvAry.length]='        <input name="calendarClose" type="button" id="calendarClose" value="'+Calendar.language.close[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:45px;height:20px;font-size:12px;cursor:pointer"/>',mvAry[mvAry.length]="      </div>",mvAry[mvAry.length]=" </div>",this.panel.innerHTML=mvAry.join("");var obj=this.getElementById("prevMonth");obj.onclick=function(){calendar.goPrevMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.prevMonth=obj,obj=this.getElementById("nextMonth"),obj.onclick=function(){calendar.goNextMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.nextMonth=obj,obj=this.getElementById("calendarClear"),obj.onclick=function(){calendar.ReturnDate("")},this.calendarClear=obj,obj=this.getElementById("calendarClose"),obj.onclick=function(){calendar.hide()},this.calendarClose=obj,obj=this.getElementById("calendarYear"),obj.onchange=function(){calendar.update(calendar)},obj.onblur=function(){calendar.onblur()},this.calendarYear=obj,obj=this.getElementById("calendarMonth");with(obj)onchange=function(){calendar.update(calendar)},onblur=function(){calendar.onblur()};this.calendarMonth=obj,obj=this.getElementById("calendarHour"),obj.onchange=function(){calendar.hour=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarHour=obj,obj=this.getElementById("calendarMinute"),obj.onchange=function(){calendar.minute=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarMinute=obj,obj=this.getElementById("calendarSecond"),obj.onchange=function(){calendar.second=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarSecond=obj,obj=this.getElementById("calendarToday"),obj.onclick=function(){var e=calendar.DateMode!=pickMode["day"]?new Date(calendar.year,calendar.month,calendar.day,calendar.hour,calendar.minute,calendar.second):new Date;calendar.ReturnDate(e.format(calendar.dateFormatStyle))},this.calendarToday=obj},Calendar.prototype.bindYear=function(){var e=this.calendarYear;e.length=0;for(var t=this.beginYear;t<=this.endYear;t++)e.options[e.length]=new Option(t+Calendar.language.year[this.lang],t)},Calendar.prototype.bindMonth=function(){var e=this.calendarMonth;e.length=0;for(var t=0;t<12;t++)e.options[e.length]=new Option(Calendar.language.months[this.lang][t],t)},Calendar.prototype.bindHour=function(){var e=this.calendarHour;if(e.length>0)return;var t;for(var n=0;n<24;n++)t=("00"+n+"").substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.bindMinute=function(){var e=this.calendarMinute;if(e.length>0)return;var t;for(var n=0;n<60;n++)t=("00"+n+"").substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.bindSecond=function(){var e=this.calendarSecond;if(e.length>0)return;var t;for(var n=0;n<60;n++)t=("00"+n+"").substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.goPrevMonth=function(e){if(this.year==this.beginYear&&this.month==0)return;this.month--,this.month==-1&&(this.year--,this.month=11),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData()},Calendar.prototype.goNextMonth=function(e){if(this.year==this.endYear&&this.month==11)return;this.month++,this.month==12&&(this.year++,this.month=0),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData()},Calendar.prototype.changeSelect=function(){var e=this.calendarYear,t=this.calendarMonth,n=this.calendarHour,r=this.calendarMinute,i=this.calendarSecond;e[this.date.getFullYear()-this.beginYear].selected=!0,t[this.date.getMonth()].selected=!0,n[this.hour].selected=!0,r[this.minute].selected=!0,i[this.second].selected=!0},Calendar.prototype.update=function(e){this.year=e.calendarYear.options[e.calendarYear.selectedIndex].value,this.month=e.calendarMonth.options[e.calendarMonth.selectedIndex].value,this.date=new Date(this.year,this.month,1),this.bindData()},Calendar.prototype.bindData=function(){var e=this;if(e.DateMode>=pickMode.month)return;var t=this.getMonthViewArray(this.date.getFullYear(),this.date.getMonth()),n=this.getElementById("calendarTable").getElementsByTagName("td");for(var r=0;r<n.length;r++){n[r].style.backgroundColor=e.colors.td_bg_out,n[r].onclick=function(){return},n[r].onmouseover=function(){return},n[r].onmouseout=function(){return};if(r>t.length-1)break;n[r].innerHTML=t[r];if(t[r]!="&nbsp;"){n[r].bgColorTxt="td_bg_out";var i=new Date;n[r].isToday=!1,i.getFullYear()==e.date.getFullYear()&&i.getMonth()==e.date.getMonth()&&i.getDate()==t[r]&&(n[r].style.backgroundColor=e.colors.cur_bg,n[r].bgColorTxt="cur_bg",n[r].isToday=!0),e.dateControl!=null&&(i=e.dateControl.value.toDate(e.dateFormatStyle),i.getFullYear()==e.date.getFullYear()&&i.getMonth()==e.date.getMonth()&&i.getDate()==t[r]&&(e.selectedDayTD=n[r],n[r].style.backgroundColor=e.colors.sel_bg,n[r].bgColorTxt="sel_bg")),n[r].onclick=function(){e.DateMode==pickMode["day"]?(e.ReturnDate((new Date(e.date.getFullYear(),e.date.getMonth(),this.innerHTML)).format(e.dateFormatStyle)),$(e.dateControl).change()):(e.selectedDayTD!=null&&(e.selectedDayTD.style.backgroundColor=e.selectedDayTD.isToday?e.colors.cur_bg:e.colors.td_bg_out),this.style.backgroundColor=e.colors.sel_bg,e.day=this.innerHTML,e.selectedDayTD=this)},n[r].style.cursor="pointer",n[r].onmouseover=function(){this.style.backgroundColor=e.colors.td_bg_over},n[r].onmouseout=function(){e.selectedDayTD!=this&&(this.style.backgroundColor=e.colors[this.bgColorTxt])},n[r].onblur=function(){e.onblur()}}}},Calendar.prototype.getMonthViewArray=function(e,t){var n=[],r=(new Date(e,t,1)).getDay(),i=(new Date(e,t+1,0)).getDate();for(var s=0;s<42;s++)n[s]="&nbsp;";for(var s=0;s<i;s++)n[s+r]=s+1;return n},Calendar.prototype.getElementById=function(id){if(typeof id!="string"||id=="")return null;if(document.getElementById)return document.getElementById(id);if(document.all)return document.all(id);try{return eval(id)}catch(e){return null}},Calendar.prototype.getElementsByTagName=function(e,t){if(document.getElementsByTagName)return document.getElementsByTagName(t);if(document.all)return document.all.tags(t)},Calendar.prototype.getAbsPoint=function(e){var t=e.offsetLeft,n=e.offsetTop;while(e=e.offsetParent)t+=e.offsetLeft,n+=e.offsetTop;return{x:t,y:n}},Calendar.prototype.show=function(e,t){if(e==null)throw new Error("arguments[0] is necessary");this.dateControl=e;var n=new Date;this.date=e.value.length>0?new Date(e.value.toDate(this.dateFormatStyle)):n.format(this.dateFormatStyle).toDate(this.dateFormatStyle);if(this.panel.innerHTML==""||cal.dateFormatStyleOld!=cal.dateFormatStyle)this.draw(),this.bindYear(),this.bindMonth(),this.bindHour(),this.bindMinute(),this.bindSecond();this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.day=this.date.getDate(),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.second=this.date.getSeconds(),this.changeSelect(),this.bindData(),t==null&&(t=e);var r=this.getAbsPoint(t);this.panel.style.left=r.x+leftX+"px",this.panel.style.top=r.y+topY+e.offsetHeight+"px",this.panel.style.display="",this.container.style.display="",this.dateControl.isTransEvent||(this.dateControl.isTransEvent=!0,this.dateControl.onblur!=null&&(this.dateControl.blurEvent=this.dateControl.onblur),this.dateControl.onblur=function(){calendar.onblur(),typeof this.blurEvent=="function"&&this.blurEvent()}),this.container.onmouseover=function(){isFocus=!0},this.container.onmouseout=function(){isFocus=!1}},Calendar.prototype.hide=function(){this.panel.style.display="none",this.container.style.display="none",isFocus=!1},Calendar.prototype.onblur=function(){isFocus||this.hide()},define("setdate",function(){}),define("createOrder",["jquery","lang","app"],function(e,t,n){var r=null,i=null,s=null,o=!1,u=null,a=null,f=null,l=null,c=null,h=null,p=null,d=null,v=!1,m=null,g=null,y=[],b=null,w=null,E=!1,S=0,x=0,T={checkorder:function(t){var n="ok";return e.ajax({type:"POST",url:"/B2C40/order/jaxb/checkOrderCount.ao",dataType:"json",async:!1,complete:function(e){e&&e.status&&typeof t=="function"&&t(e.status)}}),n},create:function(e){r=e.insurance,i=e.segments,s=e.segtype,o=e.upgradeFlag,u=e.upgradeData,a=e.upgradeReportId,f=e.passengerData,h=e.preUrl,p=e.unionpay_cardno,d=e.generalizelink,y=e.sandsArray,c=null,m=e.selectconpun,g=e.selecthyzj,b=e.iszslconpun,w=e.conpunId,E=e.priceChange,S=e.ispreUrlsol,x=e.nb;for(var t=0;t<i.length;t++){var n=i[t],v=n.firstflight;v.pricegroup&&(l=!0,c=v.pricegroup+",")}return this.getOrderXml()},getOrderXml:function(e){var t=this.getOtherInfo(),n=this.getPassengerInfo();if(!n)return!1;var r=this.getSegmentInfo(),i="<PNRLISTS><PNRLIST><PNRNO/></PNRLIST></PNRLISTS>",s="";l&&h&&(s="<PREURL>"+c.substring(0,c.length-1)+"</PREURL>",p&&(s="<UNIONPAYCARDNO>"+p+"</UNIONPAYCARDNO>"));var o=this.getOtherInfo2(),u=this.getLuggageInfo(),a=this.getDiscountInfo(),f=E?"<PRICECHANGE>1</PRICECHANGE>":"",d=a?a+"<DISCOUNTFLAG>Y</DISCOUNTFLAG>":"<DISCOUNTFLAG>N</DISCOUNTFLAG>",v='<?xml version="1.0" encoding="utf-8"?><page><ORDER>'+t+n+r+u+i+o+s+d+f+"</ORDER></page>";return v},getPassengerInfo:function(){var s="",o=i[0].firstflight;for(var u in f)if(u!=="contactor"){var a=f[u],l="N";if(a.insurance&&a.insurance.length>0){a.insuranceResult={insuranceType:"",insuranceCost:0};var c=[];for(var p=0;p<a.insurance.length;p++){var v=a.insurance[p];v.chooseFlag&&(l="Y",a.insuranceResult.insuranceCost+=Number(v.insuranceCost),c.push(v.insuranceType))}l==="Y"&&(c.sort(),a.insuranceResult.insuranceType=c.join(""),a.insuranceResult.insuranceType=r[a.insuranceResult.insuranceType].insuranceType)}var m=a.pType,g=a.psgName,y="",b="",w="",E="",x="",N="",C="",k="",L="",A="",O=a.pMembernum?a.pMembernum:"",M=a.pUnionpay?a.pUnionpay:"";if(m===0){y=a.pIdType,b=a.pIdCard;if(y==="NI"){var _=T.getAgeByIdcard(b,o.depdate);_<12&&_>=2&&(m=1,x=_);if(d&&d.psgrtype&&d.psgrtype.indexOf("NID")>-1){var D=d.psgrtype.split("$"),P=-1;for(var H=0;H<D.length;H++)if(D[H].indexOf("age")>-1){P=e.trim(D[H].split(":")[1]);break}if(P!==-1){var B=T.checkAgeLimit(P,_);if(!B)return n.showAlertBox(t.passenger.psg331),!1}}}}else w=a.pBirthday,w&&(x=T.getAge(w,o.depdate)),m===1&&(y=a.pIdType,b=a.pIdCard),m===2&&(E=e("LI[id="+u+"]").find("div.psg-carry").getSval("text"));psgtype=S&&a.psolCard?S:m,s+="<PASSENGER>",s+="<NAME>"+g+"</NAME>",s+="<TYPE>"+psgtype+"</TYPE>",s+="<IDTYPE>"+y+"</IDTYPE>",s+="<IDCARD>"+b+"</IDCARD>",s+="<AGE>"+x+"</AGE>",s+="<BIRTHDATE>"+w+"</BIRTHDATE>",s+="<FPCOMPANY>"+C+"</FPCOMPANY>",s+="<FPCARDNO>"+N+"</FPCARDNO>",s+="<MOBILEPHONE>"+e.trim(k)+"</MOBILEPHONE>",s+="<EMAIL>"+e.trim(L)+"</EMAIL>",s+="<PNRNO></PNRNO>",s+="<CARRIEDBY>"+E+"</CARRIEDBY>",s+="<INSURANCE>"+l+"</INSURANCE>",S&&a.psolCard&&(s+="<DISABLEDSOLDIERSID>"+a.psolCard+"</DISABLEDSOLDIERSID>");if("Y"===l){var j=a.insuranceResult.insuranceType,F=a.insuranceResult.insuranceCost;if(!j||j==="")j="0";s+="<INSURANCETYPE>"+j+"</INSURANCETYPE>",F&&Number(F)>0?s+="<INSURANCECOST>"+F+"</INSURANCECOST>":s+="<INSURANCECOST>30</INSURANCECOST>"}var I="";h&&(d.tea.indexOf(h)!=-1||d.stu.indexOf(h)!=-1)&&(I+="<checkType>1</checkType>"),h&&d.cnv.indexOf(h)!=-1&&(I+="<checkType>2</checkType>",I+="<memberNum>"+e.trim(O)+"</memberNum>"),h&&d.ccm.indexOf(h)!=-1&&(I+="<checkType>3</checkType>",I+="<unionPay>"+e.trim(M)+"</unionPay>"),s+="<LARGECLIENTID>"+A+"</LARGECLIENTID>"+I+"<GXHTYPE/><GXHIDCARD/>"+"</PASSENGER>"}return"<PASSENGERS>"+s+"</PASSENGERS>"},getSegmentInfo:function(){var t="",n="",r=1,l=r,c=i[0].firstflight,p="";for(var d in f)if(d!=="contactor"){var m=f[d],g=m.pType;if(g===0){var E=m.pIdType,S=m.pIdCard;if(E==="NI"){var x=T.getAgeByIdcard(S,c.depdate);if(x<12&&x>=2){p="adult";break}}}else if(g===1){p="child";break}}p==="adult"?n+="<CHILDORADULT>"+p+"</CHILDORADULT>":n+="<CHILDORADULT></CHILDORADULT>";var N=!1,C=!1;o&&e("#recommendUpgrades").length!==0&&(N=!0);var k="";b?n+="<iszslconpun>true</iszslconpun>":n+="<iszslconpun>false</iszslconpun>";for(var L=0;L<i.length;L++){var c=i[L].firstflight,A=c.flytype==0?!0:!1;k===""&&c.hasOwnProperty("flytype")&&c.flytype==2&&(k="<SID>36</SID>");var O=c.codeshare===""?!1:!0;n+="<SEGMENT><SEGORDER>"+r+"</SEGORDER>",c.hasOwnProperty("productType")&&c.productType!==""&&(n+="<PRODUCTTYPE>"+c.productType+"</PRODUCTTYPE>"),w.length>0&&w[L]?n+="<RECEIVECOUPONID>"+w[L]+"</RECEIVECOUPONID>":n+="<RECEIVECOUPONID></RECEIVECOUPONID>",c.hasOwnProperty("cabininfo")&&(n+="<leftSeats>"+c.cabininfo+"</leftSeats>");if(c.pinfo){var M="",_=null;for(var D in c.pinfo){var _=c.pinfo[D]+"";_.indexOf(">")>-1&&(_=_.replace(/\>/g,"")),M+=D+":"+_+","}n+="<bookingClassAvails>"+M.substr(0,M.length-1)+"</bookingClassAvails>"}n+="<codeshare>"+O+"</codeshare>",n+="<isDirect>"+A+"</isDirect>",h&&(n+="<cooperateCode>"+h+"</cooperateCode>"),c.pricegroup&&(n+="<PREURL>"+c.pricegroup+"</PREURL>"),n+="<CARRIER>"+c.flightno.substring(0,2)+"</CARRIER>",n+="<FLIGHTNO>"+c.flightno.substring(2)+"</FLIGHTNO>",O&&(n+="<OC>"+c.codeshareinfo.substring(0,2)+"</OC>",n+="<OCFLIGHTNO>"+c.codeshareinfo.substring(2)+"</OCFLIGHTNO>"),n+="<DEPAIRPORT>"+c.depport+"</DEPAIRPORT>",n+="<ARRAIRPORT>"+c.arrport+"</ARRAIRPORT>",n+="<DEPTIME>"+c.depdate+" "+this.replaceTime(c.deptime)+":00</DEPTIME>",n+="<ARRTIME>"+c.arrdate+" "+this.replaceTime(c.arrtime)+":00</ARRTIME>",v?n+="<SANDSFLAG>"+y[L]+"</SANDSFLAG>":n+="<SANDSFLAG>0</SANDSFLAG>";if(c.hasOwnProperty("comCode")&&c.comCode){var P="<CODE>"+c.comCode+"</CODE>";n+=P}var H=!1,B=null,j=r-1,F=c.depport+c.arrport;if(N){var I=null;s==="S"?i[0].segmenttype=="0"?(I=e("A[data-order='"+j+"'][data-city='"+F+"']"),I.parent().find("INPUT[name='checkbox']").attr("checked")&&(H=!0,C=!0)):i[0].segmenttype=="3"&&(I=e("DIV[data-order='"+j+"'][data-city='"+F+"']"),I.hasClass("checked")&&(H=!0,C=!0)):s!=="S"&&(I=e("DIV[data-order='"+j+"'][data-city='"+F+"']"),I.hasClass("checked")&&(H=!0,C=!0));for(var q=0;q<u.length;q++){var R=u[q];if(R.segorder*1==j*1&&R.depport===c.depport&&R.arrport===c.arrport){B=R;break}}}n+="<PLANETYPE>"+c.planetype+"</PLANETYPE>",n+="<AIRPORTTAX>"+c.tax+"</AIRPORTTAX>";if(N){n+="<UPCABINTYPE>"+H+"</UPCABINTYPE>",C&&H&&B?(n+="<CABIN>"+B.aftercabin+"</CABIN>",n+="<UPCABININFO>"+B.afterinfo+"</UPCABININFO>",n+="<ADULTPRICE>"+B.newprice+"</ADULTPRICE>",n+="<ADULTFAREBASIS>"+B.farebasis+"</ADULTFAREBASIS>",n+="<FAREREFERENCE>"+B.fareno+"</FAREREFERENCE>",n+="<UPCABINCODE>B2CTJP</UPCABINCODE>",n+="<FARERESTRICTION>"+B.condition+"</FARERESTRICTION>",n+="<CHFARERESTRICTION>"+B.condition+"</CHFARERESTRICTION>",n+="<INFARERESTRICTION>"+B.condition+"</INFARERESTRICTION>",n+="<FCABINPRICE>"+c.fgprice[B.afterBasicCabin]+"</FCABINPRICE>",n+="<UPADULTPRICE>"+B.newprice+"</UPADULTPRICE>",n+="<UPFAREDIFF>"+B.farediffer+"</UPFAREDIFF>",n+="<PCABINPRICE>"+B.afterprice+"</PCABINPRICE>"):(n+="<CABIN>"+c.cabinname+"</CABIN>",n+="<ADULTPRICE>"+c.price[0]+"</ADULTPRICE>",n+="<ADULTFAREBASIS>"+c.farebasis[0]+"</ADULTFAREBASIS>",n+="<FAREREFERENCE>"+c.farereference[0]+"</FAREREFERENCE>",n+="<FARERESTRICTION/>",n+="<CHFARERESTRICTION/>",n+="<INFARERESTRICTION/>",n+="<FCABINPRICE></FCABINPRICE>",n+="<UPADULTPRICE></UPADULTPRICE>",n+="<UPFAREDIFF></UPFAREDIFF>",n+="<PCABINPRICE></PCABINPRICE>"),p==="adult"?(n+="<CHILDPRICE>"+c.price[0]+"</CHILDPRICE>",n+="<CHILDFAREBASIS>"+c.farebasis[0]+"</CHILDFAREBASIS>"):(n+="<CHILDPRICE>"+c.price[1]+"</CHILDPRICE>",n+="<CHILDFAREBASIS>"+c.farebasis[1]+"</CHILDFAREBASIS>"),n+="<INFANTPRICE>"+c.price[2]+"</INFANTPRICE>",n+="<INFANTFAREBASIS>"+c.farebasis[2]+"</INFANTFAREBASIS>",n+="<CHILDFAREREFERENCE>"+c.farereference[1]+"</CHILDFAREREFERENCE>",n+="<INFANTFAREREFERENCE>"+c.farereference[2]+"</INFANTFAREREFERENCE>";var U=T.getMinIndex(c.minprice);n+="<PRECABIN>"+c.cabinname+"</PRECABIN>",n+="<PREADULTPRICE>"+c.price[0]+"</PREADULTPRICE>",n+="<MINPRICE>"+c.minprice[U]+"</MINPRICE>",n+="<MINCABIN>"+c.mincabin[U]+"</MINCABIN>",n+="<UPTYPE>0</UPTYPE>"}else{n+="<CABIN>"+c.cabinname+"</CABIN>",n+="<ADULTPRICE>"+c.price[0]+"</ADULTPRICE>",n+="<INFANTPRICE>"+c.price[2]+"</INFANTPRICE>",n+="<ADULTFAREBASIS>"+c.farebasis[0]+"</ADULTFAREBASIS>",n+="<INFANTFAREBASIS>"+c.farebasis[2]+"</INFANTFAREBASIS>",n+="<FAREREFERENCE>"+c.farereference[0]+"</FAREREFERENCE>",n+="<CHILDFAREREFERENCE>"+c.farereference[1]+"</CHILDFAREREFERENCE>",n+="<INFANTFAREREFERENCE>"+c.farereference[2]+"</INFANTFAREREFERENCE>";var z=e("#zxprice_box DIV.coupon-checkbox");z.hasClass("coupon-checked")&&(n+="<EXCLUSIVEPRICE>1</EXCLUSIVEPRICE>"),p==="adult"?(n+="<CHILDPRICE>"+c.price[0]+"</CHILDPRICE>",n+="<CHILDFAREBASIS>"+c.farebasis[0]+"</CHILDFAREBASIS>"):(n+="<CHILDPRICE>"+c.price[1]+"</CHILDPRICE>",n+="<CHILDFAREBASIS>"+c.farebasis[1]+"</CHILDFAREBASIS>"),n+="<FARERESTRICTION/>",n+="<CHFARERESTRICTION/>",n+="<INFARERESTRICTION/>"}n+="<ADULTFUELTAX>"+c.fuel[0]+"</ADULTFUELTAX>",n+="<CHILDFUELTAX>"+c.fuel[1]+"</CHILDFUELTAX>",n+="<INFANTFUELTAX>"+c.fuel[2]+"</INFANTFUELTAX>",n+="<DISCOUNT>0</DISCOUNT>",n+="<ID>"+c.queryid+"</ID>",i[L].segmenttype=="2"?n+="<ADDONTYPE>Z</ADDONTYPE>":n+="<ADDONTYPE/>",n+="<TERM>"+c.term+"</TERM>",n+="<DESTINATIONTERM>"+c.arrterm+"</DESTINATIONTERM>",n+="<SEGTYPE>"+s+"</SEGTYPE>";if(i[L].segmenttype!="2"&&L>0){var W=i[L-1].firstflight;c.depport!==W.arrport&&(n+="<INFOSEGMENT><SEGORDER/><INFOSEGORDER>"+l+"</INFOSEGORDER>",n+="<DEPAIRPORT>"+W.arrport+"</DEPAIRPORT>",n+="<ARRAIRPORT>"+c.depport+"</ARRAIRPORT></INFOSEGMENT>",l++)}n+="<REALSEGMENT><REALSEGORDER>"+l+"</REALSEGORDER>",n+="<DEPAIRPORT>"+c.depport+"</DEPAIRPORT>",n+="<ARRAIRPORT>"+c.arrport+"</ARRAIRPORT>",n+="</REALSEGMENT></SEGMENT>",l++,r++;if(i[L].segmenttype=="2"||i[L].segmenttype=="3"){var X=i[L].secondflight;n+="<SEGMENT><SEGORDER>"+r+"</SEGORDER>",n+="<CARRIER>"+X.flightno.substring(0,2)+"</CARRIER>",n+="<FLIGHTNO>"+X.flightno.substring(2)+"</FLIGHTNO>",n+="<DEPAIRPORT>"+X.depport+"</DEPAIRPORT>",n+="<ARRAIRPORT>"+X.arrport+"</ARRAIRPORT>",n+="<DEPTIME>"+X.depdate+" "+this.replaceTime(X.deptime)+":00</DEPTIME>",n+="<ARRTIME>"+X.arrdate+" "+this.replaceTime(X.arrtime)+":00</ARRTIME>",n+="<CABIN>"+X.cabinname+"</CABIN>",n+="<PLANETYPE>"+X.planetype+"</PLANETYPE>",n+="<AIRPORTTAX>"+X.tax+"</AIRPORTTAX>",n+="<ADULTPRICE>0</ADULTPRICE>",n+="<CHILDPRICE>0</CHILDPRICE>",n+="<INFANTPRICE>0</INFANTPRICE>",n+="<ADULTFUELTAX>"+X.fuel[0]+"</ADULTFUELTAX>",n+="<CHILDFUELTAX>"+X.fuel[1]+"</CHILDFUELTAX>",n+="<INFANTFUELTAX>"+X.fuel[2]+"</INFANTFUELTAX>",n+="<ADULTFAREBASIS></ADULTFAREBASIS>",n+="<CHILDFAREBASIS></CHILDFAREBASIS>",n+="<INFANTFAREBASIS></INFANTFAREBASIS>",n+="<FAREREFERENCE></FAREREFERENCE>",n+="<CHILDFAREREFERENCE></CHILDFAREREFERENCE>",n+="<INFANTFAREREFERENCE></INFANTFAREREFERENCE>",n+="<DISCOUNT>"+X.discount+"</DISCOUNT>",n+="<FARERESTRICTION/>",n+="<CHFARERESTRICTION/>",n+="<INFARERESTRICTION/>",n+="<ID>"+X.queryid+"</ID>",n+="<ADDONTYPE>Z</ADDONTYPE>",n+="<TERM>"+X.term+"</TERM>",n+="<SEGTYPE>"+s+"</SEGTYPE>",n+="<REALSEGMENT><REALSEGORDER>"+l+"</REALSEGORDER>",n+="<DEPAIRPORT>"+X.depport+"</DEPAIRPORT>",n+="<ARRAIRPORT>"+X.arrport+"</ARRAIRPORT>",n+="</REALSEGMENT></SEGMENT>",l++,r++}}return t=k+"<SEGMENTS>"+n+"</SEGMENTS>",t+="<UPCABINFLAG>"+C+"</UPCABINFLAG>",t+="<VISIBLEFLAG>"+N+"</VISIBLEFLAG>",a&&(t+="<REPORTUUID>"+a+"</REPORTUUID>"),t},getOtherInfo:function(){var e=f.contactor,n=e.c_mobile+"/B2C",r=e.contact_name+"|"+""+"|"+e.c_mobile+"|"+e.c_email,o=0,u=0,a=0,l=i[0].firstflight;for(var c in f)if(c!=="contactor"){var h=f[c],p=h.pType;if(p==0){var d=h.pIdType,m=h.pIdCard;if(d==="NI"){var g=T.getAgeByIdcard(m,l.depdate);g>=12?o++:g<12&&g>=2&&u++}else o++}else p==1?u++:p==2&&a++}var b=o*1+u*1,w="<ORDERNO/><USERPATTERN/>";w+="<ORDERFLAG/>",w+="<DOMESTICINDICATE>1</DOMESTICINDICATE>",w+="<CONTACT>"+n+"</CONTACT>",w+="<ORDERCONTACT>"+r+"</ORDERCONTACT>",w+="<TRANSACTOR/>",w+="<BOOKUSER/>",w+="<BOOKUSERNAME/>",w+="<BOOKAGENT/>",w+="<BOOKAGENTNAME/>",w+="<BOOKAGENT4LOG/>",w+="<CREATEDATE/>",w+="<GROUPFLAG>0</GROUPFLAG>",w+="<GROUPNAME/>",w+="<SEATNUM>"+b+"</SEATNUM>",w+="<ADULTNUM>"+o+"</ADULTNUM>",w+="<CHILDNUM>"+u+"</CHILDNUM>",w+="<INFANTNUM>"+a+"</INFANTNUM>",w+="<SEGTYPE>"+s+"</SEGTYPE>",w+="<GXHTYPE/>";var E="CZBTOC";w+="<MERCHANTID>"+E+"</MERCHANTID>",s==="S"&&i[0].segmenttype=="2"&&(w+="<SID>34</SID>"),x&&(w+="<nb>1</nb>");for(var S=0;S<y.length;S++)if(y[S]=="1"||y[S]=="2"){v=!0;break}v?w+="<INSERTSANDS>Y</INSERTSANDS>":w+="<INSERTSANDS>N</INSERTSANDS>";var N=t.lang;return N==="zh"?w+="<ATTRIBUTE3>zh</ATTRIBUTE3>":w+="<ATTRIBUTE3>en</ATTRIBUTE3>",w},getOtherInfo2:function(){var e=i[0].firstflight.depdate,t=i[0].firstflight.deptime,n=this.makeDate(e,t),r=n-3e6;r=(new Date(r)).format("yyyy-MM-dd hh:mm:ss");var s="<REMITLIMITDATE>"+r+"</REMITLIMITDATE>";return s+="<AGREEALTERNATION>NN</AGREEALTERNATION>",s+="<ENDORSEMENT></ENDORSEMENT>",s+="<CHILDENDORSEMENT></CHILDENDORSEMENT>",s+="<INFANTENDORSEMENT></INFANTENDORSEMENT>",s},getLuggageInfo:function(){var e="";return e+="<VIP>ORDINARY</VIP>",e+="<LUGGAGES>",e+="</LUGGAGES>",e},getDiscountInfo:function(){var t="",n=!0,r=e("#conpunshow .checked");t+="<DISCOUNTS>",m&&!e("#coupon-block").hasClass("hide")&&r.length>0&&(n=!1,e("#coupon-block .checked").each(function(n){t+="<DISCOUNT>",t+="<ID>"+m[n].conpun.id+"</ID>";var r=m[n].conpun.discountCode;t+="<DISCOUNTCODE>"+r+"</DISCOUNTCODE>";var i=m[n].psg;t+="<PSGNAME>"+i.psgname.replace(/\s/g,"").toUpperCase()+"</PSGNAME>",t+="<CARDNO>"+i.cardno+"</CARDNO>";var s=m[n].flight.split("|");t+="<SEGORDER>"+e.trim(s[5].split(",")[0]*1+1)+"</SEGORDER>",t+="<CITYCODE>"+e.trim(s[1])+"-"+e.trim(s[2])+"</CITYCODE>",t+="<FACEVALUE></FACEVALUE>",m[n].conpun.hasOwnProperty("relationship")?t+="<CouponCode>"+m[n].conpun.relationship+"</CouponCode>":t+="<CouponCode></CouponCode>",m[n].conpun.hasOwnProperty("couponNote")?(t+="<couponNote>"+m[n].conpun.couponNote+"</couponNote>",t+="<bookingClassAvails>"+m[n].conpun.bookingClassAvails+"</bookingClassAvails>"):t+="<couponNote></couponNote>",t+="</DISCOUNT>"}));if(g&&g.length>0){n=!1;for(var i=0,s=g.length;i<s;i++)g[i]&&(t+="<DISCOUNT>",t+="<ID></ID>",t+="<CouponCode>"+g[i].couponCode+"</CouponCode>",t+="<couponNote>"+g[i].couponNote+"</couponNote>",t+="<DISCOUNTCODE></DISCOUNTCODE>",t+="<CITYCODE></CITYCODE>",t+="<CARDNO></CARDNO>",t+="<PSGNAME></PSGNAME>",t+="<FACEVALUE></FACEVALUE>",t+="<SEGORDER>"+(Number(g[i].segOrder)+1)+"</SEGORDER>",t+="</DISCOUNT>")}return t+="</DISCOUNTS>",t+="<USERTIME/>",n&&(t=""),t},makeDate:function(e,t){var n=/^(\d{4})([-\/])(\d{1,2})([-\/])(\d{1,2})$/,r=e.match(n),i=t.substr(0,2),s=t.substr(3,2),o=null;return r&&(o=new Date(Number(r[1]),Number(r[3])-1,Number(r[5])),o.setHours(Number(i),Number(s),0)),limitDate=o-3e6,o},getAge:function(e,t){var n=-1,r=e.split("-"),i=t.split("-"),s=i[0]*1-r[0]*1,o=i[1]*1-r[1]*1,u=i[2]*1-r[2]*1;return s===0?o===0?u>=0?n=0:n=-1:o>0?n=0:n=-1:s>0?o===0?u>=0?n=s:n=s-1:o>0?n=s:n=s-1:n=-1,n},getAgeByIdcard:function(e,t){var n=e.length,r=null,i="";if(n===15){r=new RegExp(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/);var s=e.match(r);i="19"+s[2]+"-"+s[3]+"-"+s[4]}if(n===18){r=new RegExp(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/);var s=e.match(r);i=s[2]+"-"+s[3]+"-"+s[4]}var o=this.getAge(i,t);return o},replaceTime:function(e){return e.replace(/^(\d{2})(\d{2})$/,"$1:$2")},getMinIndex:function(e){var t=9999999,n=0;for(var r=0;r<e.length;r++)e[r]&&parseInt(e[r])<=t&&(t=parseInt(e[r]),n=r);return n},postVerifyCode:function(){var t="",r="";language?(t="Please input verification code!",r="Verification code is not correct,please try again!"):(t=psgInfo.psg332,r=psgInfo.psg333);var i=e("#__txtVerifyCode").val();if(i==""){e("#__imgVerifyCode").attr("src","/B2C40/GenerateVerifyCodeServlet.do?flag=createOrder&rr="+Math.random()),n.showAlertBox(t);return}e.ajax({type:"POST",url:"/B2C40/VerifyCodeServlet2.do?verifyCode="+i,dataType:"xml",async:!1,complete:function(t){var i=t.responseText;if(i!="ok"){HasOpenVerifyModalWindow=!1,e("#__imgVerifyCode").attr("src","/B2C40/GenerateVerifyCodeServlet.do?flag=createOrder&rr="+Math.random()),e("#__txtVerifyCode").val(""),n.showAlertBox(r);return}returnflag=0,HasOpenVerifyModalWindow=!0,userinfoupdate(),HasOpenVerifyModalWindow=!1,hideUnderLay()}})},getVerifyCode:function(){e("#__imgVerifyCode").attr("src","/B2C40/GenerateVerifyCodeServlet.do"),e("#__txtVerifyCode").val("");var t=e("#__divModalWindowLayer");t.css({top:Math.floor(e("BODY").scrollTop+(e("BODY").clientHeight-t.offsetHeight)/2)+"px",left:Math.floor(e("BODY").scrollLeft+(e("BODY").clientWidth-t.offsetWidth)/2)+"px",zIndex:999,display:"block"})},checkAgeLimit:function(e,t){var n,r=!1;if(e.indexOf(";")>-1){n=e.split(";");for(var i=0;i<n.length;i++)if(/^\d+\-\d+$/.test(n[i])){var s=parseInt(n[i].split("-")[0]),o=parseInt(n[i].split("-")[1]);t>=s&&t<=o&&(r=!0)}else t==n[i]&&(r=!0)}else if(/^\d+\-\d+$/.test(e)){var s=parseInt(e.split("-")[0]),o=parseInt(e.split("-")[1]);t>=s&&t<=o&&(r=!0)}else t==e&&(r=!0);return r}};return T}),Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},define("emailAuto",["jquery","lang"],function(e,t){var n=function(e){this.config={targetCls:e.targetCls,parentCls:e.parentCls,hiddenCls:".hiddenCls",searchForm:"#submitForm",hoverBg:"hoverBg",inputValColor:e.inputValColor,mailArr:"@qq.com @gmail.com @126.com @163.com @hotmail.com @yahoo.com @yahoo.com.cn @live.com @sohu.com @sina.com".split(" "),isSelectHide:!0,callback:null},this.cache={onlyFlag:!0,currentIndex:-1,oldIndex:-1},this.init(e)};return n.prototype={constructor:n,init:function(t){this.config=e.extend(this.config,t||{});var n=this,r=n.config,i=n.cache;e(r.targetCls).each(function(t,s){e(s).keyup(function(t){var o=t.target,u=e.trim(e(this).val()),a=t.keyCode,f=e(this).outerHeight(),l=e(this).outerWidth(),c=e(this).closest(r.parentCls);if(!/^\w+$/.test(u))return!1;e(c).css({position:"relative"}),u==""?(e(s).attr({"data-html":""}),e(r.hiddenCls,c).val(""),i.currentIndex=-1,i.oldIndex=-1,e(".auto-tip",c)&&!e(".auto-tip",c).hasClass("hidden")&&e(".auto-tip",c).addClass("hidden"),n._removeBg(c)):(e(s).attr({"data-html":u}),e(r.hiddenCls,c).val(u),e(".auto-tip",c)&&e(".auto-tip",c).hasClass("hidden")&&e(".auto-tip",c).removeClass("hidden"),n._renderHTML({keycode:a,e:t,target:o,targetVal:u,height:f,width:l,parentNode:c}))})}),e(r.searchForm).each(function(t,n){e(n).keydown(function(e){var t=e.keyCode;if(t==13)return!1})}),e(document).click(function(t){t.stopPropagation();var n=t.target,i=r.targetCls.replace(/^\./,"");e(n).hasClass(i)||e(".auto-tip")&&e(".auto-tip").each(function(t,n){!e(n).hasClass("hidden")&&e(n).addClass("hidden")})})},_renderHTML:function(t){var n=this,r=n.config,i=n.cache,s,o=n._keyCode(t.keycode);e(".auto-tip",t.parentNode).hasClass("hidden")&&e(".auto-tip",t.parentNode).removeClass("hidden");if(o>-1)n._keyUpAndDown(t.targetVal,t.e,t.parentNode);else{/@/.test(t.targetVal)?s=t.targetVal.replace(/@.*/,""):s=t.targetVal;if(i.onlyFlag){e(t.parentNode).append('<input type="hidden" class="hiddenCls"/>');var u='<ul class="auto-tip">';for(var a=0;a<r.mailArr.length;a++)u+='<li class="p-index'+a+'" style="color: #666">'+'<span class="output-num"></span><em class="em" data-html="'+r.mailArr[a]+'">'+r.mailArr[a]+"</em></li>";u+="</ul>",i.onlyFlag=!1,e(t.parentNode).append(u),e(".auto-tip",t.parentNode).css({position:"absolute",top:t.outerHeight,width:t.width-2+"px",left:"0px",border:"1px solid #ccc","z-index":1e4,"text-align":"left","overflow-x":"auto","overflow-y":"hidden"})}e(".auto-tip li",t.parentNode).each(function(t,n){e(".output-num",n).html(s),!e(".output-num",n).hasClass(r.inputValColor)&&e(".output-num",n).addClass(r.inputValColor);var i=e.trim(e(".em",n).attr("data-html"));e(n).attr({"data-html":s+""+i})}),n._accurateMate({target:t.target,parentNode:t.parentNode}),n._itemHover(t.parentNode),n._executeClick(t.parentNode)}},_accurateMate:function(t){var n=this,r=n.config,i=n.cache,s=e.trim(e(t.target,t.parentNode).attr("data-html")),o=[];if(/@/.test(s)){var u=s.replace(/@.*/,""),a=s.replace(/.*@/,"");e.map(r.mailArr,function(e){var t=new RegExp(a);t.test(e)&&o.push(e)});if(o.length>0){e(".auto-tip",t.parentNode).html(""),e(".auto-tip",t.parentNode)&&e(".auto-tip",t.parentNode).hasClass("hidden")&&e(".auto-tip",t.parentNode).removeClass("hidden");var f="";for(var l=0,c=o.length;l<c;l++)f+='<li class="p-index'+l+'">'+'<span class="output-num"></span><em class="em" data-html="'+o[l]+'">'+o[l]+"</em></li>";e(".auto-tip",t.parentNode).html(f),e(".auto-tip li",t.parentNode).each(function(t,n){e(".output-num",n).html(u),!e(".output-num",n).hasClass(r.inputValColor)&&e(".output-num",n).addClass(r.inputValColor);var i=e.trim(e(".em",n).attr("data-html"));e(n).attr("data-html",""),e(n).attr({"data-html":u+""+i})}),i.currentIndex=-1,i.oldIndex=-1,e(".auto-tip .output-num",t.parentNode).html(u),n._itemHover(t.parentNode),n._executeClick(t.parentNode)}else e(".auto-tip",t.parentNode)&&!e(".auto-tip",t.parentNode).hasClass("hidden")&&e(".auto-tip",t.parentNode).addClass("hidden"),e(".auto-tip",t.parentNode).html("")}},_itemHover:function(t){var n=this,r=n.config,i=n.cache;e(".auto-tip li",t).hover(function(t,n){!e(this).hasClass(r.hoverBg)&&e(this).addClass(r.hoverBg)},function(){e(this).hasClass(r.hoverBg)&&e(this).removeClass(r.hoverBg)})},_removeBg:function(t){var n=this,r=n.config;e(".auto-tip li",t).each(function(t,n){e(n).hasClass(r.hoverBg)&&e(n).removeClass(r.hoverBg)})},_keyUpAndDown:function(t,n,r){var i=this,s=i.cache,o=i.config;if(e(".auto-tip li",r)&&e(".auto-tip li").length>0){var u=e(".auto-tip li",r).length,a=n.keyCode;s.oldIndex=s.currentIndex;if(a==38){s.currentIndex==-1?s.currentIndex=u-1:(s.currentIndex=s.currentIndex-1,s.currentIndex<0&&(s.currentIndex=u-1));if(s.currentIndex!==-1){!e(".auto-tip .p-index"+s.currentIndex,r).hasClass(o.hoverBg)&&e(".auto-tip .p-index"+s.currentIndex,r).addClass(o.hoverBg).siblings().removeClass(o.hoverBg);var f=e(".auto-tip .p-index"+s.currentIndex,r).attr("data-html");e(o.targetCls,r).val(f),e(o.hiddenCls,r).val(f)}}else if(a==40){s.currentIndex==u-1?s.currentIndex=0:(s.currentIndex++,s.currentIndex>u-1&&(s.currentIndex=0));if(s.currentIndex!==-1){!e(".auto-tip .p-index"+s.currentIndex,r).hasClass(o.hoverBg)&&e(".auto-tip .p-index"+s.currentIndex,r).addClass(o.hoverBg).siblings().removeClass(o.hoverBg);var f=e(".auto-tip .p-index"+s.currentIndex,r).attr("data-html");e(o.targetCls,r).val(f),e(o.hiddenCls,r).val(f)}}else if(a==13){var l=e(".auto-tip .p-index"+s.oldIndex,r).attr("data-html");e(o.targetCls,r).val(l),e(o.hiddenCls,r).val(l),o.isSelectHide&&!e(".auto-tip",r).hasClass("hidden")&&e(".auto-tip",r).addClass("hidden"),o.callback&&e.isFunction(o.callback)&&o.callback(),s.currentIndex=-1,s.oldIndex=-1}}},_keyCode:function(e){var t=["17","18","38","40","37","39","33","34","35","46","36","13","45","44","145","19","20","9"];for(var n=0,r=t.length;n<r;n++)if(e==t[n])return n;return-1},_executeClick:function(t){var n=this,r=n.config;e(".auto-tip li",t).unbind("click"),e(".auto-tip li",t).bind("click",function(n){var i=e(this).attr("data-html");e(r.targetCls).attr("data-html",i),e(r.targetCls).val(i),e(r.targetCls).change(),e(r.targetCls,t).val(i),r.isSelectHide&&!e(".auto-tip",t).hasClass("hidden")&&e(".auto-tip",t).addClass("hidden"),e(r.hiddenCls,t).val(i),r.callback&&e.isFunction(r.callback)&&r.callback()})}},n}),require(["jquery","headfoot","doT","lang","UI","psgTpl","app","validator","scroll","upgrades","setdate","createOrder","emailAuto"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){e.headfooter(),o.navSide(2);var p=r.passenger,v=r.inputNumError,g=[],b;(function(){var t={1:[],2:[]},n="",i=new Date,a={},l={},g=[0,0,0],b={},w={},E={},S={child:!1,infant:!1},x="",T={NI:p.psg023,PP:p.psg024,ID:p.psg025},N=[p.psg300,p.psg301,p.psg302],C=[],k=[],L={checkflightUpgradeData:[],fgprice:[],oldprice:[],pinfo:[],pprice:[],beforecabin:[]},A=null,O=null,M=null,_=!1,D=!1,P=!1,H="loginfail",B=[],j=!1,F=null,I=null,q=null,R=null,U={},z=!1,W=!1;upgradeReportId=null,isgetpsginfo=!0,segtype="S",insurance=null,flightNums=0,uuid=null,flightData=null,codeshareFlag=!1,zzflag=0,isnocz=!1,isaddno=!1,sandsArray=[],isNaddN="",isNNbool=0,iscomprice=!1,isviplogin=!0,discountvalue=0,olddataflight=[],newdataflight=[],vipNoPsg=[],vippsgid=[],vipinputval=[],TAX=[],FUEL=[],PRICE=[],ZX_PRICE_QUERY_PATAM=[],KQTCABIN=[],ZJ_PRICE=[],ISKQT=!1,iszxPricebool=!0,ispreUrlsol=0,issolbool=!0,nearbynb=0,excessTicketCount={info:[],excessNum:0},contactList=[],aHref="/B2C40/modules/bookingnew/main/flightSelectDirect.html?",REG={name:/^(([\u4E00-\u9fA5]{2,9})|([\u4E00-\u9fA5]{1,5}[A-Za-z]{2,20})|([\u4E00-\u9fA5]{1,5}([A-Za-z]+)[ ]?[A-Za-z]{1,20})|([A-Za-z]+)[ ]?[A-Za-z]{1,48}\/([A-Za-z]+)[ ]?[A-Za-z]{1,48})$/ig},INSURANCE_CONFIG={a:{userType:"all",forPsgType:"0,1,2",helpType:"insurance",helpText:'<span class="blue-text">'+p.psg551_1+"</span>",insuranceName:p.psg549,isDefault:!1},b:{userType:"all",forPsgType:"0,1",helpType:"insurance_refund",helpText:'<span class="blue-text">'+p.psg553_1+"</span>",insuranceName:p.psg552,isDefault:!1}},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=t);for(;n<t;n++)if(n in this&&this[n]===e)return n;return-1});var X=function(){var t=o.getSearch(window.location.search).lang,n=e.cookie("language");return t&&t==="en"?t:n==null?"zh":n.split("_")[0]};n=X();var V=function(e,t){if(t==""||t==null)return e;if(e.length>1){var n=e.join("##");return t=e.indexOf(t)==0?t+"##":"##"+t,n=n.replace(t,""),n.split("##")}return e.length==1?e[0]==t?[]:e:[]},J=function(e){var t=0;for(var n=0,r=e.length;n<r;n++)t+=parseInt(e[n]);return t},K=function(){e.ajax({type:"POST",url:"/B2C40/query/jaxb/insurance/selectInsurance.ao",dataType:"json",async:!1,success:function(e){insurance=e,insurance&&(insurance.message?(o.showAlertBox(p.psg303),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n",p.psg521,!0,"WT.si_p",p.psg527,!0,"WT.error_msg",p.psg303,!0)):insurance.hasOwnProperty("InsuranceName")&&insurance.hasOwnProperty("InsuranceType")?insurance.insuranceType=insurance.InsuranceType:insurance={insuranceType:"2",InsuranceCost:"30",InsuranceName:"平安保险"})}})},Q=function(){var t={flightDateList:flightData.segments[flightData.segments.length-1].firstflight.depdate,isInter:"N"};e.ajax({type:"POST",url:"/B2C40/query/jaxb/insurance/selectNewInsurance.ao",dataType:"json",async:!1,data:t,success:function(e){var t=null;try{e&&e.success&&e.insuranceTypeList&&e.insuranceTypeList.length>0&&(t=e.insuranceTypeList,t&&(!(t instanceof Array)||t.length==0)&&(t=[{insuranceType:"",insuranceCost:"30",insuranceName:"航空综合险",typeOfInsurance:"a"}]))}catch(n){}if(t==null||t==undefined||!(t instanceof Array)||t.length==0)t=[{insuranceType:"",insuranceCost:"30",insuranceName:"航空综合险",insurancePercent:"99",typeOfInsurance:"a"}];var r=0;insurance={},insurance.showList=[];for(var i=0;i<t.length;i++){var s=t[i];insurance[s.typeOfInsurance]=s;var u=INSURANCE_CONFIG[s.typeOfInsurance];if(u!=undefined){for(var a in u)u.hasOwnProperty(a)&&(s[a]=u[a]);if(s.userType==="all")insurance.showList[r]=s,r++;else{var f=s.userType.split(",");f.indexOf(o.user.INFO.userType)!=-1&&(insurance.showList[r]=s,r++)}}}insurance.showList=G(insurance.showList)},error:function(){var e=[{insuranceType:"4",insuranceCost:"30",insuranceName:"航空综合险",insurancePercent:"99",typeOfInsurance:"a"}],t=0;insurance={},insurance.showList=[];for(var n=0;n<e.length;n++){var r=e[n];insurance[r.typeOfInsurance]=r;var i=INSURANCE_CONFIG[r.typeOfInsurance];if(i!=undefined){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);if(r.userType==="all")insurance.showList[t]=r,t++;else{var u=r.userType.split(",");u.indexOf(o.user.INFO.userType)!=-1&&(insurance.showList[t]=r,t++)}}}}})},G=function(e){var t;return e!=undefined&&e.length>0&&(t=e.sort(function(e,t){return e.typeOfInsurance>t.typeOfInsurance?1:-1})),t},Y=function(t){var n=null;return e.ajax({type:"POST",url:"/B2C40/config/jaxb/get.ao",data:{key:t},dataType:"json",async:!1,success:function(e){n=e}}),n},Z=function(){e.ajax({type:"GET",url:"/B2C40/query/jaxb/hyzj/open.ao",dataType:"json",async:!1,success:function(e){e&&!e.success&&(isviplogin=!1)}})},et=function(){var t={},n={},r={},i={};for(var s=0;s<insurance.showList.length;s++)t[insurance.showList[s].typeOfInsurance]=0,n[insurance.showList[s].typeOfInsurance]=0,r[insurance.showList[s].typeOfInsurance]=0,i[insurance.showList[s].typeOfInsurance]=0;for(var o in b)if(b.hasOwnProperty(o)&&b[o].insurance&&b[o].insurance.length>0)for(var u=0;u<b[o].insurance.length;u++)b[o].insurance[u].chooseFlag&&t[b[o].insurance[u].insuranceType]++,b[o].insurance[u].chooseFlag&&b[o].pType===0?n[b[o].insurance[u].insuranceType]++:b[o].insurance[u].chooseFlag&&b[o].pType===1?r[b[o].insurance[u].insuranceType]++:b[o].insurance[u].chooseFlag&&b[o].pType===2&&i[b[o].insurance[u].insuranceType]++;var a=0,f=0,l=0;for(var c=0;c<insurance.showList.length;c++){var h=0;n[insurance.showList[c].typeOfInsurance]&&(h=insurance.showList[c].insuranceCost*n[insurance.showList[c].typeOfInsurance]*flightNums),a+=h,h=0,r[insurance.showList[c].typeOfInsurance]&&(h=insurance.showList[c].insuranceCost*r[insurance.showList[c].typeOfInsurance]*flightNums),f+=h,h=0,i[insurance.showList[c].typeOfInsurance]&&(h=insurance.showList[c].insuranceCost*i[insurance.showList[c].typeOfInsurance]*flightNums),l+=h}e(".adultInsurance").each(function(){e(this).text("￥"+a)}),e(".childInsurance").each(function(){e(this).text("￥"+f)}),e(".babyInsurance").each(function(){e(this).text("￥"+l)});var p=a+f+l;return{insuranceCount:t,insuraceTotal:p}},tt=function(t){var n=[],r=et();e("#summary-sub-box").find(".num").each(function(){var n=e(this),r=n.data("idx");n.text(t[r])}).end().toggleClass("noChild",!t[1]).toggleClass("noBaby",!t[2]),e("#summary-sub-box").find(".price").each(function(){var n=e(this),r=n.data("idx");n.text("￥"+t[r]*PRICE[r])}),e("#summary-sub-box").find(".fuel").each(function(){var n=e(this),r=n.data("idx");n.text("￥"+t[r]*FUEL[r])}),e("#summary-sub-box").find(".tax").each(function(){var n=e(this);n.text("￥"+t[0]*TAX)});var i=t[0]*PRICE[0]+t[1]*PRICE[1]+t[2]*PRICE[2],s=t[0]*FUEL[0]+t[1]*FUEL[1]+t[2]*FUEL[2];totalTax=TAX*t[0],totalInsurance=r.insuraceTotal;var o=0;t[0]?o=i+s+totalTax+totalInsurance:o=0;if(e("#mer_coupon").length>0){if(t[0]>1)e("#conpunshow .flightprice").each(function(){var t=e(this);t.addClass("unselect").find(".conpunopc").html(p.psg234),t.hasClass("checked")&&t.removeClass("checked")}),e("#conpunshow .curprice").each(function(){e(this).hasClass("unselect")&&e(this).removeClass("unselect").find(".conpunopc").html("")});else{var u=e("#conpunshow .checked"),a=!1;for(var f=0;f<u.length;f++)if(u.eq(f).hasClass("curprice")){a=!0;break}a?e("#conpunshow .unselect").find(".conpunopc").html(p.psg232):e("#conpunshow .unselect").removeClass("unselect").find(".conpunopc").html("")}e("#comconpunnum").html(Number(e("#flight-summary-box .singleFlightBox").length)*Number(e("#passenger-list li.form").length))}if(e("#isdiscount").css("display")!="none"||e("#isnondiscount").css("display")!="none"){var l=discountvalue*t[0];e("#isdiscount span").html(l),e("#isnondiscount span").html(l)}w.INSURANCE_SUM=r.insuraceTotal,w.TOTALSUM=(n[0]||0)+(n[1]||0),e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")?(Ft.ischangeShow(),Ft.countPrice()):(e("#zxprice_box").length>0&&e("#price-total").removeClass("zxpricetotal").find("i").remove(),e("#price-total span").text("¥"+o))},nt=function(){return g[0]+g[1]+g[2]},rt=function(){var n=o.trim(this.val(),"g"),r=!0,i=!0,s=this.get(0).name,a=this.closest(".form"),f=a.get(0).id;pType=b[f]&&b[f].pType,this.val(n);var l=flightData.segments[0].firstflight.depdate;if(n.length)if(s==="pBirthday")if(u.checkIsDate(n)){if(pType==1){if(n<t[pType][0]||n>t[2][1]||n==t[pType][0])o.settip.call(e(this),p.psg305),r=!1;n>t[2][0]&&n<t[2][1]&&o.settip2.call(e(this),p.psg339)}else if(pType==2){if(n<t[pType][0]||n>l||n==t[pType][0])o.settip.call(e(this),p.psg306),r=!1;n<l&&n>t[pType][1]&&(o.settip.call(e(this),p.psg340),r=!1)}}else o.settip.call(e(this),p.psg307),r=!1;else if(s==="pIdCard"){this.val(u.changeUpper(n)),e("#mer_coupon").length>0&&Ot.changeCouponbyid(b[f].pIdCard,n);var h=b[f].pIdType;if(h==="NI"){var d=n.length,v=n.match(/^(\d{6})(\d{8})(\d{3})([0-9]|X)$/i),m=[];r=u.checkCard(n,d),r||o.settip.call(e(this),p.psg308),r===15&&(o.settip.call(e(this),p.psg335),r=!1);if(r&&d===18){m.push(v[2].substring(0,4)),m.push(v[2].substring(4,6)),m.push(v[2].substring(6,8));var g=m.join("-"),y=c.getAgeByIdcard(n,l);y<12&&y>=2&&(psgType=1,psgAge=y);if(pType==0){if(g>t[1][0]&&g<t[1][1])o.settip.call(e(this),p.psg337),i=!1;else if(g>t[2][0]&&g<t[2][1]||g==t[2][0])o.settip.call(e(this),p.psg338),i=!1}else pType==1&&(g<t[1][0]||g>l||g==t[1][0]?(o.settip.call(e(this),p.psg336),e(this).closest(".form").find("input[name=pBirthday]").val(""),i=!1):g>t[2][1]&&g<l?(o.settip.call(e(this),p.psg340),e(this).closest(".form").find("input[name=pBirthday]").val(""),i=!1):(g>t[2][0]&&g<t[2][1]&&o.settip2.call(e(this),p.psg339),e(this).closest(".form").find("input[name=pBirthday]").val(g)));if(i&&q&&q.psgrtype&&q.psgrtype.indexOf("NID")>-1){var w=q.psgrtype.split("$"),E=-1;for(var S=0;S<w.length;S++)if(w[S].indexOf("age")>-1){E=e.trim(w[S].split(":")[1]);break}if(E!==-1){var x=c.checkAgeLimit(E,y);x||(o.settip.call(e(this),p.psg331),i=!1)}}}}else r=/^[0-9a-zA-Z]*\d+[0-9a-zA-Z]*$/i.test(n)||/^\d{4}\-\d{2}\-\d{2}$/i.test(n),n.length<=18&&!r&&o.settip.call(e(this),p.psg309);for(var T in b)if(b.hasOwnProperty(T)){if(f==T)continue;var N=b[T];if(N.pIdType===h&&N.pIdCard===n){r=!1,b[T].sameCard=f,o.settip.call(e(this),p.psg310);break}}r&&b[f].sameCard&&(e("#"+b[f].sameName).find(".p-idCard").trigger("change"),b[f].sameCard="")}else if(s==="psgName"){var C=e(this).closest(".psg-block").attr("id"),k=b[C].pType!==2&&b[C].pIdType==="NI"?!0:!1;this.val(u.changeUpper(n)),r=u.isPsgName(n,k);if(r){for(var T in b)if(b.hasOwnProperty(T)){if(f==T){e("#mer_coupon").length&&Ot.checkchangebyname(b[T].psgName,n);continue}if(b[T].psgName===n){r=!1,b[T].sameName=f,o.settip.call(e(this),p.psg311);break}}r&&b[f].sameName&&(e("#"+b[f].sameName).find(".p-name").trigger("change"),b[f].sameName="")}else o.settip.call(e(this),p.psg312)}else if(s==="membernum"){r=u.isUnionpayCard(n);if(r){for(var T in b)if(b.hasOwnProperty(T)){if(f==T)continue;if(b[T].pMembernum===n){r=!1,b[T].sameMembernum=f,o.settip.call(e(this),p.psg062);break}}r&&b[f].sameMembernum&&(e("#"+b[f].sameMembernum).find(".psg-membernum-input").trigger("change"),b[f].sameMembernum="")}else o.settip.call(e(this),p.psg064)}else if(s==="unionpay"){r=u.isUnionpayCard(n);if(r){for(var T in b)if(b.hasOwnProperty(T)){if(f==T)continue;if(b[T].pUnionpay===n){r=!1,b[T].sameUnionpay=f,o.settip.call(e(this),p.psg063);break}}r&&b[f].sameUnionpay&&(e("#"+b[f].sameUnionpay).find(".psg-unionpay-input").trigger("change"),b[f].sameUnionpay="")}else o.settip.call(e(this),p.psg065)}else if(s==="contact_name")this.val(u.changeUpper(n)),r=u.isContactName(n),r||o.settip.call(e(this),p.psg312);else if(s==="c_mobile"){if(/(\d{3})(\*{4})(\d{4})/.test(n)){var L=e(this).attr("mobile").replace(/(\d{3})(\d{4})(\d{4})/,n.substr(0,3)+"$2"+n.substr(7,4));e(this).attr("mobile",L)}else e(this).attr("mobile",n);n=e.trim(e(this).attr("mobile")),r=/^\d{11}$/i.test(n),r||o.settip.call(e(this),p.psg313)}else s==="c_email"&&(e(this).poshytip("hide"),r=(new RegExp("^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$")).test(n),r||o.settip.call(e(this),p.psg314));else e(this)&&o.settip.call(e(this),p.psg315),r=!1;return b[f][s]=r?n:null,s==="pIdCard"?r&&i&&o.settip.call(this,""):r&&o.settip.call(this,""),r&&n},it=function(e){var e=e,t=e.closest(".form").attr("id"),n=e.getSval().text,r=!0;for(var i in b)if(b.hasOwnProperty(i)){if(t==i)continue;if(b[i].pCarryBy&&b[i].pCarryBy===n){o.settip.call(e,p.psg316),r=!1;break}}return r&&o.settip.call(e,""),r&&n},st=function(){var e=!0;if(nt()>9)o.showAlertBox(p.psg317),e=!1;else if(g[0]*2<g[1]||g[0]<g[2])o.showAlertBox(p.psg318),e=!1;return e},ot=function(){var t=!1,n=e("#passenger-list .form").eq(0),r='{"userid":"'+F.data.userId+'","username":"'+n.find(".psg-name-input").val()+'","idCard":"'+n.find(".psg-idType-input").val()+'"}',i=e.csairpreUrl(M)?"/B2C40/query/jaxb/zeroticket/ordercheck.ao":"/B2C40/query/jaxb/memberday/ordercheck.ao",s=e.csairpreUrl(M)?!0:!1;return e.ajax({type:"post",url:i,dataType:"json",async:!1,data:{json:r,activitiesId:x},success:function(n){if(n&&/\d+/.test(Number(n.message)))switch(Number(n.message)){case 0:o.showAlertBox(p.psg418);break;case 1:t=!0;break;case 6:o.showAlertBox(p.psg422);break;case 7:o.showAlertBox(p.psg422);break;case 12:o.showAlertBox(p.psg424);break;case 13:o.showAlertBox(p.psg418);break;case 14:o.showAlertBox(p.psg425);break;case 10:var r={email:!0,idCard:!0,memberNo:!0,mobile:!0,mobileRandCode:!0};e("#login-dialog").addClass("hide"),!e("#userMes")||o.userMesDialog(r),e("#userMes").removeClass("hide"),e("body").unbind("userMesChecked").bind("userMesChecked",function(){e("#userMes").addClass("hide"),e("#submitForm").click()});break;case 11:var i=o.user.getMemType;s&&(t=!1,e.bindDialogin(location.href));default:o.showAlertBox(p.psg417)}else o.showAlertBox(p.psg417)},error:function(){o.showAlertBox(p.psg417)}}),t},ut=function(t){e.ajax({type:"post",url:"/B2C40/query/jaxb/zeroticket/logincheck.ao",dataType:"json",data:{json:'{"userid" : "'+t.userId+'"}',activitiesId:x},success:function(e){if(!e||!/\d+/.test(Number(e.message))||e.message===5)return o.showAlertBox(p.psg417),!1;switch(Number(e.message)){case 0:o.showAlertBox(p.psg418);break;case 1:break;case 3:o.showAlertBox(p.psg419);break;case 4:o.showAlertBox(p.psg420);break;case 5:o.showAlertBox(p.psg417);break;default:return o.showAlertBox(p.psg417),!1}},error:function(){return o.showAlertBox(p.psg417),!1}})},at=function(){var t="";return e.ajax({type:"post",url:"/B2C40/checkLogin/jaxb/checkLogin.ao",data:{flag:""},dataType:"json",async:!1,success:function(n){var i=n.data;n.success?(o.user.INFO=i,F=n,i.userType==="2"||i.userType=="4"||i.userType=="8"||i.userType=="7"?t="nomember":i.userType==="1"?(t="member",bt({name:i.userName,phone:i.cellphone,email:i.email})):i.userType==="3"&&(D=!0),P&&e.csairpreUrl(M)&&ut(i)):i.loginType==="9"?(r.lang==="en"&&e("#psg-bindMes").addClass("isen"),t="nologin"):t="loginfail"}}),t},ft=function(){e("body").one("loginLoaded",function(){e("body").triggerHandler("setLoginForm")}),P?o.login(r.flight.skyPsnurl,"",!1,"",!0,!1,!0):(o.login(r.flight.skyPsnurl,"",!1,"",!1,!0,!0),e("body").unbind("nologin").bind("nologin",function(){e.ajax({url:"/B2C40/query/jaxb/userinfo/ismissing/setlogintype.ao",type:"get",success:function(){location.href=location.href}})}))},lt=!0,ct="",ht=function(){var t=null,n=lt?[]:'<li class="disableclick">'+p.psg427+"</li>";e("#passenger-list > li").each(function(r){t=e(this),t.data("type")=="0"&&(lt&&isgetpsginfo?n.push({MOBILEPHONE:"",PSGNAME:t.find(".psg-name-input").val(),EMAIL:""}):n+='<li data-mobile="" data-email="" class="key">'+t.find(".psg-name-input").val()+"</li>")});var r=e("#contactorBox ul");lt&&isgetpsginfo?(o.creaDropDown(n,"contact_name","contact-moblie"),lt=!1,r.prepend('<li class="disableclick">'+p.psg427+"</li>")):(lt&&(ct=r.html(),lt=!1,n='<li class="disableclick">'+p.psg427+"</li>"+n),r.html(ct+n))},pt=function(){var t=e("#passenger-list"),n=[],t=e("#passenger-list");e("ul.psgs-carryBy").each(function(){var r="",i=0;t.find(".psgType0 input[name=psgName]").each(function(){i++;var t=e(this).val();t!=null&&t!=""&&t!=undefined&&(r+="<li class='option' data-value='"+t+"'>"+t+"</li>",n.push(t))}),e(this).html(r)}),e(".psg-carry .select-trigger").each(function(){var t=e(this).html();if(t!=null&&t!=""&&t!=undefined){var r=!0;for(var i=0;i<n.length;i++)if(t==n[i]){r=!1;break}r&&e(this).html("")}}),dt()},dt=function(){e(".psg-carry").each(function(){e(this).setSelect().on("change",function(){var t=e(this).getSval().text;e(this).closest(".select").find(".select-trigger").text(t),b[e(this).closest(".form").attr("id")].pCarryBy=t;var n=e(this).closest(".form");it(e(this))?n.removeClass("new-form").addClass("form-passed"):n.removeClass("form-passed").addClass("new-form")})})},vt=function(e,t,n){if(navigator.userAgent.indexOf("MSIE")>=0&&navigator.userAgent.indexOf("Opera")<0){var r=navigator.appName,i=navigator.appVersion,s=i.split(";"),o=s[1].replace(/[ ]/g,"");r=="Microsoft Internet Explorer"&&o=="MSIE6.0"?SelectDate(e,"yyyy-MM-dd",-60,0,n):r=="Microsoft Internet Explorer"&&o=="MSIE7.0"?SelectDate(e,"yyyy-MM-dd",-60,0,n):SelectDate(e,"yyyy-MM-dd",0,0,n)}else SelectDate(e,"yyyy-MM-dd",0,0,n)},mt=function(t){var n=!0;return e.ajax({type:"POST",url:"/B2C40/query/jaxb/flight/getFlight.ao",data:{uuid:t},dataType:"json",async:!1,success:function(t){if(t)if(t.message&&t.message=="401")ft(),e("#login-dialog").removeClass("hide"),e("body").unbind("userLogged").bind("userLogged",function(){window.location.reload()}),n=!1;else if(t.message&&t.message.indexOf("无航班信息")>-1)window.history.back(),n=!1;else{flightData=t,segtype=flightData.segtype;var r=[],i=[],s=flightData.param;e.each(t.segments[0].firstflight.minprice,function(e,t){t&&r.push(parseInt(t))}),r&&r.length>0&&(E.MIN_PRICE=Math.min.apply(Math,r)),flightData.hasOwnProperty("isMember")&&flightData.isMember&&(P=!0),nearbynb=flightData.param.nb,issolbool=flightData.ispreUrlsol?!0:!1;var o=!1;if(flightData.segments){var u=flightData.segments;for(var a=0;a<u.length;a++){var f=u[a],l=f.segmenttype;if(l=="2")zzflag=1,isaddno=!0;else if(l=="1"){var c=f.firstflight,h=c.flightno;h.substring(0,2)!=="CZ"&&(isnocz=!0),a==1&&c.hasOwnProperty("price")&&c.price.length>1&&c.price[0]&&(iscomprice=!0),c.conpunId&&(B[a]=c.conpunId),i.push(c.price),ZX_PRICE_QUERY_PATAM.push({depport:c.depport,arrport:c.arrport,deptime:c.depdate+"T"+c.dept,arrtime:c.arrdate+"T"+c.arrt,flightno:c.flightno,plane:c.planetype,resBookDesigCode:c.cabinname}),!S.child&&!(f.firstflight.productType==="CZADDON"&&a===1||f.firstflight.price[1])&&(S.child=!0),!S.infant&&!(f.firstflight.productType==="CZADDON"&&a===1||f.firstflight.price[2])&&(S.infant=!0),E.DATE=c.depdate.split("-"),E.DECITY=c.depcity,E.ARCITY=c.arrcity}else if(l=="0"){var c=f.firstflight,p=c.codeshare;p!==""&&p!=="CZ"&&(codeshareFlag=!0),c.conpunId&&(B[a]=c.conpunId),issolbool&&!c.issolbool&&(issolbool=!1),!o&&c.issolbool&&(o=!0),i.push(c.price),ZX_PRICE_QUERY_PATAM.push({depport:c.depport,arrport:c.arrport,deptime:c.depdate+"T"+c.dept,arrtime:c.arrdate+"T"+c.arrt,flightno:c.flightno,plane:c.planetype,resBookDesigCode:c.cabinname,adults:s.at,children:s.ct,infants:s.it,channel:c.issolbool?flightData.ispreUrlsol==1?"SOL001":flightData.ispreUrlsol==2?"SOL002":"COMMON":"COMMON"}),!S.child&&!(f.firstflight.productType==="CZADDON"&&a===1||f.firstflight.price[1])&&(S.child=!0),!S.infant&&!(f.firstflight.productType==="CZADDON"&&a===1||f.firstflight.price[2])&&(S.infant=!0),E.DATE=c.depdate.split("-"),E.DECITY=c.depcity,E.ARCITY=c.arrcity}}}flightData.ispreUrlsol&&(ispreUrlsol=flightData.ispreUrlsol,e("#soltxtshow").show(),e("#passenger-block").addClass("solblock"),o&&(INSURANCE_CONFIG.b.forPsgType="1"));var d=0,v=0,m=0;segtype==="R"&&(d=parseInt(i[0][0])+parseInt(i[1][0]),v=parseInt(i[0][1])+parseInt(i[1][1]),m=parseInt(i[0][2])+parseInt(i[1][2]),Ft.oldaudltPrice=d,Ft.OLD_PRICE=[d,v,m],Ft.OLD_PRICEARR=i),flightData.param.unionpay_cardno&&(O=flightData.param.unionpay_cardno);if(flightData.param.preUrl&&!flightData.ispreUrlsol){for(var a=0;a<flightData.segments.length;a++){var f=flightData.segments[a],g=f.firstflight;if(g.pricegroup){A=!0;break}}flightData.param.hasOwnProperty("activitiesId")&&e.csairpreUrl(flightData.param.preUrl)&&(x=flightData.param.activitiesId),A&&(M=flightData.param.preUrl,e.ajax({type:"POST",url:"/B2C40/query/jaxb/generalizelink/query.ao",data:{merchantid:M,flightdate:flightData.segments[0].firstflight.depdate,flag:"passenger"},dataType:"json",async:!1,success:function(e){e.message||(q=e,_=!0,q.credentialstype&&(I=q.credentialstype))}}))}}}}),n},gt=function(){var r={},i={},u=[],a=[];Insurance=30,InsuranceRefund=58,adultInsurance=0,childInsurance=0,babyInsurance=0,uuid=o.getSearch().id,$summary=e("#summary-sub-box");var l=function(r){var i=[];if(!flightData||flightData.message)return o.showAlertBox(flightData.message),!1;var s=flightData.param;isviplogin=flightData.segments[0].firstflight.isviplogin,isviplogin=isviplogin?isviplogin:flightData.segtype==="R"?flightData.segments[1].firstflight.isviplogin:isviplogin,P&&e.csairpreUrl(M)&&(isviplogin=!1),isviplogin&&Z(),isviplogin||(e("#isdiscount").remove(),e("#isnondiscount").remove());if(s&&s.hasOwnProperty("t")){e("#flight-summary-box").removeClass("loading");var u=s.t;if(u=="S")a.push(p.psg001),aHref+=o.stringFormat("t=%s&c1=%s&c2=%s&d1=%s&at=%s&ct=%s&it=%s",s.t,s.c1,s.c2,s.d1,s.at,s.ct,s.it);else if(u=="R"){var l=flightData.segments.length;for(var c=0;c<l;c++)flightData.segments[c].sandsflag==2?a.push(""):c==0?a.push(p.psg002):a.push(p.psg003);aHref+=o.stringFormat("t=%s&c1=%s&c2=%s&d1=%s&d2=%s&at=%s&ct=%s&it=%s",s.t,s.c1,s.c2,s.d1,s.d2,s.at,s.ct,s.it)}else if(u=="M"){var l=flightData.segments.length;for(var c=0;c<l;c++)a.push(p["psg00"+(4+c)]);aHref+=o.stringFormat("t=%s&at=%s&ct=%s&it=%s&fl=%s",s.t,s.at,s.ct,s.it,s.fl)}}s.preUrl&&(aHref+="&preUrl="+s.preUrl);if(flightData&&flightData.segments&&flightData.segments.length){var h=p.psg319,d={time:{r:/^(\d{2})(\d{2})$/i,s:"$1:$2:00"},date:{r:/^(\d{4})(\d{2})(\d{2})$/i,s:"$1-$2-$3"}},v=o.getDateObj(flightData.segments[0].firstflight.depdate);t[1]=[o.getDateString(o.getDateWith(v,"-12y",!0)),o.getDateString(o.getDateWith(v,"-2y",!0))],t[2]=[o.getDateString(o.getDateWith(v,"-2y",!0)),o.getDateString(o.getDateWith(v,"-14d",!0))];var m=[],y=[],b=[],w=[],E=[],S=[],x=[],T,N,C,A,O,_,D,H,B,j=[],F={},I=s.t==="R"?flightData.segments[0].firstflight.cabinname+","+flightData.segments[1].firstflight.cabinname:flightData.segments[0].firstflight.cabinname,q=s.t==="R"?flightData.segments[0].firstflight.depdate+" "+flightData.segments[0].firstflight.deptime+","+flightData.segments[1].firstflight.arrdate+" "+flightData.segments[1].firstflight.arrtime:flightData.segments[0].firstflight.depdate+" "+flightData.segments[0].firstflight.deptime,R="",W=flightData.segments[0].firstflight.codeshare===""?"0":"1";W=s.t==="R"?W+"##"+(flightData.segments[1].firstflight.codeshare===""?"0":"1"):W,s.t==="R"?flightData.segments[0].firstflight.flightno&&flightData.segments[1].firstflight.flightno?R=flightData.segments[0].firstflight.flightno+","+flightData.segments[1].firstflight.flightno:R=flightData.segments[0].firstflight.flight[0]+","+flightData.segments[1].firstflight.flight[0]:flightData.segments[0].firstflight.flightno?R=flightData.segments[0].firstflight.flightno:R=flightData.segments[0].firstflight.flight[0],isviplogin&&e.ajax({type:"POST",url:"/B2C40/query/jaxb/hyzj/query.ao",data:{depAirPort:flightData.segments[0].firstflight.depport,arrAirPort:flightData.segments[0].firstflight.arrport,departureClass:I,flightDate:q,isReturn:s.t==="R"?"Y":"N",codeshare:W,filghtNo:R},dataType:"json",async:!1,success:function(e){e&&e.hasOwnProperty("success")&&e.hasOwnProperty("data")&&e.success&&e.data.hasOwnProperty("relationship")&&(Ot.hyzjship=e.data.relationship,Ot.gethyzjNoData())}}),Ft.OLDFUEL=[],Ft.OLDTAX=[],e.each(flightData.segments,function(e){F=flightData.segments[e],sandsArray.push(F.sandsflag);var t=F.firstflight,n=F.secondflight,r=a[e];if(t){T=parseInt(t.price[0]),N=parseInt(t.price[1]),C=parseInt(t.price[2]),currentAdultFuel=parseInt(t.fuel[0]),currentChildFuel=parseInt(t.fuel[1]),currentBabyFuel=parseInt(t.fuel[2]),Ft.OLDFUEL.push(t.fuel),Ft.OLDTAX.push(t.tax),D=parseInt(t.tax),F.firstflight.deptime=t.deptime.replace(/^(\d{2})(\d{2})$/,"$1:$2"),F.firstflight.depportname=t.depportname,F.firstflight.depdate=t.depdate,F.firstflight.depport=t.depport,F.firstflight.arrtime=t.arrtime.replace(/^(\d{2})(\d{2})$/,"$1:$2"),F.firstflight.arrportname=t.arrportname,F.firstflight.arrdate=t.arrdate,F.firstflight.arrport=t.arrport,F.firstflight.flightno=t.flightno,F.firstflight.price=t.price,F.firstflight.cabinname=t.cabinname,F.firstflight.upcabinInfo=t.pinfo,F.firstflight.fgprice=t.fgprice,F.firstflight.depcity=t.depcity,F.firstflight.arrcity=t.arrcity,isviplogin&&Ot.hyzjship&&Ot.gethyzjconpun(e,s.at,t,"firstflight"),excessTicketCount.info.push(F.firstflight.cabininfo),Ft.OLDSEAT.push(F.firstflight.cabininfo),isviplogin=t.isviplogin,iszxPricebool=iszxPricebool&&t.flight&&t.flight[1]==="Y"?!0:!1;if(isNNbool!==2||!isNaddN)(!isNaddN||F.sandsflag=="2"&&isNaddN)&&t.flytype==="2"&&(F.sandsflag=="1"||F.sandsflag=="2"&&t.price[0]==0)?(isNaddN=!0,isNNbool++):isNaddN=!1;KQTCABIN.push(F.firstflight.roundtripcabin),Ft.OLD_FARABASIS.push(t.farebasis),Ft.OLD_FAREREFERENCE.push(t.farereference),Ft.OLD_CABIN.push(t.cabinname),flightNums+=1}n&&(F.segmenttype==="2"?(T+=parseInt(0),N+=parseInt(0),C+=parseInt(0)):(T+=parseInt(n.price[0]),N+=parseInt(n.price[1]),C+=parseInt(n.price[2])),currentAdultFuel+=parseInt(n.fuel[0]),currentChildFuel+=parseInt(n.fuel[1]),currentBabyFuel+=parseInt(n.fuel[2]),Ft.OLDFUEL.push(n.fuel),Ft.OLDTAX.push(n.tax),D+=parseInt(n.tax),F.secondflight.deptime=n.deptime.replace(/^(\d{2})(\d{2})$/,"$1:$2"),F.secondflight.depportname=n.depportname,F.secondflight.depdate=n.depdate,F.secondflight.depport=n.depport,F.secondflight.arrtime=n.arrtime.replace(/^(\d{2})(\d{2})$/,"$1:$2"),F.secondflight.arrportname=n.arrportname,F.secondflight.arrdate=n.arrdate,F.secondflight.arrport=n.arrport,F.secondflight.flightno=n.flightno,F.secondflight.price=n.price,F.secondflight.cabinname=n.cabinname,F.secondflight.upcabinInfo=n.pinfo,F.secondflight.fgprice=n.fgprice,F.secondflight.depcity=n.depcity,F.secondflight.arrcity=n.arrcity,isviplogin&&Ot.hyzjship&&Ot.gethyzjconpun(e,s.at,n,"secondflight"),excessTicketCount.info.push(F.secondflight.cabininfo),OLDSEAT.push(F.secondflight.cabininfo),flightNums+=1,isviplogin=t.isviplogin),m.push(T),y.push(N),b.push(C),w.push(currentAdultFuel),E.push(currentChildFuel),S.push(currentBabyFuel),x.push(D),F.tripName=r,j.push(F)}),BEGINPRICE=[parseInt(J(m)),parseInt(J(y)),parseInt(J(b))],PRICE=[parseInt(J(m)),parseInt(J(y)),parseInt(J(b))],FUEL=[parseInt(J(w)),parseInt(J(E)),parseInt(J(S))],TAX=parseInt(J(x)),k=j,Ft.OLDFUELCount=FUEL;var X=0,V=[],K="<page>";for(var c=0;c<j.length;c++){var Q=j[c].firstflight,G=Q.depdate,Y=Q.deptime,et=Q.cabinname,tt=Q.upcabinInfo,nt=Q.pprice;if(tt&&nt){var rt=Q.codeshare;if(rt!=="TRUE"){K+="<segment><segorder>"+X+"</segorder>"+"<depport>"+Q.depport+"</depport>"+"<arrport>"+Q.arrport+"</arrport>"+"<flightno>"+Q.flightno+"</flightno>"+"<cabinbeforeupgrade>"+et+"</cabinbeforeupgrade>"+"<flightdate>"+G+" "+Y+"</flightdate>"+"<upcabinInfo>>9</upcabinInfo>"+"<adultprice>"+Q.price[0]+"</adultprice>"+"</segment>",V[X]=!0,L.fgprice.push(Q.fgprice),L.pprice.push(nt),L.pinfo.push(tt),L.oldprice.push(Q.price[0]),L.beforecabin.push(et),L.segorder=X,X++;continue}}V[X]=!1,X++;if(j[c].secondflight){Q=j[c].firstflight,G=Q.depdate,Y=Q.deptime,et=Q.cabinname,tt=Q.upcabinInfo,nt=Q.pprice;if(tt&&nt){var rt=Q.codeshare;if(rt!=="TRUE"){K+="<segment><segorder>"+X+"</segorder>"+"<depport>"+Q.depport+"</depport>"+"<arrport>"+Q.arrport+"</arrport>"+"<flightno>"+Q.flightno+"</flightno>"+"<cabinbeforeupgrade>"+et+"</cabinbeforeupgrade>"+"<flightdate>"+G+" "+Y+"</flightdate>"+"<upcabinInfo>>9</upcabinInfo>"+"<adultprice>"+Q.price[0]+"</adultprice>"+"</segment>",L.fgprice.push(Q.fgprice),L.oldprice.push(Q.price[0]),L.pinfo.push(tt),L.pprice.push(nt),V[X]=!0,L.beforecabin.push(et),L.segorder=X,X++;continue}}V[X]=!1,X++}}K+="<language>"+n+"</language></page>",L.checkflightUpgradeData=K,e.inArray(!0,V)>-1?(U=f.checkFlightUpgrades(L),U.length>0?z=!0:z=!1):z=!1,k=j,g[0]=parseInt(flightData.adult)?parseInt(flightData.adult):1,g[1]=parseInt(flightData.child),g[2]=parseInt(flightData.infant),i={price:PRICE,fuel:FUEL,tax:TAX,segments:j}}else o.showAlertBox(p.psg320);typeof r=="function"&&r(i)};l(function(t){var n=[],r=[],t=t,i={price:t.price,fuel:t.fuel,tax:t.tax};if(t&&t.segments&&t.segments.length){var u=t.segments;e.each(u,function(e,t){var i=s.trip_summary(t);r.push(t),n.push(i)}),e("#flight-summary-box").prepend(n.join("")),e(".flight-summary-box").find(".flight-link").each(function(){var t=e(this);t.find("a").each(function(){e(this).on("click",function(e){e.preventDefault(),window.location.href=aHref})})}),o.setTooltip.call(e("#flight-summary-box"),{width:"470px",content:function(){var e=this.data("refund").split("|"),t=this.data("change").split("|"),n=this.data("sign"),r=g[1]!=0,i=g[2]!=0;return s.ticketBox({refund:e,change:t,sign:n,hasChild:r,hasInfant:i})}},".rule-tip")}var a=s.summary_sub(i);$summary.prepend(a),w.insuranceCost=Insurance}),e("#passenger-list").bind("psgAdded psgChanged psgDeled",function(t,n){e("#slight-summary-box").hasClass("loading")||tt(g)}),e("#last-btn").on("click",function(e){e.preventDefault(),window.location.href=aHref})},yt=function(t){if(j)return;e.ajax({type:"post",url:"/portal/svc/commonContacts/getSvcEContactPersonInfos",dataType:"json",asycn:!1,data:"{}",contentType:"application/json",success:function(e){var n=o.user.INFO;if(e.success&&e.data&&e.data.svcEContactPersonDtos&&e.data.svcEContactPersonDtos.length>0){if(t==="nomember"&&e.data.svcEContactPersonDtos[0]){var r=e.data.svcEContactPersonDtos[0];bt({name:r.contactName,phone:r.mobilePhone,email:r.email})}o.creaDropDown(e.data.svcEContactPersonDtos.slice(0,10),"contact_name","contact-moblie")}else bt({name:n.userName,phone:n.cellphone,email:n.email})}})},bt=function(t){t.name&&e("#contact_name").val(/^(\d{11})|(.+@.+)$/.test(t.name)?"":t.name),/^\d{11}$/.test(t.phone)&&e("#contact-moblie").val(o.mobliehide(t.phone)).attr("mobile",t.phone),/^.+@.+$/.test(t.email)&&e("#email").val(t.email)},wt=!1,Et=function(){var t=function(t){e("#common-passengers").removeClass("loading");var n=e("#common-passenger-list").html(t).on("click",".c-p",function(t){t.preventDefault();var n=e(this),i=this.hash.replace("#","");if(/c-p-disabled/i.test(this.className))return!1;if(!n.hasClass("c-p-used")){var s=Number(l[i].pType),u=p.psg351.replace(/\{0\}/g,N[s]);if(s===1&&S.child||s===2&&S.infant)return o.alertBox(u,p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),!1}s===2&&e("#zxprice_box .coupon-checkbox")&&e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&(o.alertBox(p.psg600,r.login.login32),e("#zxprice_box .coupon-checkbox").click()),l[i].pIdCard=l[i].pIdCard?l[i].pIdCard.toUpperCase():"",e("#passenger-list").triggerHandler(n.hasClass("c-p-used")?"delPsg":"addPsg",l[i])});e("#passenger-list").bind("psgAdded psgDeled",function(e,t){var r=nt(),i=e.type==="psgAdded";l[t]&&(l[t].cls=i?"c-p-used":""),n.find(".c-p[href='#"+t+"']").toggleClass("c-p-used",i).siblings(".c-p:not(.c-p-used)"),n.find("#"+t).toggleClass("c-p-used",i).siblings(".c-p:not(.c-p-used)")}),wt=!0};H==="member"||H==="nomember"?e.ajax({type:"post",url:" /portal/svcPassenger/getSvcEPassenger",dataType:"json",data:"{}",asycn:!1,contentType:"application/json",success:function(n){var r=n;if(r.success){var i=[],o=[],u=r.data.svcEPassengerDtos,a=u.length;if(a===0){e("#common-passengers").remove();return}a=a>100?100:a;for(var f=0;f<a;f++){var c=u[f];A||O?(O&&c.psgType==="0"&&(I==="NI"&&c.IDTYPE===p.psg023&&o.push(c),I==="PP"&&c.IDTYPE===p.psg024&&o.push(c)),A&&(c.psgType==="0"&&(I==="NI"&&c.IDTYPE===p.psg023&&o.push(c),I==="PP"&&c.IDTYPE===p.psg024&&o.push(c)),c.psgType==="1"&&o.push(c))):o.push(c)}var a=o.length;a>10&&(e("#common-passengers .list_more").removeClass("hide"),e("#common-passengers .list_more").on("click",function(t){var n=e(this);n.attr("data-click")=="n"?(n.attr("data-click","y"),n.addClass("showmore"),e("#common-passenger-list").css({height:"auto"})):n.attr("data-click")=="y"&&(n.attr("data-click","n"),n.removeClass("showmore"),e("#common-passenger-list").css({height:"63px"}))}));for(var h=0;h<a;h++){var d=o[h],v,m;v={id:"comm"+d.psgId,cls:"",pIdCard:d.certNum,psgName:d.psgName,pIdType:d.certType,pType:parseInt(d.psgType,10)||0,pBirthday:d.birthday,pMobilePhone:d.mobilePhone,psgId:d.psgId,isInter:d.isInternational||"0",mpdCertNum:d.mpdCertNum||"",mpdCertType:d.mpdCertType||""},l[v.id]=v;var g=s.comm_tpl(v);i.push(g)}t(i.join("")),isgetpsginfo=!1}else e("#common-passengers").remove()}}):e("#common-passengers").remove()},St=function(e,t){var n=!0;if(e instanceof Array&&t)for(var r=0,i=e.length;r<i;r++)e[r]===t&&(boo=!1);return n},xt=function(e){if(P){if(e==="NI")return o.user.INFO.niid;if(e==="PP")return o.user.INFO.ppid;if(e==="ID")return o.user.INFO.otherid}return""},Tt=function(t){if(t==0){var n=s.solcardtpl(ispreUrlsol);e(this).append(n)}},Nt=function(){var t=["adult","child","baby"],i=e("#passenger-list"),a=[],l=function(){var t=i.find(".form").eq(0);t.attr("id","psg00000000");var n={pType:0,pIdType:"NI",insurance:[]},r={pType:0,pIdType:"PP",insurance:[]},a={};for(var l=0;l<insurance.showList.length;l++)a={insuranceType:insurance.showList[l].typeOfInsurance,insuranceCost:insurance.showList[l].insuranceCost,insuranceName:insurance.showList[l].insuranceName,chooseFlag:insurance.showList[l].isDefault&&insurance.showList[l].forPsgType.indexOf("0")!=-1},n.insurance[l]=a,r.insurance[l]=a;t.find(".select").each(function(){var t=e(this),i=t.data("type");A&&I&&I==="PP"?r[i]&&t.find(".option[data-value='"+r[i]+"']").addClass("checked"):n[i]&&t.find(".option[data-value='"+n[i]+"']").addClass("checked")}).setSelect(),ispreUrlsol&&Tt.call(t.find(".psg-idType"),0),A||O?q&&q.psgrtype&&(q.psgrtype.indexOf("CCM")>-1&&q.psgrtype.indexOf("CVN")>-1?(t.find(".psg-unionpay").addClass("show"),t.find(".psg-membernum").addClass("show")):q.psgrtype.indexOf("CCM")>-1?(t.find(".psg-unionpay").addClass("show"),t.find("input[name=membernum]").removeClass("input")):q.psgrtype.indexOf("CVN")>-1&&(t.find(".psg-membernum").addClass("show"),t.find("input[name=unionpay]").removeClass("input"))):(t.find("input[name=unionpay]").removeClass("input"),t.find("input[name=membernum]").removeClass("input")),t.on("change",".p-Type-sel",function(){if(P)return;var t=e(this);c(t)}).on("click",".p-idType-sel",function(){if(A&&I){var t=e(".option");I==="NI"&&t.each(function(){(e(this).data("value")==="PP"||e(this).data("value")==="ID")&&e(this).addClass("hide")}),I==="PP"&&t.each(function(){(e(this).data("value")==="NI"||e(this).data("value")==="ID")&&e(this).addClass("hide")})}}).on("change",".p-idType-sel",function(){var t=e(this),n=t.getSval().value,r=t.getSval().text,i=xt(n);b[t.closest(".form").get(0).id].pIdType=n,b[t.closest(".form").get(0).id].pIdCardType=r;var s=t.closest(".psg-block").find(".psg-name-input");s.poshytip("hide"),i&&(t.closest(".controls").find(".psg-idType-input").val(i),n==="PP"&&!/^[a-zA-Z\/]+$/.test(s.val())&&s.val(o.user.INFO.userEnName),(n==="ID"||n==="NI")&&/^[a-zA-Z\/]+$/.test(s.val())&&s.val(o.user.INFO.userName));var a=u.isPsgName(s.val(),n==="NI"?!0:!1);a?s.removeClass("error"):o.settip.call(s,p.psg312)}).on("change",".insurance-box .check-box-icon",function(t){t.stopPropagation();var n=e(this),r=n.attr("data-value");for(var s=0;s<b[n.closest(".form").get(0).id].insurance.length;s++)b[n.closest(".form").get(0).id].insurance[s].insuranceType==r&&(b[n.closest(".form").get(0).id].insurance[s].chooseFlag=n.prop("checked"));var o=n.closest(".insurance-box"),u=!1;if(o.find(".item-info"))var a=o.find(".item-info");for(var s=0,f=a.length;s<f;s++){if(a.eq(s).find(".check-box-icon").prop("checked")){u=!0;break}u=!1}u?o.addClass("insuranceiconshow"):o.removeClass("insuranceiconshow"),i.triggerHandler("psgChanged")}).on("change","input",function(){var n=rt.call(e(this)),r=e(this).closest(".form").get(0).id,i=b[r];this.name=="psgName"?i.psgName=n:this.name=="pIdCard"?(i.pIdCard=n,i.pIdCardType=e(this).closest(".form").find(".p-idType-sel").getSval().text):this.name=="unionpay"?i.pUnionpay=n:this.name=="membernum"&&(i.pMembernum=n),pt(),this.name=="pBirthday"&&(this.value=u.formateDate(this.value)),i[this.name]=n,v.call(t,i);if(z){var s=f.checkPsgUpgrades();s?(s.uuid&&(upgradeReportId=s.uuid),kt()):Ct()}ht();if(e(this).attr("name")=="pIdCard"&&i.pType==0&&n!=""&&isviplogin&&discountvalue!=0&&olddataflight.length>0&&newdataflight.length>0&&vipNoPsg.length>0){var o=!0;e.grep(vipNoPsg,function(t,i){t.toUpperCase()==n.toUpperCase()&&St(vippsgid,r)&&(vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(newdataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]-=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").hide(),e("#isdiscount").show()),vippsgid.push(r),vipinputval.push(n),tt(g),o=!1)});if(o&&vippsgid.length>0)for(var a=0;a<vippsgid.length;a++)if(vippsgid[a]==r&&vipinputval[a].toUpperCase()!=n.toUpperCase()){var l=!0;vippsgid=V(vippsgid,vippsgid[a]),vipinputval=V(vipinputval,vipinputval[a]),e.grep(vipNoPsg,function(e,t){e==n&&(l=!1,vippsgid.push(r),vipinputval.push(n))}),l&&vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(olddataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue,e("#isnondiscount").show(),e("#isdiscount").hide(),tt(g))}}}).on("focus",".psg-idType-input",function(){var t=e(this),n=t.closest(".psg-block");if(n.find(".p-idType-sel").getSval().value==="PP"){var r=t.offset(),i=e("#tip-bluesimple-idtype");i.length>0?i.show():(e("body").append(s.showidType),e("#tip-bluesimple-idtype").unbind("mouseout").bind("mouseout",function(){e(this).hide()}).unbind("mouseover").bind("mouseover",function(){e(this).show()})),e("#tip-bluesimple-idtype").css({left:r.left,top:r.top+t.outerHeight()+5})}}),A&&I&&I==="PP"?b.psg00000000=r:b.psg00000000=n;if(g[0])if(g[0]!=1||g[1]!=0||g[2]!=0)for(var l=0,h=g.length;l<h;l++){var d=0;l==0?d=g[0]-1:d=g[l];for(var m=0,w=d;m<w;m++){var E={pType:l};g[l]--,y.call(i,E).removeClass("loading")}}if(nt()>=9){var S=nt()>=9;e("#passenger-block").toggleClass("isFull",S),e("#addNewPsg").toggleClass("flat-btn-disabled",S)}tt(g)},c=function(t){var n=t.getSval("value"),i=t.closest(".psg-block"),s=i.find(".psg-idType"),u=i.find(".psg-birthday"),a=i.find(".psg-carryBy"),f=i.find(".psg-membernum"),l=i.find(".psg-unionpay");psgInsurance=i.find(".insurance-box"),n==2&&e("#zxprice_box .coupon-checkbox")&&e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&(o.alertBox(p.psg600,r.login.login32),e("#zxprice_box .coupon-checkbox").click()),i.find(".insurance-box .check-box-icon").each(function(t){var r=insurance[e(this).attr("data-value")];r.forPsgType.indexOf(n)!=-1?(i.find(".insurance-box .item-info").eq(t).removeClass("hide"),e(this).prop("checked",r.isDefault)):(i.find(".insurance-box .item-info").eq(t).addClass("hide"),e(this).prop("checked",!1))}),i.find(".input").each(function(){e(this).val("")}),i.attr("data-type",n),i.removeClass("form-passed").addClass("newForm");var c="#"+i.attr("id");e(c).removeClass("c-p-used"),s.find(".select-trigger").text(T.NI);if(n==0){if(ispreUrlsol){var h=i.find(".psg-sol-card");h&&h.length>0?h.show():Tt.call(i.find(".psg-idType"),0)}}else i.find(".psg-sol-card").remove();n==0?(s.hasClass("show")||(s.addClass("show"),s.find("input").addClass("input")),u.hasClass("show")&&(u.removeClass("show"),u.find("input").removeClass("input")),a.hasClass("show")&&(a.removeClass("show"),a.find("input").removeClass("input")),(A||O)&&q&&q.psgrtype&&(q.psgrtype.indexOf("CCM")>-1&&q.psgrtype.indexOf("CVN")>-1?(f.hasClass("show")||f.addClass("show"),l.hasClass("show")||l.addClass("show")):q.psgrtype.indexOf("CCM")>-1?(l.hasClass("show")||(l.addClass("show"),l.find("input[name=unionpay]").addClass("input")),i.find("input[name=membernum]").removeClass("input")):q.psgrtype.indexOf("CVN")>-1&&(f.hasClass("show")||(f.addClass("show"),l.find("input[name=membernum]").addClass("input")),i.find("input[name=unionpay]").removeClass("input")))):n==1?(s.hasClass("show")||(s.addClass("show"),s.find("input").addClass("input")),u.hasClass("show")||(u.addClass("show"),u.find("input").addClass("input")),a.hasClass("show")&&(a.removeClass("show"),a.find("input").removeClass("input")),f.hasClass("show")&&(f.removeClass("show"),i.find("input[name=membernum]").removeClass("input")),l.hasClass("show")&&(l.removeClass("show"),i.find("input[name=unionpay]").removeClass("input"))):n==2&&(s.hasClass("show")&&(s.removeClass("show"),s.find("input").removeClass("input")),u.hasClass("show")||(u.addClass("show"),u.find("input").addClass("input")),a.hasClass("show")||(a.addClass("show"),a.find("input").addClass("input"),pt()),f.hasClass("show")&&(f.removeClass("show"),i.find("input[name=membernum]").removeClass("input")),l.hasClass("show")&&(l.removeClass("show"),i.find("input[name=unionpay]").removeClass("input")))},h=function(t){var n=b[t],r=e("#passenger-list").find("#"+t),s=r.find("input[name=psgName]").val(),o=r.data("type"),u=r.find(".error");(u||u.length)&&u.each(function(t){e(this).removeClass("error"),e("#"+e(this).attr("aria-describedby")).remove()}).poshytip("hide"),n.pIdCard!=""&&vippsgid.length>0&&vipinputval.length>0&&n.pType==0&&isviplogin&&discountvalue!=0&&olddataflight.length>0&&newdataflight.length>0&&vipNoPsg.length>0&&e.grep(vipNoPsg,function(t,r){if(t.toUpperCase()==n.pIdCard.toUpperCase()){for(var i=0;i<vippsgid.length;i++)t.toUpperCase()==vipinputval[i].toUpperCase()&&(vipinputval=V(vipinputval,vipinputval[i]),vippsgid=V(vippsgid,vippsgid[i]));vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(olddataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").show(),e("#isdiscount").hide())}});if(r.hasClass("noDel")){r.find("input").each(function(){e(this).val("")}),r.removeClass("form-passed").addClass("newForm"),r.attr("id","psg00000000"),b.psg00000000={psgName:r.find("input[name=psgName]").val(),pType:r.find(".p-Type-sel").getSval("value"),pIdType:r.find(".p-idType-sel").getSval("value"),pIdCard:r.find("input[name=pIdCard]").val(),psolCard:ispreUrlsol?r.find("input[name=psolCard]").val():"",pMembernum:r.find("input[name=membernum]").val(),pUnionpay:r.find("input[name=unionpay]").val(),insurance:[]};for(var a=0;a<insurance.showList.length;a++){var l={insuranceType:insurance.showList[a].typeOfInsurance,insuranceCost:insurance.showList[a].insuranceCost,insuranceName:insurance.showList[a].insuranceName,chooseFlag:insurance.showList[a].isDefault&&insurance.showList[a].forPsgType.indexOf("0")!=-1};b.psg00000000.insurance[a]=l}}else g[n.pType]--,r.remove();delete b[t],pt(),i.triggerHandler("psgDeled",t);if(z){var c=f.checkPsgUpgrades();c?(c.uuid&&(upgradeReportId=c.uuid),kt()):Ct()}e("#mer_coupon").length>0&&Ot.changeCouponbyid(n.pIdCard,""),e("#coupon-block").length>0&&e("#coupon-block .checked").find(".couponclick").click(),e("#mer_coupon").length>0&&Ot.delCoupon(s,o),ht()},d=function(t){var n=b[t],r=n.pIdCard,s=e("#passenger-list").find("#"+t),o=s.find("input[name=psgName]").val(),u=s.data("type"),a=s.find(".error");(a||a.length)&&a.each(function(t){e(this).removeClass("error"),e("#"+e(this).attr("aria-describedby")).remove()}).poshytip("hide"),n.pIdCard!=""&&vippsgid.length>0&&vipinputval.length>0&&n.pType==0&&isviplogin&&discountvalue!=0&&olddataflight.length>0&&newdataflight.length>0&&vipNoPsg.length>0&&e.grep(vipNoPsg,function(t,r){if(t.toUpperCase()==n.pIdCard.toUpperCase()){for(var i=0;i<vippsgid.length;i++)t.toUpperCase()==vipinputval[i].toUpperCase()&&(vipinputval=V(vipinputval,vipinputval[i]),vippsgid=V(vippsgid,vippsgid[i]));vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(olddataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").show(),e("#isdiscount").hide())}}),delete b[t],s.find("input").each(function(){e(this).val("")}),s.removeClass("form-passed").addClass("newForm"),s.attr("id","psg00000000"),b.psg00000000={psgName:s.find("input[name=psgName]").val(),pType:s.find(".p-Type-sel").getSval("value"),pIdType:s.find(".p-idType-sel").getSval("value"),pIdCard:s.find("input[name=pIdCard]").val(),pMembernum:s.find("input[name=membernum]").val(),pUnionpay:s.find("input[name=unionpay]").val(),insurance:[]};for(var l=0;l<insurance.showList.length;l++){var c={insuranceType:insurance.showList[l].typeOfInsurance,insuranceCost:insurance.showList[l].insuranceCost,insuranceName:insurance.showList[l].insuranceName,chooseFlag:insurance.showList[l].isDefault&&insurance.showList[l].forPsgType.indexOf("0")!=-1};b.psg00000000.insurance[l]=c}pt(),i.triggerHandler("psgDeled",t);if(z){var h=f.checkPsgUpgrades();h?(h.uuid&&(upgradeReportId=h.uuid),kt()):Ct()}e("#mer_coupon").length>0&&Ot.changeCouponbyid(r,null),e("#coupon-block").length>0&&e("#coupon-block .checked").find(".couponclick").click(),e("#mer_coupon").length>0&&Ot.delCoupon(o,u),ht()},v=function(e){var t=!e.psgName&&!e.pIdCard,n=e.psgName;this.toggleClass("newForm",!!(e.pType?t&&!e.pBirthday:t)).toggleClass("form-passed",!!(e.pType?n&&e.pBirthday:n))},m=function(){var e=nt()-g[2],t=excessTicketCount.info,n=t[0].substring(t[0].length-1,t[0].length),r=t[1]?t[1].substring(t[1].length-1,t[0].length):undefined,i=!1;return r?n>r||n===r?excessTicketCount.excessNum=parseInt(r):excessTicketCount.excessNum=parseInt(n):excessTicketCount.excessNum=parseInt(n),excessTicketCount.excessNum<e?ISKQT?o.showAlertBox(p.psg531):o.showAlertBox(p.psg321):i=!0,i},y=function(t){var a=this,l=t.pType>0&&t.pType<3?+t.pType:0,h=l==0?"prepend":"append";t.id=t.id||"psg"+e.now(),t.psgId=t.psgId||"",t.pType=l,t.psgName=t.psgName?t.psgName:"",t.pBirthday=t.pBirthday?t.pBirthday:"",t.pIdType=t.pIdType?t.pIdType:"",t.pIdCard=t.pIdCard?t.pIdCard:"",t.psolCard=t.psolCard&&ispreUrlsol?t.psolCard:"",t.language=n,t.pMembernum=t.pMembernum?t.pMembernum:"",t.pUnionpay=t.pUnionpay?t.pUinonpay:"",t.isInter=t.isInter||"0",t.mpdCertNum=t.mpdCertNum||"",t.mpdCertyType=t.mpdCertyType||"";var d=b[t.id]?b[t.id].pIdCard:"";I&&I==="PP"&&(t.pIdType=p.psg024);switch(l){case 0:t.pIdTypeShow="show",t.pBirthdayShow="",t.pCarrayByShow="",(A||O)&&q&&q.psgrtype&&(q.psgrtype.indexOf("CCM")>-1&&q.psgrtype.indexOf("CVN")>-1?(t.pMembernumShow="show",t.pUnionpayShow="show"):q.psgrtype.indexOf("CCM")>-1?(t.pMembernumShow="",t.pUnionpayShow="show"):q.psgrtype.indexOf("CVN")>-1&&(t.pMembernumShow="show",t.pUnionpayShow="")),t.pIdCard!=""&&isviplogin&&discountvalue!=0&&olddataflight.length>0&&newdataflight.length>0&&vipNoPsg.length>0&&e.grep(vipNoPsg,function(n,r){n.toUpperCase()==t.pIdCard.toUpperCase()&&St(vippsgid,t.id)&&(vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(newdataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]-=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").hide(),e("#isdiscount").show()),vippsgid.push(t.id),vipinputval.push(n))});break;case 1:t.pIdTypeShow="show",t.pBirthdayShow="show",t.pCarrayByShow="";break;case 2:t.pIdTypeShow="",t.pBirthdayShow="show",t.pCarrayByShow="show"}var y=e(s.form_tpl(t)),w=s.insurance_tpl({insuranceList:insurance.showList,pType:t.pType,psgId:t.id,lang:r.lang}),E=t.pIdType?t.pIdType:"",x="";y.find(".psg-insurance").append(w),E==p.psg023||E==""||E=="NI"?x="NI":E==p.psg024||E=="PP"||E=="P"?x="PP":x="ID",y.find(".option[data-value='"+l+"']").addClass("checked"),y.find(".option[data-value='"+x+"']").addClass("checked"),y.find("input[name=pIdCard]").val(t.pIdCard),y.find("input[name=psgName]").val(t.psgName).data("psgId",t.psgId).data("isInter",t.isInter),v.call(y,t),y.find(".select").each(function(){var n=e(this),r=n.data("type");t[r]&&n.find(".option[data-value='"+t[r]+"']").addClass("checked")}).setSelect(),l==0?(b[t.id]={psgName:y.find("input[name=psgName]").val(),pType:y.find(".p-Type-sel").getSval("value"),pIdType:y.find(".p-idType-sel").getSval("value"),pIdCard:y.find("input[name=pIdCard]").val(),psolCard:ispreUrlsol?y.find("input[name=psolCard]").val():"",pMembernum:y.find("input[name=membernum]").val(),pUnionpay:y.find("input[name=unionpay]").val(),insurance:[]},y.find("input[name=pBirthday]").removeClass("input"),A||O?q&&q.psgrtype&&(q.psgrtype.indexOf("CCM")>-1&&q.psgrtype.indexOf("CVN")>-1||(q.psgrtype.indexOf("CCM")>-1?y.find("input[name=membernum]").removeClass("input"):q.psgrtype.indexOf("CVN")>-1&&y.find("input[name=unionpay]").removeClass("input"))):(y.find("input[name=membernum]").removeClass("input"),y.find("input[name=unionpay]").removeClass("input"))):l==1?(b[t.id]={psgName:y.find("input[name=psgName]").val(),pType:y.find(".p-Type-sel").getSval("value"),pIdType:y.find(".p-idType-sel").getSval("value"),pIdCard:y.find("input[name=pIdCard]").val(),psolCard:ispreUrlsol?y.find("input[name=psolCard]").val():"",insurance:[]},y.find("input[name=membernum]").removeClass("input"),y.find("input[name=unionpay]").removeClass("input")):(b[t.id]={psgName:y.find("input[name=psgName]").val(),pType:y.find(".p-Type-sel").getSval("value"),pCarryBy:y.find(".psg-carry").getSval().text,insurance:[]},y.find("input[name=pIdCard]").removeClass("input"),y.find("input[name=membernum]").removeClass("input"),y.find("input[name=unionpay]").removeClass("input"));for(var T=0;T<insurance.showList.length;T++){var C={insuranceType:insurance.showList[T].typeOfInsurance,insuranceCost:insurance.showList[T].insuranceCost,insuranceName:insurance.showList[T].insuranceName,chooseFlag:insurance.showList[T].isDefault&&insurance.showList[T].forPsgType.indexOf(l)!=-1};b[t.id].insurance[T]=C}ispreUrlsol&&Tt.call(y.find(".psg-idType"),l),(ispreUrlsol===1&&t.mpdCertType==="MD"||ispreUrlsol===2&&t.mpdCertType==="PD")&&y.find(".psg-sol-input").val(t.mpdCertNum);var k=0;y.find(".p-idType-sel").bind("change",function(t){t.stopPropagation();var n=e(this),r=n.getSval().value,i=n.getSval().text;b[n.closest(".form").get(0).id].pIdType=r,b[n.closest(".form").get(0).id].pIdCardType=i;var s=n.closest(".psg-block").find(".psg-name-input");s.poshytip("hide");var a=u.isPsgName(s.val(),r==="NI"?!0:!1);a?s.removeClass("error"):o.settip.call(s,p.psg312)}).end().on("click",".p-Type-sel",function(t){t.stopPropagation(),k=e(this).closest(".form").attr("data-type")}).on("change",".p-Type-sel",function(){var t=e(this),n,i=e(this).closest(".form"),s=i.attr("data-type"),u=t.getSval("value");n=i.get(0).id;if(u==1&&S.child||u==2&&S.infant){var a=s==1?"(2-11"+p.psg067+")":s==1?" (<2 "+p.psg067+")":" (≥12"+p.psg067+")";return o.alertBox(p.psg351.replace(/\{0\}/g,N[Number(u)]),p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),t.find(".select-trigger").html(N[Number(s)]+a),!1}b[n].pType=u,g[s]-=1,g[b[n].pType]+=1;if(st()){c(t);for(var f=0;f<insurance.showList.length;f++)for(var l=0;l<b[n].insurance.length;l++)if(b[n].insurance[l].insuranceType==insurance.showList[f].typeOfInsurance){b[n].insurance[l].chooseFlag=insurance.showList[f].isDefault&&insurance.showList[f].forPsgType.indexOf(b[n].pType)!=-1;break}var h="psgType"+b[n].pType,d=t.closest(".form"),v=d.attr("class").split(" ");e.each(v,function(e,t){t.indexOf("psgType")>-1&&(d.removeClass(t),d.addClass(h))}),tt(g)}else g[s]+=1,g[b[n].pType]-=1,t.find(".select-trigger").text(N[s])}).on("click",".psg-birthday-input",function(e){var t=0;if(n=="zh")t=0;else if(t=1)t=1;vt(this,"yyyy-MM-dd",t)}).on("change",".psg-carry",function(t){t.stopPropagation();var n=e(this),r=n.getSval().text;b[n.closest(".form").get(0).id].pCarryBy=r}).on("change",".insurance-box .check-box-icon",function(t){t.stopPropagation();var n=e(this),r=n.attr("data-value");for(var s=0;s<b[n.closest(".form").get(0).id].insurance.length;s++)b[n.closest(".form").get(0).id].insurance[s].insuranceType==r&&(b[n.closest(".form").get(0).id].insurance[s].chooseFlag=n.prop("checked"));var o=n.closest(".insurance-box"),u=!1;if(o.find(".item-info"))var a=o.find(".item-info");for(var s=0,f=a.length;s<f;s++){if(a.eq(s).find(".check-box-icon").prop("checked")){u=!0;break}u=!1}u?o.addClass("insuranceiconshow"):o.removeClass("insuranceiconshow"),i.triggerHandler("psgChanged")}).on("click",".coupon-psg-checkbox",function(){var t=e(this);t.toggleClass("checked");var n=t.hasClass("checked")}).on("change",".input",function(t){var n=e(this).closest(".form"),r=n.attr("id"),i=rt.call(e(this));if(!e("#comconpunbox").hasClass("hide")&&e(this).attr("name")=="psgName"&&!e(this).hasClass("error")){var s=b[r].psgName;s&&s!=i&&e("#conpunshow .upgrade_passenger").each(function(){var t=e(this).find(".select-trigger");t.html()===s&&(t.html(""),e(this).find("input[name=coupon_psg]").val(""))})}pt();var o=n.hasClass("noDel");ht();var a="#"+r,l=o?"psg00000000":"psg"+e.now(),c=n.find("input[name=psgName]").val(),h=n.find(".p-Type-sel").getSval("value"),p=n.find(".p-idType-sel").getSval().value,d=n.find("input[name=pIdCard]").val(),m=ispreUrlsol?n.find("input[name=psolCard]").val():"",y=n.find(".p-idType-sel").getSval().text,w=n.find(".psg-carry").getSval().text,E=n.find("input[name=membernum]").val(),S=n.find("input[name=unionpay]").val(),x=n.find("input[name=psgName]").data("psgId"),T=n.find("input[name=psgName]").data("isInter"),N={};n.find(".check-box-icon").each(function(){var t=e(this).attr("data-value");N[t]=e(this).prop("checked")}),e(this).hasClass("checkedInput")?l=r:(e(a).removeClass("c-p-used"),n.attr("id",l),delete b[r]),h===0||h===1?b[l]={psgName:c,pType:h,pIdType:p?p:"",pIdCard:d?d:"",psolCard:ispreUrlsol&&m?m:"",pIdCardType:y?y:"",pMembernum:E?E:"",pUnionpay:S?S:"",insurance:[],psgId:x||"",isInter:T}:h===2&&(b[l]={psgName:c,pType:h,insurance:[],pCarryBy:w,psgId:x||"",isInter:T});for(var C=0;C<insurance.showList.length;C++){var k={insuranceType:insurance.showList[C].typeOfInsurance,insuranceCost:insurance.showList[C].insuranceCost,insuranceName:insurance.showList[C].insuranceName,chooseFlag:N[insurance.showList[C].typeOfInsurance]};b[l].insurance[C]=k}this.name=="pBirthday"&&(this.value=u.formateDate(this.value));var L=b[l];L[this.name]=i,v.call(n,L);if(z){var A=f.checkPsgUpgrades();A?(A.uuid&&(upgradeReportId=A.uuid),kt()):Ct()}if(e(this).attr("name")=="pIdCard"&&L.pType==0&&i!=""&&isviplogin&&discountvalue!=0&&olddataflight.length>0&&newdataflight.length>0&&vipNoPsg.length>0){var O=!0;e.grep(vipNoPsg,function(t,n){t.toUpperCase()==i.toUpperCase()&&St(vippsgid,l)&&(vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(newdataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]-=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").hide(),e("#isdiscount").show()),vippsgid.push(l),vipinputval.push(i),tt(g),O=!1)});if(O&&vippsgid.length>0)for(var M=0;M<vippsgid.length;M++)if(vippsgid[M]==r&&vipinputval[M].toUpperCase()!=i.toUpperCase()){var _=!0;vippsgid=V(vippsgid,vippsgid[M]),vipinputval=V(vipinputval,vipinputval[M]),e.grep(vipNoPsg,function(e,t){e.toUpperCase()==i.toUpperCase()&&(_=!1,vippsgid.push(l),vipinputval.push(i))}),_&&vippsgid.length==0&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(e.grep(olddataflight,function(e,t){var n=Number(e.segOrder);flightData.segments[n].firstflight.price[0]=e.adult,flightData.segments[n].firstflight.farereference[0]=e.fareReference,flightData.segments[n].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue,e("#isnondiscount").show(),e("#isdiscount").hide(),tt(g))}}}).on("focus",".psg-idType-input",function(){var t=e(this),n=t.closest(".psg-block");if(n.find(".p-idType-sel").getSval().value==="PP"){var r=t.offset(),i=e("#tip-bluesimple-idtype");i.length>0?i.show():(e("body").append(s.showidType),e("#tip-bluesimple-idtype").unbind("mouseout").bind("mouseout",function(){e(this).hide()}).unbind("mouseover").bind("mouseover",function(){e(this).show()})),e("#tip-bluesimple-idtype").css({left:r.left,top:r.top+t.outerHeight()+5})}}).find(".p-birthday").placeholder(),y.find(".helper-trigger").each(function(){if(e(this).data("type")==="insurance"||e(this).data("type")==="insurance_refund"){var t=e(this).data("index"),n=r.lang==="zh"?insurance.showList[t].detailDescUrlZH:insurance.showList[t].detailDescUrlEN;e(this).poshytip({content:s[e(this).data("type")]({url:n}),className:"tip-bluesimple2",alignTo:"target",alignX:"inner-right",offsetY:0,offsetX:-125})}else o.showtip(e(this),s[e(this).data("type")],"center","top")});if(a.hasClass("form")){var L=a.get(0).id;L=="psg00000000"&&(y.find(".p-del").addClass("hide"),y.find(".p-cls").removeClass("hide"),y.addClass("noDel")),delete b[L];var M=a.find(".error");(M||M.length)&&M.each(function(t){e(this).removeClass("error"),e("#"+e(this).attr("aria-describedby")).remove()}).poshytip("hide"),a.replaceWith(y)}else{if(!m())return!1;g[l]++,a=y.appendTo(i),a[h](y)}if(z){var _=f.checkPsgUpgrades();_?(_.uuid&&(upgradeReportId=_.uuid),kt()):Ct()}pt(),ht();var D=y.find(".psg-carryBy");i.trigger("psgAdded",t.id);if(isaddno||A&&!issolbool||O){var P=e(".option");isnocz||O?P.each(function(){(e(this).data("value")==1||e(this).data("value")==2)&&e(this).addClass("hide")}):P.each(function(){e(this).data("value")==2&&e(this).addClass("hide")})}if(A&&I){var P=e(".option");I==="NI"&&P.each(function(){(e(this).data("value")==="PP"||e(this).data("value")==="ID")&&e(this).addClass("hide")}),I==="PP"&&P.each(function(){(e(this).data("value")==="NI"||e(this).data("value")==="ID")&&e(this).addClass("hide")})}return e("#mer_coupon").length>0&&t.pIdCard&&Ot.changeCouponbyid(d,t.pIdCard),i};l(),P?(e("#addNewPsg").addClass("flat-btn-disabled"),e("#passenger-list .psg-name").eq(0).find(".controls").append("<div class='onlyMemTips'>"+p.psg066+"</div>"),e("#passenger-list .p-cls").eq(0).addClass("flat-btn-disabled")):(e("#addNewPsg").bind("click",function(t){t.preventDefault();var n=e(this);if(n.hasClass("flat-btn-disabled")&&nt()>=9)return o.showAlertBox(p.psg317),!1;if(!m())return!1;y.call(i,{}).removeClass("loading"),Ct()}),i.on("click",".p-cls",function(n){n.preventDefault();var r,s=e(this),o=s.closest(".psg-block");s.hasClass("block-delter")?r=o.find(".psgType0").get(0).id:(r=s.closest(".form").get(0).id,o.find(".carryPsg[data-type='"+t[b[r].pType]+"']").removeClass("hide")),o.find(".p-idType-sel").data("options").find(".option[data-value='NI']").trigger("click"),d(r);var u=o.find(".check-box-icon"),a=u.attr("data-value");P||u.attr("value","on"),u.prop("checked",!1);for(var f=0;f<b[u.closest(".form").get(0).id].insurance.length;f++)b[u.closest(".form").get(0).id].insurance[f].insuranceType==a&&(b[u.closest(".form").get(0).id].insurance[f].chooseFlag=u.prop("checked"));i.triggerHandler("psgChanged")})),i.on("click",".p-del",function(n){n.preventDefault();var r,i=e(this),s=i.closest(".psg-block");i.hasClass("block-delter")?r=s.find(".psgType0").get(0).id:(r=i.closest(".form").get(0).id,s.find(".carryPsg[data-type='"+t[b[r].pType]+"']").removeClass("hide")),h(r)}).bind("addPsg",function(e,t){if(t){var n=t.pType,r=i.find(".psgType"+n+".newForm:first");r.length?y.call(r,t):(g[n]+=1,st()?(g[n]-=1,y.call(i,t)):g[n]-=1)}}).bind("delPsg",function(e,t){t&&t.id&&h(t.id)}).bind("psgAdded psgDeled",function(t){var n=nt()>=9;e("#passenger-block").toggleClass("isFull",n),e("#addNewPsg").toggleClass("flat-btn-disabled",n)})},Ct=function(){e("#recommendUpgrades").remove(),PRICE[0]=BEGINPRICE[0],e("#priceup").text("￥"+PRICE[0]*g[0]),tt(g)},kt=function(){var t="";if(segtype==="S"){var n=flightData.segments[0].segmenttype;n=="0"?(t=s.singleUpgrade(U),e("#recommendUpgrades").length===0&&(e("body").after(t),e("#openClose1").show(),e(".selectLabClass").each(function(t){e(this).on("click",function(t){t.preventDefault(),Lt(e(this))}),typeof dcsPageTrack=="function"&&U[t]&&U[t].hasOwnProperty("beforecabin")&&U[t].hasOwnProperty("aftercabin")&&U[t].hasOwnProperty("oldprice")&&U[t].hasOwnProperty("newprice")&&dcsPageTrack("DCS.dcsuri","/B2C40/modules/permissionnew/main/passenger.html/recommendUpgrades",!1,"WT.al_bfupcabin",U[t].beforecabin,!1,"WT.al_afupcabin",U[t].aftercabin,!1,"WT.al_pricegap",U[t].oldprice,!1,"WT.al_afupprice",U[t].newprice,!1);var n=e("#adlistContent li").length,r=3;if(n<7){r=parseInt(n/2);var i=n%2===0?(n+1)*130:n*130;e("#mycarousel").width(i)}e.Scroll({waitTime:3e3,inner:"#adlistContent",left:".leftbtn",right:".rightbtn",cennum:r})}))):n=="3"&&(t=s.multipleUpgrade(U),e("#recommendUpgrades").length===0&&(e("body").after(t),e("#openClose3").show(),e(".upgradecheckbox").each(function(t){var n=e(this);n.on("click",function(){var t=n.attr("data-order"),r=n.attr("data-city");n.hasClass("checked")?e("#recommendUpgrades").find("DIV[data-city='"+r+"'][data-order='"+t+"']").removeClass("checked"):e("#recommendUpgrades").find("DIV[data-city='"+r+"'][data-order='"+t+"']").addClass("checked"),At(n)}),typeof dcsPageTrack=="function"&&U[t]&&U[t].hasOwnProperty("beforecabin")&&U[t].hasOwnProperty("aftercabin")&&U[t].hasOwnProperty("oldprice")&&U[t].hasOwnProperty("newprice")&&dcsPageTrack("DCS.dcsuri","/B2C40/modules/permissionnew/main/passenger.html/recommendUpgrades",!1,"WT.al_bfupcabin",U[t].beforecabin,!1,"WT.al_afupcabin",U[t].aftercabin,!1,"WT.al_pricegap",U[t].oldprice,!1,"WT.al_afupprice",U[t].newprice,!1);var r=e("#adlistContent-"+t+" li").length,i=3;if(r<7){i=parseInt(r/2);var s=r%2===0?(r+1)*130:r*130;e("#mycarousel-"+t).width(s)}e("#adlistContent-"+t).length>0&&e.Scroll({waitTime:3e3,inner:"#adlistContent-"+t,left:".leftbtn",right:".rightbtn",cennum:i})})))}else segtype!=="S"&&(t=s.multipleUpgrade(U),e("#recommendUpgrades").length===0&&e("body").after(t),e("#openClose3").show(),e(".upgradecheckbox").each(function(t){var n=e(this);n.on("click",function(){var t=n.attr("data-order"),r=n.attr("data-city");n.hasClass("checked")?e("#recommendUpgrades").find("DIV[data-city='"+r+"'][data-order='"+t+"']").removeClass("checked"):e("#recommendUpgrades").find("DIV[data-city='"+r+"'][data-order='"+t+"']").addClass("checked"),At(n)}),typeof dcsPageTrack=="function"&&U[t]&&U[t].hasOwnProperty("beforecabin")&&U[t].hasOwnProperty("aftercabin")&&U[t].hasOwnProperty("oldprice")&&U[t].hasOwnProperty("newprice")&&dcsPageTrack("DCS.dcsuri","/B2C40/modules/permissionnew/main/passenger.html/recommendUpgrades",!1,"WT.al_bfupcabin",U[t].beforecabin,!1,"WT.al_afupcabin",U[t].aftercabin,!1,"WT.al_pricegap",U[t].oldprice,!1,"WT.al_afupprice",U[t].newprice,!1);var r=e("#adlistContent-"+t+" li").length,i=3;if(r<7){i=parseInt(r/2);var s=r%2===0?(r+1)*130:r*130;e("#mycarousel-"+t).width(s)}e("#adlistContent-"+t).length>0&&e.Scroll({waitTime:3e3,inner:"#adlistContent-"+t,left:".leftbtn",right:".rightbtn",cennum:i})}));e(".closebtn").each(function(){e(this).on("click",function(){var t=e(this);f.showNav(t)})}),e(".showbtn").each(function(){e(this).on("click",function(){var t=e(this);f.closeNav(t)})}),e(window).scroll(function(){var t=e(document).scrollTop();t>=e(document).height()-e(window).height()?(e("#openClose1")&&e("#openClose1").hide().siblings(".openClose").show(),e("#openClose3")&&e("#openClose3").hide().siblings(".openClose").show()):(e("#openClose2")&&e("#openClose2").hide().siblings(".openClose").show(),e("#openClose4")&&e("#openClose4").hide().siblings(".openClose").show())})},Lt=function(t){var n=t.parent().find("INPUT[name='checkbox']");n.attr("checked")?(e("#recommendUpgrades").find("INPUT[name='checkbox']").removeAttr("checked"),e("#recommendUpgrades").find("A.selectLabClass").text(p.psg324),PRICE[0]=PRICE[0]-parseInt(t.attr("data-newprice"))+parseInt(t.attr("data-oldprice")),W=!1):(e("#recommendUpgrades").find("INPUT[name='checkbox']").attr("checked","checked"),e("#recommendUpgrades").find("A.selectLabClass").text(p.psg323),PRICE[0]=PRICE[0]-parseInt(t.attr("data-oldprice"))+parseInt(t.attr("data-newprice")),W=!0),e("#priceup").text("￥"+PRICE[0]*g[0]),tt(g)},At=function(t){var n=!1;t.hasClass("checked")?(PRICE[0]=PRICE[0]-parseInt(t.attr("data-oldprice"))+parseInt(t.attr("data-newprice")),W=!0):(PRICE[0]=PRICE[0]-parseInt(t.attr("data-newprice"))+parseInt(t.attr("data-oldprice")),W=!1),e("#priceup").text("￥"+PRICE[0]*g[0]),tt(g)},Ot={COUPON_LIST:[],COUPONPSGLIST:[],couponselected:[],FLIGHT_DATA:[],oldseg:[],getconpundata:"",cardsbyIDarr:{},_index:e.now(),_this:this,isfreight:!0,COUPON_DATA:{_index:this._index},init:function(){this.initPsgData(),this.initFilghtData(),this.showCouponBox()},adderrortips:function(t,n){var r=e(this),i=e.trim(r.attr("class")).replace(/\s+/g," ").split(" ");i.length<=2&&r.find(".conpunopc").html(t),r.data(n,t).removeClass("checked").addClass(n)},removeerrortips:function(t){var n=e(this),r=e.trim(n.attr("class")).replace(/\s+/g," ").split(" "),i=r.length;if(i<=2)return!1;if(i===3)n.find(".conpunopc").html("");else{var s=null;for(var o=2;o<i;o++)if(r[o]!==t){s=r[o];break}n.find(".conpunopc").html(s)}n.removeData(t).removeClass(t)},validateCouponNo:function(t){var n={},r=!0;discount=t.val();if(/\W+/.test(discount))return o.settip.call(t,p.psg212),r=!1,r;if(discount=="")return o.settip.call(t,p.psg207.replace("{0}",discount)),r=!1,r;if(discount.length!=12)return o.settip.call(t,p.psg208.replace("{0}",discount)),r=!1,r;var i=discount.substring(0,2),s=discount.substring(2,9),u=discount.substring(9,12);return isNaN(u)?(o.settip.call(t,p.psg208.replace("{0}",discount)),r=!1,r):Number(u)%5!=0?(o.settip.call(t,p.psg208.replace("{0}",discount)),r=!1,r):(e.grep(Ot.getconpuninfo,function(e,n){if(e.hasOwnProperty("discountCode")&&discount==e.discountCode)return o.settip.call(t,p.psg209.replace("{0}",discount)),r=!1,r}),r)},validatePsgFlight:function(t){var n,r,i,s,u,a={},f=!0;return t.find("input[name=coupon_psg]").each(function(t){r=e(this).attr("id"),n=r.substring(10,r.length),i=e(this),s=e("#counpon_flight"+n),u=s.val()+i.val(),i.val().replace(/\s/gi,"").length==0?(o.settip.call(e(this).next(),p.psg215),f=!1):e(this).next().removeClass("error"),a.hasOwnProperty(u)?(o.settip.call(e(s).next(),p.psg211.replace("{0}",i.val()).replace("{1}",s.val())),f=!1):(a[u]=u,e(s).next().removeClass("error"))}),f},getCouponData:function(){e(".coupon-list").each(function(t){var n,r=[],i=[];e(this).find("input").each(function(){e(this).attr("name")==="c_name"?n=e(this).val():e(this).attr("name")==="coupon_psg"?r=e(this).data("value").split("|"):e(this).attr("name")==="coupon_flight"&&(i=e(this).data("value").split("|"))}),counpon_data={discountCode:n,psgname:r[0],cardno:r[1],deptime:i[0],depport:i[1],arrport:i[2],adultprice:i[3],cabin:i[4],mobile:e("#contact-moblie").attr("mobile")},Ot.COUPON_LIST.push(counpon_data)})},delCoupon:function(t,n){t&&e("#coupon-block .upgrade_passenger").each(function(r){var i=e(this),s=i.siblings("input"),o=s.attr("data-value"),u=s.val();o=o=="|"?"":o;if(o!==""&&t==u){var a=Ot.COUPONPSGLIST[o];if(t==a.psgname&&n==a.psgtype){i.find(".select-trigger").html(""),i.siblings("input").val("").data("value","");var f=i.closest(".coupon-list");f.hasClass("checked")&&f.find(".couponclick").click()}}})},changeCouponbyid:function(t,n){var r=!1,i=null,s=null,o=null,u=e("#passenger-list li.form"),a=null,f=null,t=t?t.toUpperCase():t,n=n?n.toUpperCase():n;e("#conpunshow .iscards").each(function(){i=e(this),s=e(this).attr("cardsno"),r=i.hasClass("checked")?!0:!1,o=Ot.cardsbyIDarr[i.data("id")],f=i.data("userestriction");var l=!0;if(o)for(var c=0,h=o.length;c<h;c++){for(var d=0,v=u.length;d<v;d++){a=u.eq(d).find(".psg-idType-input").val();if(o[c]&&a&&o[c].toUpperCase()===a.toUpperCase()){l=!1;break}}if(!l)break}if(s){if(t===n)return!1;r&&t&&s.toUpperCase()===t.toUpperCase()?(i.find(".couponclick").click(),l&&i.addClass("disableid").find(".conpunopc").html(f==2?p.psg066:p.psg354)):!r&&n&&!l&&i.hasClass("disableid")?i.removeClass("disableid").find(".conpunopc").html(""):!r&&l&&!i.hasClass("disableid")&&i.addClass("disableid").find(".conpunopc").html(f==2?p.psg066:p.psg354)}else l?(r&&i.find(".couponclick").click(),i.addClass("disableid").find(".conpunopc").html(f==2?p.psg066:p.psg354)):i.removeClass("disableid").find(".conpunopc").html("")})},checkchangebyname:function(t,n){var r=e("#conpunplay .upgrade_passenger"),i=null;for(var s=0,o=r.length;s<o;s++){i=r.eq(s).find(".select-trigger");if(i.html()===t){i.html(n),r.eq(s).prev("input").val(n);break}}},addCoupon:function(){var t=e(this);t.closest(".coupon-list").append('<div class="loading"></div>');var n=t.val(),r=F.data.userId,i=Ot.getconpundata.replace(/[\"|\']deptime[\"|\']/g,'"discountCode":"'+n+'","userId" : "'+r+'","deptime"');e.ajax({type:"POST",url:"/portal/psg/discount/verifyCoupon",data:i,async:!1,dataType:"json",contentType:"application/json",success:function(r){if(!r.success)return r.errorCode==="204"?o.settip.call(t,p.psg561):r.errorMsg?o.settip.call(t,r.errorMsg):o.settip.call(t,p.psg208.replace("{0}",n)),e("#conpunplay .inputcounpun").find(".loading").remove(),!1;if(iscomprice&&r.data[0].discountType=="1")return e("#conpunplay .inputcounpun").find(".loading").remove(),o.settip.call(t,p.psg232),!1;if(issolbool&&r.data[0].discountType=="1")return e("#conpunplay .inputcounpun").find(".loading").remove(),o.settip.call(t,p.psg232),!1;if(P&&e.csairpreUrl(M)&&r.data[0].discountType=="1")return e("#conpunplay .inputcounpun").find(".loading").remove(),o.settip.call(t,p.psg232),!1;if(e("#newupgrade-box").length>0&&e("#newupgradeshow #disusealbediv").length>0&&r.data[0].discountType==="1")return e("#conpunplay .inputcounpun").find(".loading").remove(),o.settip.call(t,p.psg343),!1;Ot.initPsgData();var i=Ot.COUPONPSGLIST,u=!0;Ot.getconpuninfo.push(r.data[0]);if(r.data[0].idCards&&r.data[0].idCards.length>0){var a=Ot.cardsbyIDarr[r.data[0].id]=r.data[0].idCards;for(var f=0,l=i.length;f<l;f++){for(var c=0,h=a.length;c<h;c++)if(i[f].cardno&&a[c]&&i[f].cardno.toUpperCase()===a[c].toUpperCase()){u=!1;break}if(!u)break}}var d={info:r.data,psg:Ot.COUPON_DATA,index:Ot.getconpuninfo.length-1,adultnum:g[0],discard:u},v=s.coupon_only_tpl(d),m=t.closest(".coupon-list");m.before(v);var y=m.prev(".coupon-list");Ot.initCouponSelect.call(y.find(".upgrade_passenger")),Ot.initCouponSelect.call(y.find(".upgrade_flight"));var b=e("#conpunplay .conpunallwid"),w=e("#conpunplay .inputcounpun"),E=!1,S=!1;e("#conpunplay .checked").each(function(){e(this).hasClass("curprice")&&(E=!0),e(this).hasClass("flightprice")&&(S=!0)});if(b.find(".coupon-list").length>4){var x=Number(b.css("margin-left").replace("px",""))-Number(y.outerWidth())-18;b.width(Number(b.outerWidth())+Number(y.outerWidth())+18),b.animate({"margin-left":x+"px"},function(){w.find(".conpuninput").val(""),w.find(".conpunopc").html(p.psg226),w.removeClass("inputcounpun");var t=w.prev(".coupon-list");if(r.data[0].bindId){var n=!0;t.addClass("bindId").attr("data-id",r.data[0].bindId),e("#passenger-list .psg-idType-input").each(function(){e(this).val()!==""&&e(this).val()==r.data[0].bindId&&(n=!1)}),n&&t.addClass("disableid").find(".conpunopc").html(p.psg232)}Ot.conpunplay.call(e("#conpunshow")),E&&t.hasClass("flightprice")&&t.addClass("disable").find(".conpunopc").html(p.psg232),S&&t.hasClass("curprice")&&t.addClass("disable").find(".conpunopc").html(p.psg232)})}else{w.find(".conpuninput").val(""),w.find(".conpunopc").html(p.psg226),w.removeClass("inputcounpun");var T=w.prev(".coupon-list");if(r.data[0].bindId){var N=!0;T.addClass("bindId").attr("data-id",r.data[0].bindId),e("#passenger-list .psg-idType-input").each(function(){e(this).val()!==""&&e(this).val()==r.data[0].bindId&&(N=!1)}),N&&T.addClass("disableid").find(".conpunopc").html(p.psg232)}E&&T.hasClass("flightprice")&&T.addClass("disable").find(".conpunopc").html(p.psg232),S&&T.hasClass("curprice")&&T.addClass("disable").find(".conpunopc").html(p.psg232)}w.find(".loading").remove(),(g[0]+g[1]+g[2])*Ot.FLIGHT_DATA.length>1&&e("#coupon-block .checked").length>0&&Ot.isgatewayCode()},error:function(){msg&&msg.errorCode&&o.settip.call(t,v.numError02),e("#conpunplay .inputcounpun").find(".loading").remove()}})},couponUsefulDateCheck:function(e){var t=e.split("|"),n=new Date;m=n.getMonth()+1,d=n.getDate(),m=m>9?m:"0"+m,d=d>9?d:"0"+d;var r=Number(n.getFullYear()+m+d),i=Number(t[0].replace(/-/g,"")),s=Number(t[1].replace(/-/g,""));return r>=i&&r<=s},countCounpon:function(){var t=0,n=0,r=0;e("#coupon-block .checked").each(function(i){r=e(this).data("index"),Ot.hasOwnProperty("getconpuninfo")&&Ot.getconpuninfo&&Ot.getconpuninfo[r].hasOwnProperty("faceValue")&&(t+=1,n+=Number(Ot.getconpuninfo[r].faceValue))}),e("#useconpunnum").html(t),e("#comconpunprice").html(n)},conpunplay:function(){var t=e(this),n=t.find(".coupon-list"),r=t.find(".conpundir").removeClass("disablddir"),i=Number(n.eq(0).css("margin-right").replace("px","")),s=n.eq(0).outerWidth()+i;if(n.length>4){var o=t.find(".conpunallwid"),u=-Number(o.css("margin-left").replace("px","")),a=s*(n.length-4),f=a-s;u==0&&(r.eq(0).addClass("disablddir"),r.eq(1).removeClass("disablddir")),u==a&&(r.eq(1).addClass("disablddir"),r.eq(0).removeClass("disablddir")),o.width(Number(s)*n.length),t.on("click",".conpundir",function(){var t=e(this);if(!t.hasClass("disablddir")&&!t.hasClass("stopdir")){t.addClass("stopdir");if(t.hasClass("dirleft")){var n=Number(o.css("margin-left").replace("px",""))+s;o.animate({"margin-left":n+"px"},function(){t.removeClass("stopdir")}),n>=0&&-n<s&&(r.eq(0).addClass("disablddir"),r.eq(1).removeClass("disablddir")),-n!=a&&r.eq(1).removeClass("disablddir")}else{var n=Number(o.css("margin-left").replace("px",""))-s;o.animate({"margin-left":n+"px"},function(){t.removeClass("stopdir")}),f<-n&&-n<=a&&(r.eq(1).addClass("disablddir"),r.eq(0).removeClass("disablddir")),n!=0&&r.eq(0).removeClass("disablddir")}}})}else r.addClass("disablddir")},couponclick:function(){var t=e(this).closest(".coupon-list");if(t.hasClass("disable")||t.hasClass("unselect")||t.hasClass("disableid")||t.hasClass("unzxselect"))return!1;if(t.hasClass("checked")){t.removeClass("checked");var n=e("#coupon-block .coupon-list");n.each(function(t){!e(this).hasClass("unselect")&&e(this).find(".conpunopc").html()!==p.psg234&&(e(this).removeClass("disable"),t!==n.length-1?e(this).hasClass("unselect")||!e(this).hasClass("disableid")&&e(this).find(".conpunopc").html(""):e(this).find(".conpunopc").html(p.psg226))}),t.hasClass("flightprice")?e("#conpunshow .checked").length==0&&e("#conpunshow .curprice").removeClass("unselect").find(".conpunopc").html(""):g[0]==1&&e("#conpunshow .checked").length==0&&e("#conpunshow .flightprice").removeClass("unselect").find(".conpunopc").html("")}else if(!(t.hasClass("disable")||t.hasClass("unselect")||t.hasClass("disableid"))){var r=e("#coupon-block .checked").length+1,i=e("#passenger-list li").length,s=Ot.FLIGHT_DATA.length;t.addClass("checked");var o=null;if(t.hasClass("flightprice"))if(r==g[0]*s){var n=e("#coupon-block .coupon-list");n.each(function(t){o=e(this),o.hasClass("checked")||o.hasClass("disable")||o.hasClass("unselect")||(o.addClass("disable"),n.length-1!==t?!o.hasClass("disableid")&&o.find(".conpunopc").html(p.psg225.replace("{0}",r)):o.find(".conpunopc").html(p.psg230))})}else e("#conpunshow .curprice").addClass("unselect").find(".conpunopc").html(p.psg232);else if(r==i*s){var n=e("#coupon-block .coupon-list");n.each(function(t){o=e(this),o.hasClass("checked")||o.hasClass("disable")||o.hasClass("unselect")||(o.addClass("disable"),n.length-1!==t?!o.hasClass("disableid")&&o.find(".conpunopc").html(p.psg225.replace("{0}",r)):o.find(".conpunopc").html(p.psg230))})}else{var u=e("#conpunshow .flightprice");e("#conpunshow .flightprice").each(function(){!e(this).hasClass("unselect")&&e(this).find(".conpunopc").html()!==p.psg234&&e(this).addClass("unselect").find(".conpunopc").html(p.psg232)})}var a=e(this).find(".conpun-priceinfo .p").html();typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n","机票预订-国内",!0,"WT.si_p","旅客信息",!0,"WT.tx_mark",a,!0)}(g[0]+g[1]+g[2])*Ot.FLIGHT_DATA.length>1&&e("#coupon-block .checked").length>0&&Ot.isgatewayCode(),Ot.countCounpon()},isgatewayCode:function(){var t=e("#coupon-block .coupon-list"),n=Ot.getconpuninfo,r=null,i="";e("#coupon-block .checked").each(function(t){i===""?i=n[Number(e(this).data("index"))].gatewayCode.split(","):i=Ot.commonBetList(i,Ot.getconpuninfo[Number(e(this).data("index"))].gatewayCode.split(","))}),i&&t.each(function(t){r=e(this),!(r.hasClass("checked")||r.hasClass("disable")||r.hasClass("unselect"))&&n[t]&&Ot.commonBetList(i,n[t].gatewayCode.split(","))===""&&(r.addClass("disable"),r.find(".conpunopc").html(p.psg248))})},commonBetList:function(e,t){var n={},r=[];for(var i=0,s=e.length;i<s;i++)n[e[i]]=!0;for(var i=0,s=t.length;i<s;i++)typeof n[t[i]]!="undefined"&&r.push(t[i]);return r.length>0?r:""},showCouponBox:function(){e.ajax({type:"POST",url:"/portal/psg/discount/listDiscountByUserId",data:Ot.getconpundata,async:!0,dataType:"json",contentType:"application/json",success:function(t){if(t&&t.hasOwnProperty("success")&&t.success&&t.data){var n=e("#mer_coupon"),r=null;coupon_box=s.coupon_box,n.append(e(coupon_box)),Ot.getconpuninfo=t.data;var i=Ot.getconpuninfo.length,o=!0;for(var u=0;u<i;u++)r=Ot.getconpuninfo[u],r.idCards&&r.idCards.length>0&&(Ot.cardsbyIDarr[r.id]=r.idCards);var a={info:Ot.getconpuninfo,psg:Ot.COUPON_DATA,iscomprice:iscomprice,adultnum:g[0],isMember:!1,issolbool:issolbool};P&&e.csairpreUrl(M)&&(a.isMember=P);var f=s.coupon_tpl(a);e(f).appendTo(e("#coupon-block")),e("#comconpunnum").html(Number(Ot.COUPON_DATA.flight.length)*Number(Ot.COUPON_DATA.psg.length)),Ot.conpunplay.call(e("#conpunshow")),e("#coupon-box").on("click",".coupon-checkbox",function(){var t=e(this),n=e("#terms"),r=e("#coupon-block");t.toggleClass("coupon-checked");var i=t.hasClass("coupon-checked");n.attr("checked",i),r.toggleClass("hide"),e("#comconpunbox").toggleClass("hide"),e("#coupon-box .coupon-list").each(function(t){e(this).find(".select-trigger").html(""),e(this).find("input[name=coupon_psg]").val(""),Ot.initCouponSelect.call(e(this).find(".upgrade_passenger")),Ot.initCouponSelect.call(e(this).find(".upgrade_flight"))}),e(".tip-redsimple").remove()}).on("click",".couponclick",function(){Ot.couponclick.call(e(this))}).on("click",".addconpunclick",function(){var t=e(this).closest(".addconpun");t.hasClass("inputcounpun")||(t.addClass("inputcounpun"),t.find(".conpunopc").html(p.psg231),e(this).on("change",".conpuninput",function(){e(this).poshytip("hide"),e(this).hasClass("error")&&e(this).removeClass("error"),Ot.validateCouponNo(e(this))}).find(".conpunBtn").unbind("click").bind("click",function(t){t.stopPropagation();var n=e(this).siblings(".conpuninput");if(n.hasClass("error"))return!1;Ot.addCoupon.call(n)}))});var l=e("#coupon-box .helper-trigger");l.poshytip({content:s[l.data("type")],className:"tip-bluesimple2",alignTo:"target",alignX:"inner-right",offsetY:-5,offsetX:-10});var c="";e("#passenger-list .psg-idType-input").each(function(){c=e.trim(e(this).val()),c!==""&&e("#mer_coupon").length>0&&Ot.changeCouponbyid("",c)})}else e("#mer_coupon").remove()},error:function(){e("#mer_coupon").remove()}})},initCouponSelect:function(){e(this).hasClass("upgrade_passenger")&&e(this).bind("click",function(){Ot.initPsgData();var t="",n=e(this).closest(".coupon-list"),r=!1,i=Ot.cardsbyIDarr[n.data("id")];e.each(Ot.COUPONPSGLIST,function(e,s){r=!1;if(n.hasClass("iscards")){for(var o=0,u=i.length;o<u;o++)if(i[o]===s.cardno){r=!0;break}}else r=!0;(!n.hasClass("flightprice")||s.psgtype==0)&&r&&(t+="<li class='option' data-value='"+e+"' data-cardsno='"+s.cardno+"'>"+s.psgname+"</li>")}),e(this).data("options").html(t)}),e(this).setSelect().on("change",function(){var t=e(this),n=t.getSval(),r=n.text,i=n.value,s=t.data("options").find(".option").eq(i),o=s.data("cardsno");e(this).closest(".coupon-list").attr("cardsno",o),e(this).closest(".select").find(".select-trigger").text(r).end().prev().val(r).end().prev().attr("data-value",i)})},initFilghtData:function(){Ot.getconpundata="[",Ot.getwinconpundata=[],e.each(k,function(e,t){e!=0&&(Ot.getconpundata+=","),t.firstflight&&(t.firstflight.chooseCoupon=e+",firstflight",Ot.FLIGHT_DATA.push(t.firstflight),Ot.getconpundata+='{"deptime" : "'+t.firstflight.depdate+" "+t.firstflight.deptime+':00","depport" : "'+t.firstflight.depport+'","arrport" : "'+t.firstflight.arrport+'","adultprice" : "'+t.firstflight.price[0]+'","cabin" : "'+t.firstflight.cabinname+'","flightNo" : "'+t.firstflight.flightno+'"}',Ot.getwinconpundata[e+",firstflight"]='{"depport":"'+t.firstflight.depport+'","arrport":"'+t.firstflight.arrport+'","deptime":"'+t.firstflight.depdate+"T"+t.firstflight.deptime+'","arrtime":"'+t.firstflight.arrdate+"T"+t.firstflight.arrtime+'","flightno":"'+t.firstflight.flightno+'","plane":"'+t.firstflight.planetype+'","resBookDesigCode":"'+t.firstflight.cabinname+'","couponCode"}'),t.secondflight&&(t.secondflight.chooseCoupon=e+",secondflight",Ot.FLIGHT_DATA.push(t.secondflight),Ot.getconpundata+='{"deptime" : "'+t.secondflight.depdate+" "+t.secondflight.deptime+':00","depport" : "'+t.secondflight.depport+'","arrport" : "'+t.secondflight.arrport+'","adultprice" : "'+t.secondflight.price[0]+'","cabin" : "'+t.secondflight.cabinname+'","flightNo" : "'+t.secondflight.flightno+'"}',Ot.getwinconpundata[e+",secondflight"]='{"depport":"'+t.secondflight.depport+'","arrport":"'+t.secondflight.arrport+'","deptime":"'+t.secondflight.depdate+"T"+t.secondflight.deptime+'","arrtime":"'+t.secondflight.arrdate+"T"+t.secondflight.arrtime+'","flightno":"'+t.secondflight.flightno+'","plane":"'+t.secondflight.planetype+'","resBookDesigCode":"'+t.secondflight.cabinname+'","couponCode"}')}),Ot.getconpundata+="]",Ot.COUPON_DATA.flight=Ot.FLIGHT_DATA},initPsgData:function(){Ot.COUPONPSGLIST=[],e("#passenger-block li").each(function(t){var n=e(this).attr("data-type"),r=e(this).find(".psg-name-input"),i=e(this).find(".psg-idType-input");!r.hasClass("error")&&!i.hasClass("error")&&(data={psgname:r.val(),cardno:i.val(),psgtype:n},Ot.COUPONPSGLIST.push(data))}),this.COUPON_DATA.psg=this.COUPONPSGLIST},returnsegmentsData:function(e){if(!(e.length>0))return!1;for(var t=0;t<e.length;t++)e[t]&&e[t].hasOwnProperty("firstflight")?(flightData.segments[t].firstflight.farebasis[0]=e[t].firstflight.farebasis,flightData.segments[t].firstflight.farereference[0]=e[t].firstflight.farereference,flightData.segments[t].firstflight.price[0]=e[t].firstflight.price,flightData.segments[t].firstflight.productType=""):e[t]&&e[t].hasOwnProperty("secondflight")&&(flightData.segments[t].secondflight.farebasis[0]=e[t].secondflight.farebasis,flightData.segments[t].secondflight.farereference[0]=e[t].secondflight.farereference,flightData.segments[t].secondflight.price[0]=e[t].secondflight.price,flightData.segments[t].firstflight.productType="")},checkconpun:function(){var t=e("#conpunshow .checked"),n=!0;Ot.couponselected=[],Ot.couponcountvalue=0;for(var r=0;r<t.length;r++){var i=t.eq(r),s={},u=i.data("index");s.conpun=Ot.getconpuninfo[u];var a=i.find("input[name=coupon_psg]");u=Number(a.attr("data-value"));if(typeof u!="number"||i.find(".select-trigger").html()=="")return o.showAlertBox(p.psg213),!1;s.psg=Ot.COUPONPSGLIST[u];var f=s.conpun.faceValue;Ot.couponcountvalue+=f,s.flight=i.find("input[name=coupon_flight]").attr("data-value");var l=s.flight.split("|"),c=l[l.length-1].split(",");for(var h=r+1;h<t.length;h++){var d=t.eq(h);if(d.length>0){var v=Ot.getconpuninfo[d.data("index")].discountCode;if(s.conpun.discountCode==v)return o.showAlertBox(p.psg233),!1;if(s.psg.psgname==d.find(".select-trigger").html()&&s.flight==d.find("input[name=coupon_flight]").attr("data-value"))return o.showAlertBox(p.psg235),!1}}if(i.hasClass("flightprice")){var m="--";isviplogin&&vippsgid!=""&&vipinputval!=""&&Ot.hyzjship&&(m=Ot.hyzjship),e.ajax({type:"POST",url:"/portal/wallet/discount/queryHyzjandyjq",data:'{"groupid": "'+s.conpun.groupid+'", "hyzj":"'+m+'"}',async:!1,dataType:"json",contentType:"application/json",success:function(t){if(t&&t.hasOwnProperty("success")&&t.success&&t.hasOwnProperty("data")&&t.data&&t.data.hasOwnProperty("relationship")&&t.data.relationship){var r=flightData.segments,i=Number(c[0]),u=flightData.segments[i].firstflight.pinfo,a="";if(typeof u=="object"){a="";for(var h in u)a!==""&&(a+=","),a+=""+h+":"+(u[h]+"").match(/\d+/)[0]}var d="["+Ot.getwinconpundata[l[l.length-1]].replace('"couponCode"','"couponCode":"'+t.data.relationship+'","bookingClassAvails":"'+a+'"')+"]";s.conpun.relationship=t.data.relationship,e.ajax({type:"POST",url:"/B2C40/query/jaxb/discount/getCouponPrice.ao",data:{json:d},async:!1,dataType:"json",success:function(t){if(t&&t.hasOwnProperty("pricedItineraries")&&t.pricedItineraries.length>0&&Number(flightData.segments[i].firstflight.price[0])-Number(t.pricedItineraries[0].fareBreakDowns[0].baseFareAmount)==f){var u=t.pricedItineraries[0];s.conpun.couponNote=u.fareRuleInfos[0].couponNote,s.conpun.bookingClassAvails=a,Ot.oldseg[i]={},c[1]&&c[1]==="firstflight"&&r[i].hasOwnProperty("firstflight")?(Ot.oldseg[i].firstflight={},Ot.oldseg[i].firstflight.farebasis=flightData.segments[i].firstflight.farebasis[0],Ot.oldseg[i].firstflight.farereference=flightData.segments[i].firstflight.farereference[0],Ot.oldseg[i].firstflight.price=flightData.segments[i].firstflight.price[0],flightData.segments[i].firstflight.farebasis[0]=u.fareRuleInfos[0].fareBasis,flightData.segments[i].firstflight.farereference[0]=u.fareRuleInfos[0].fareReference,flightData.segments[i].firstflight.price[0]=u.fareBreakDowns[0].baseFareAmount,flightData.segments[i].firstflight.productType="YJYHQ",e.grep(newdataflight,function(e,t){e.segOrder==i&&e.flytypes=="firstflight"&&(newdataflight[t]="")})):c[1]&&c[1]==="secondflight"&&r[i].hasOwnProperty("secondflight")?(Ot.oldseg[i].secondflight={},Ot.oldseg[i].secondflight.farebasis=flightData.segments[i].secondflight.farebasis[0],Ot.oldseg[i].secondflight.farereference=flightData.segments[i].secondflight.farereference[0],Ot.oldseg[i].secondflight.price=flightData.segments[i].secondflight.price[0],flightData.segments[i].secondflight.farebasis[0]=u.fareRuleInfos[0].fareBasis,flightData.segments[i].secondflight.farereference[0]=u.fareRuleInfos[0].fareReference,flightData.segments[i].secondflight.price[0]=u.fareBreakDowns[0].baseFareAmount,flightData.segments[i].firstflight.productType="YJYHQ",e.grep(newdataflight,function(e,t){e.segOrder==i&&e.flytypes=="firstflight"&&(newdataflight[t]="")})):(o.showAlertBox(p.psg325+"001"),n=!1,Ot.returnsegmentsData(Ot.oldseg))}else o.showAlertBox(p.psg325+"002"),n=!1,Ot.returnsegmentsData(Ot.oldseg)},error:function(){o.showAlertBox(p.psg325+"003"),n=!1,Ot.returnsegmentsData(Ot.oldseg)}})}else o.showAlertBox(p.psg325+"004"),n=!1,Ot.returnsegmentsData(Ot.oldseg)},error:function(){o.showAlertBox(p.psg325+"005"),n=!1,Ot.returnsegmentsData(Ot.oldseg)}})}else isviplogin&&vippsgid!=""&&vipinputval!=""&&Ot.hyzjship&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")&&(Ot.hyzjselected=newdataflight);Ot.couponselected.push(s)}return n},gethyzjconpun:function(t,n,r,i){var s='[{"depport":"'+r.depport+'","arrport":"'+r.arrport+'","deptime":"'+r.depdate+"T"+r.deptime+'","arrtime":"'+r.arrdate+"T"+r.arrtime+'","flightno":"'+r.flightno+'","plane":"'+r.planetype+'","resBookDesigCode":"'+r.cabinname+'","couponCode":"'+Ot.hyzjship+'"}]';e.ajax({type:"POST",url:"/B2C40/query/jaxb/discount/getCouponPrice.ao",data:{json:s},async:!1,dataType:"json",success:function(s){if(s&&s.hasOwnProperty("pricedItineraries")&&s.pricedItineraries.length>0&&Number(r.price[0])-Number(s.pricedItineraries[0].fareBreakDowns[0].baseFareAmount)>0){var o=0,u=0,a=0,f=Number(t),l={},c={},h=s.pricedItineraries[0];c.adult=h.fareBreakDowns[0].baseFareAmount,c.owFareBasis=h.fareRuleInfos[0].fareBasis,c.fareReference=h.fareRuleInfos[0].fareReference,c.segOrder=f,c.couponNote=h.fareRuleInfos[0].couponNote,c.couponCode=h.fareRuleInfos[0].couponCode,c.flytypes=i;if(Number(c.adult)<Number(r.price[0])&&r.codeshare===""){var p=Number(flightData.segments[f].firstflight.price[0])-Number(c.adult);discountvalue+=p,l={adult:r.price[0],fareReference:r.farereference[0],owFareBasis:r.farebasis[0],segOrder:f,flytypes:i},o+=parseInt(h.fareBreakDowns[0].baseFareAmount),u+=parseInt(r.price[1]),a+=parseInt(r.price[2]),newdataflight.push(c),olddataflight.push(l)}e("#isnondiscount").show(),e("#isdiscount span").html(discountvalue*Number(n)),e("#isnondiscount span").html(discountvalue*Number(n)),ZJ_PRICE=[o,u,a]}}})},gethyzjNoData:function(){e.ajax({type:"POST",url:"/B2C40/query/jaxb/hyzj/userCertificates.ao",async:!1,dataType:"json",success:function(e){e&&e.hasOwnProperty("success")&&e.success&&e.data?vipNoPsg=e.data:Ot.hyzjship=""},error:function(){Ot.hyzjship=""}})}},Mt={isbool:!1,oldbool:[],oldflightData:[],init:function(){this.getFlightdata(),this.shownewUpgrdeBox()},getFlightdata:function(){Mt.getUpgradesdata="[";var t=ispreUrlsol?"Y":"N";e.each(k,function(e,n){e!=0&&(Mt.getUpgradesdata+=",");var r=n.secondflight?"1":"0";n.firstflight&&(Mt.getUpgradesdata+='{"dep":"'+n.firstflight.depport+'","arr":"'+n.firstflight.arrport+'","flightOrder" : "'+e+'","flightType" : "'+r+'","flightDate" : "'+n.firstflight.depdate.replace(/-/g,"")+'","flightNo" : "'+n.firstflight.flightno+'","cabin" : "'+n.firstflight.cabinname+'","price" : "'+n.firstflight.price[0]+'","isDisabledSoldierSid":"'+t+'"}'),n.secondflight&&(Mt.getUpgradesdata+='{"dep":"'+n.secondflight.depport+'","arr":"'+n.secondflight.arrport+'","flightOrder" : "'+e+'","flightType" : "'+r+'","flightDate" : "'+n.secondflight.depdate.replace(/-/g,"")+'","flightNo" : "'+n.secondflight.flightno+'","cabin" : "'+n.secondflight.cabinname+'","price" : "'+n.secondflight.price[0]+'","isDisabledSoldierSid":"'+t+'"}')}),Mt.getUpgradesdata+="]"},conpunplay:function(){var t=e(this),n=t.find(".grade-list"),r=t.find(".conpundir").removeClass("disablddir"),i=Number(n.eq(0).css("margin-right").replace("px","")),s=n.eq(0).outerWidth()+i;if(n.length>4){var o=t.find(".conpunallwid"),u=-Number(o.css("margin-left").replace("px","")),a=s*(n.length-4),f=a-s;u==0&&(r.eq(0).addClass("disablddir"),r.eq(1).removeClass("disablddir")),u==a&&(r.eq(1).addClass("disablddir"),r.eq(0).removeClass("disablddir")),o.width(Number(s)*n.length),t.on("click",".conpundir",function(){var t=e(this);if(!t.hasClass("disablddir")&&!t.hasClass("stopdir")){t.addClass("stopdir");if(t.hasClass("dirleft")){var n=Number(o.css("margin-left").replace("px",""))+s;o.animate({"margin-left":n+"px"},function(){t.removeClass("stopdir")}),n>=0&&-n<s&&(r.eq(0).addClass("disablddir"),r.eq(1).removeClass("disablddir")),-n!=a&&r.eq(1).removeClass("disablddir")}else{var n=Number(o.css("margin-left").replace("px",""))-s;o.animate({"margin-left":n+"px"},function(){t.removeClass("stopdir")}),f<-n&&-n<=a&&(r.eq(1).addClass("disablddir"),r.eq(0).removeClass("disablddir")),n!=0&&r.eq(0).removeClass("disablddir")}}})}else r.addClass("disablddir")},callcabinForname:function(e){var t=r.flight;switch(e.toUpperCase()){case"A":return t.fl0008;case"F":return t.fl0008;case"P":return t.fl0008;case"J":return t.fl0009;case"C":return t.fl0009;case"D":return t.fl0009;case"I":return t.fl0009;case"W":return t.fl0010;case"S":return t.fl0010;default:return""}},shownewUpgrdeBox:function(){e.ajax({type:"POST",url:"/B2C40/query/jaxb/direct/recommendCabin.ao",data:{jsonData:Mt.getUpgradesdata},async:!0,dataType:"json",success:function(t){if(t&&t.hasOwnProperty("Upgrades")&&t.Upgrades&&t.Upgrades.hasOwnProperty("cabin")&&t.Upgrades.cabin.length>0){var i=e("#newupgradeshow");upgrades_box=s.upgrades_box,i.append(e(upgrades_box)),e(".hot-icon").addClass(n);var u=-1,a="";Mt.getupgradeinfo=t.Upgrades.cabin;var f="",l=null,c=null;for(var h=0,d=Mt.getupgradeinfo.length;h<d;h++)if(Mt.getupgradeinfo[h].hasOwnProperty("Upgrade")){l=Mt.getupgradeinfo[h].Upgrade,l.length>1&&Number(l[0].PICE[0])>Number(l[1].PICE[0])&&(l=Mt.getupgradeinfo[h].Upgrade[0],Mt.getupgradeinfo[h].Upgrade[0]=Mt.getupgradeinfo[h].Upgrade[1],Mt.getupgradeinfo[h].Upgrade[1]=l),u!=-1?Number(u)>Number(Mt.getupgradeinfo[h].Upgrade[0].PICE[0])&&(u=Mt.getupgradeinfo[h].Upgrade[0].PICE[0],a=Mt.callcabinForname(Mt.getupgradeinfo[h].Upgrade[0].CABIN[0])):(u=Mt.getupgradeinfo[h].Upgrade[0].PICE[0],a=Mt.callcabinForname(Mt.getupgradeinfo[h].Upgrade[0].CABIN[0]));if(n==="en"){var v=window.UI;Mt.getupgradeinfo[h].Upgrade[0].DEPNAME[0]=v.getCityName(Mt.getupgradeinfo[h].Upgrade[0].DEPAIRPORT[0]),Mt.getupgradeinfo[h].Upgrade[0].ARRNAME[0]=v.getCityName(Mt.getupgradeinfo[h].Upgrade[0].ARRAIRPORT[0]),Mt.getupgradeinfo[h].Upgrade[1]&&(Mt.getupgradeinfo[h].Upgrade[1].DEPNAME[0]=v.getCityName(Mt.getupgradeinfo[h].Upgrade[1].DEPAIRPORT[0]),Mt.getupgradeinfo[h].Upgrade[1].ARRNAME[0]=v.getCityName(Mt.getupgradeinfo[h].Upgrade[1].ARRAIRPORT[0]))}l=Mt.getupgradeinfo[h].Upgrade,l[0].index=h,l[0].cabinname=Mt.callcabinForname(l[0].CABIN[0]),l[1]&&(l[1].cabinname=Mt.callcabinForname(l[1].CABIN[0])),f+=s.upgrades_tpl(l)}var m="元";n==="en"&&(m=" yuan");if(f){e("#gradeallwid").html(f),e("#comupgradenum").html(d),Mt.conpunplay.call(e("#gradeshow")),e("#newupgrade-box").on("click",".coupon-checkbox",function(){var t=e(this),n=e("#newupgrade-block");t.toggleClass("coupon-checked"),n.toggleClass("hide"),e("#comupgradebox").toggleClass("hide")}),e("#gradeplay .gradeBtn").bind("click",function(){var t=e(this);if(!t.hasClass("gradeload")){t.addClass("gradeload");var n=Number(e("#comupgradeprice").html()),i=Number(e("#useupgradenum").html()),u=0,a=null,f=0,l=0,c=0,h=null,d=g[0]+g[1],v=t.closest(".grade-list");u=Number(v.attr("data-index")),f=Number(t.attr("data-index")),h=Mt.getupgradeinfo[u].Upgrade[f],l=h.FLIGHTTYPE[0],c=Number(h.FLIGHTORDER[0]),l=l=="1"?"secondflight":"firstflight";if(d>Number(h.INFO[0]))o.showAlertBox(p.psg246.replace("{0}",h.INFO[0]));else{var m=e("#passenger-list > li"),y=!1,b=!1,w=null,E=null;if(!t.hasClass("gradechecked")){var x=Mt.getupgradeinfo[u].Upgrade[f];w=x.CHILDPRICE[0],E=x.INFANTPRICE[0]}else{var T=Mt.oldflightData[c][l];w=T.price[1],E=T.price[2]}for(var C=0,k=m.length;C<k;C++)m.eq(C).attr("data-type")==1&&(y=!0),m.eq(C).attr("data-type")==2&&(b=!0);if(!S.child&&!w&&y)return o.alertBox(p.psg351.replace(/\{0\}/g,N[1]),p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),t.removeClass("gradeload"),!1;if(!S.infant&&!E&&b)return o.alertBox(p.psg351.replace(/\{0\}/g,N[2]),p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),t.removeClass("gradeload"),!1;e("#disusealbediv").remove();if(!t.hasClass("gradechecked")){if(vippsgid.length>0&&vipinputval.length>0&&e("#isdiscount").css("display")!=="none"){var L=0;e.grep(olddataflight,function(e,t){L=Number(e.segOrder),flightData.segments[L].firstflight.price[0]=e.adult,flightData.segments[L].firstflight.farereference[0]=e.fareReference,flightData.segments[L].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue,e("#isnondiscount").show(),e("#isdiscount").hide()}var A=t.siblings(".gradeBtn");A.hasClass("gradechecked")?n-=Number(A.attr("data-price")):i+=1,A.hasClass("gradechecked")&&A.removeClass("gradechecked").find(".gradeBtn-right").text(p.psg562),t.addClass("gradechecked").find(".gradeBtn-right").text(p.psg563),e("#zxprice_box").append('<div id="disusealbediv" data-type="unzxpricebox"></div>'),e("#disusealbediv").poshytip({content:s[e("#disusealbediv").data("type")],className:"inter-tip-bluesimple",alignTo:"target",alignX:"inner-left",offsetY:-5,offsetX:-10}),n+=Number(t.attr("data-price"));if(Mt.oldbool[c]==undefined||Mt.oldbool[c])Mt.oldflightData[c]={},Mt.oldflightData[c][l]={},Mt.oldflightData[c][l].cabininfo=flightData.segments[c][l].cabininfo,Mt.oldflightData[c][l].cabinname=flightData.segments[c][l].cabinname,Mt.oldflightData[c][l].flightno=flightData.segments[c][l].flightno,Mt.oldflightData[c][l].farebasis=flightData.segments[c][l].farebasis,Mt.oldflightData[c][l].farereference=flightData.segments[c][l].farereference,Mt.oldflightData[c][l].price=flightData.segments[c][l].price,Mt.oldflightData[c][l].cabintype=flightData.segments[c][l].cabinname,Mt.oldbool[c]=!1;h=Mt.getupgradeinfo[u].Upgrade[f],flightData.segments[c][l].cabininfo=h.INFO[0],flightData.segments[c][l].cabinname=h.CABIN[0],flightData.segments[c][l].flightno=h.FLIGHTNO[0],flightData.segments[c][l].farebasis=[h.ADULTFAREBASIS[0],h.CHILDFAREBASIS[0],h.INFANTFAREBASIS[0]],flightData.segments[c][l].farereference=[h.FAREREFERENCE[0],h.CHILDFAREREFERENCE[0],h.INFANTFAREREFERENCE[0]],flightData.segments[c][l].price=[h.ADULTPRICE[0],h.CHILDPRICE[0],h.INFANTPRICE[0]];if(!S.child)h.CHILDPRICE[0]||(S.child=!0);else{var O=null,M=!1;for(var _=0,D=flightData.segments.length;_<D;_++)O=flightData.segments[_][l].price[1],!M&&!O&&(M=!0);S.child=M}if(!S.infant)h.INFANTPRICE[0]||(S.infant=!0);else{var P=null,M=!1;for(var _=0,D=flightData.segments.length;_<D;_++)P=flightData.segments[_][l].price[2],!M&&!P&&(M=!0);S.infant=M}PRICE=[0,0,0];for(var H=0,B=flightData.segments.length;H<B;H++){var j=flightData.segments[H];j.hasOwnProperty("firstflight")&&(PRICE[0]+=Number(j.firstflight.price[0]),PRICE[1]+=Number(j.firstflight.price[1]),PRICE[2]+=Number(j.firstflight.price[2])),j.hasOwnProperty("secondflight")&&(PRICE[0]+=Number(j.firstflight.price[0]),PRICE[1]+=Number(j.firstflight.price[1]),PRICE[2]+=Number(j.firstflight.price[2]))}excessTicketCount.info=h.INFO[0],v.find(".gradecabin").html(h.cabinname),v.find(".gradeprice .p").html(t.attr("data-price")),BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),tt(g),e("#comupgradeprice").html(n),e("#useupgradenum").html(i)}else{t.removeClass("gradechecked").find(".gradeBtn-right").text(p.psg562),n-=Number(t.attr("data-price")),i-=1;var F=Mt.oldflightData[c][l];flightData.segments[c][l].cabininfo=F.cabininfo,flightData.segments[c][l].cabinname=F.cabinname,flightData.segments[c][l].flightno=F.flightno,flightData.segments[c][l].farebasis=F.farebasis,flightData.segments[c][l].farereference=F.farereference,flightData.segments[c][l].price=F.price;if(!S.child)F.price[1]||(S.child=!0);else{var O=null,M=!1;for(var _=0,D=flightData.segments.length;_<D;_++)O=flightData.segments[_][l].price[1],!M&&!O&&(M=!0);S.child=M}if(!S.infant)F.price[2]||(S.infant=!0);else{var P=null,M=!1;for(var _=0,D=flightData.segments.length;_<D;_++)P=flightData.segments[_][l].price[2],!M&&!P&&(M=!0);S.infant=M}PRICE=[0,0,0];for(var H=0,B=flightData.segments.length;H<B;H++){var j=flightData.segments[H];j.hasOwnProperty("firstflight")&&(PRICE[0]+=Number(j.firstflight.price[0]),PRICE[1]+=Number(j.firstflight.price[1]),PRICE[2]+=Number(j.firstflight.price[2])),j.hasOwnProperty("secondflight")&&(PRICE[0]+=Number(j.firstflight.price[0]),PRICE[1]+=Number(j.firstflight.price[1]),PRICE[2]+=Number(j.firstflight.price[2]))}h=Mt.getupgradeinfo[u].Upgrade[0],excessTicketCount.info=F.cabininfo,v.find(".gradecabin").html(h.cabinname),v.find(".gradeprice .p").html(h.PICE[0]),BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]);if(vippsgid.length>0&&vipinputval.length>0&&e("#isnondiscount").css("display")!=="none"){var L=0;e.grep(newdataflight,function(e,t){L=Number(e.segOrder),flightData.segments[L].firstflight.price[0]=e.adult,flightData.segments[L].firstflight.farereference[0]=e.fareReference,flightData.segments[L].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]-=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").hide(),e("#isdiscount").show()}tt(g),n=n==0?"0.00":n,e("#comupgradeprice").html(n),e("#useupgradenum").html(i)}}t.removeClass("gradeload")}});var y=e("#newupgrade-box .helper-trigger");y.poshytip({content:s[y.data("type")],className:"tip-bluesimple2",alignTo:"target",alignX:"inner-right",offsetY:-5,offsetX:-10})}else e("#newupgradeshow").remove()}else e("#newupgradeshow").remove()},error:function(){e("#newupgradeshow").remove()}})}},_t=function(){var t=e("#protocol-checkbox");t.on("click",function(){e(this).hasClass("checked")?e(this).removeClass("checked"):e(this).addClass("checked")})},Dt=function(){var t=[],n=ispreUrlsol?parseInt(ispreUrlsol)===1?"MD":parseInt(ispreUrlsol)===2?"PD":"":"";for(var r in b)if(b.hasOwnProperty(r)&&r!=="contactor"){var i={psgName:b[r].psgName,psgType:b[r].pType,certType:b[r].pIdType?b[r].pIdType:"",certNum:b[r].pIdCard?b[r].pIdCard:"",fpCardNo:b[r].fpCardno?b[r].fpCardno:"",bcId:b[r].largeclientId?b[r].largeclientId:"",fpCompany:b[r].fpCompany?b[r].fpCompany:"",mobilePhone:b[r].mobilePhone?b[r].mobilePhone:"",email:b[r].email?b[r].email:"",birthday:b[r].pBirthday?b[r].pBirthday:"",psgId:b[r].psgId?b[r].psgId:"",isInternational:b[r].isInter||"0",mpdCertNum:b[r].psolCard||"",mpdCertType:n};t.push(i)}var s=JSON.stringify({ePassengerDtos:t});e.ajax({type:"POST",url:"/portal/svcPassenger/modifySvcEPassenger",data:s,dataType:"json",contentType:"application/json",success:function(e){e&&e.message==="SUCCESS"}})},Pt=function(){var t=F.data.userId,n=e("#psgid").val(),r=3,i=e("#contact_name").val().toUpperCase(),s=e("#contact_name").data("cpid"),o=e("#email").val(),u=b.contactor.c_mobile,a={contactName:i,mobilePhone:u,email:o};s&&(a.cpId=s),a=JSON.stringify(a),e.ajax({type:"POST",url:"/portal/svc/commonContacts/saveSvcEContactPersonsInfo",data:a,async:!0,processData:!1,contentType:"application/json",success:function(){}})},Ht=function(t,n){e.ajax({type:"POST",url:t,dataType:"xml",data:n,async:!0,processData:!1,contentType:"text/xml"})},Bt=function(t){var n,r,i,s,u,a,f={},l=flightData.segments[0].firstflight;for(var c=0;c<t.length;c++){var h=t[c].fareBreakDown[0],d=t[c].fareRuleInfo[0],v=h.passengerType;f[v]={price:h,fare:d}}e.each(f,function(e,t){e==="ADT"?(l.allprice[0].price=f.ADT.price.baseFareAmount,l.price[0]=f.ADT.price.baseFareAmount,l.farereference[0]=f.ADT.fare.fareReference,l.farebasis[0]=f.ADT.fare.fareBasis):e==="CNN"?(l.allprice[1].price=f.CNN.price.baseFareAmount,l.price[1]=f.CNN.price.baseFareAmount,l.farereference[1]=f.CNN.fare.fareReference,l.farebasis[1]=f.CNN.fare.fareBasis):(l.allprice[2].price=f.INF.price.baseFareAmount,l.price[2]=f.INF.price.baseFareAmount,l.farereference[2]=f.INF.fare.fareReference,l.farebasis[2]=f.INF.fare.fareBasis)}),flightData.segments[0].firstflight=l,flightData.priceChange=!0,ispreUrlsol?o.alertBox(p.psg068,p.psg227,p.psg353,!0,function(){jt()}):jt()},jt=function(){j||c.checkorder(function(e){if(e==="no"){o.showAlertBox(p.psg326);return}if(e==="check"){c.getVerifyCode();return}});var t=e("#contact-moblie").val(),r="comb("+t+")",i=new Date;y=i.getFullYear()+1,i.setFullYear(y),e.cookie("WT.al_ctact",r,{path:"/",domain:".csair.com",expire:i.toUTCString()});var t=e("#contact-moblie").val(),r="comb("+t+")",i=new Date;y=i.getFullYear()+1,i.setFullYear(y),e.cookie("WT.al_ctact",r,{path:"/",domain:".csair.com",expires:i});var t=e("#contact-moblie").val(),r="comb("+t+")",i=new Date;y=i.getFullYear()+1,i.setFullYear(y),e.cookie("WT.al_ctact",r,{path:"/",domain:".csair.com",expires:i});if(isviplogin&&vippsgid!=""&&vipinputval!=""&&Ot.hyzjship&&!e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked")&&!e("#gradeallwid .gradeBtn").hasClass("gradechecked")){Ot.hyzjselected=newdataflight;var s=0;e.grep(newdataflight,function(e,t){s=Number(e.segOrder),flightData.segments[s].firstflight.productType="HYZJ"})}var u=e("#conpunshow .checked");if(!e("#coupon-block").hasClass("hide")&&u.length>0&&!Ot.checkconpun())return!1;e("#loading").removeClass("hide"),j||(Dt(),Pt());var a=flightData.segments;for(var f=0;f<a.length;f++){var l=a[f],h=l.segmenttype;if(h=="2")zzflag=1;else if(h=="1"){var d=l.firstflight,v=d.flightno;v.substring(0,2)!=="CZ"&&(isnocz=!0)}else if(h=="0"){var d=l.firstflight,m=d.codeshare;m!==""&&(codeshareFlag=!0)}}var g="N";e("#passenger-list li.psg-block").each(function(t){var n=e(this);n.find(".check-box-icon").each(function(){var t=e(this).prop("checked");t&&(g="Y")})});var w="/B2C40/data/order/direct/createOrder.xsql";zzflag===1&&segtype==="S"?w="/B2C40/data/order/connect/createOrder.xsql":segtype==="S"&&isnocz&&(w="/B2C40/data/order/iet/direct/createOrder.xsql"),segtype==="R"&&isaddno&&(w="/B2C40/data/order/connect/createOrder.xsql"),isnocz&&(w="/B2C40/data/order/iet/direct/createOrder.xsql");var S=w+"?isFromNewSystem=Y&insureflag="+g;flightData.insurance=insurance,flightData.upgradeFlag=z,flightData.upgradeData=U,flightData.upgradeReportId=upgradeReportId,flightData.passengerData=b,flightData.ispreUrlsol=ispreUrlsol?Number(ispreUrlsol)+2:0,flightData.unionpay_cardno=O,flightData.preUrl=M,flightData.generalizelink=q,flightData.sandsArray=sandsArray,flightData.selectconpun=Ot.hasOwnProperty("couponselected")?Ot.couponselected:"",flightData.selecthyzj=Ot.hasOwnProperty("hyzjselected")?Ot.hyzjselected:"",flightData.iszslconpun=P&&!e.csairpreUrl(M),flightData.nb=nearbynb?nearbynb:"",flightData.conpunId=B;var x=c.create(flightData,insurance,segtype);if(!x){e("#loading").addClass("hide");return}e.ajax({type:"POST",url:S,async:!0,data:x,processData:!1,contentType:"text/xml",dataType:"xml",error:function(){e("#web_by_error").attr("content",p.psg520)},success:function(t){if(t){var r=e(t).find("MESSAGE"),i=e(t).find("IS_GXH_ERROR");if(r.length>0){e("#loading").addClass("hide");if(r.text().indexOf("黑名单")>-1)o.showAlertBox(p.psg417);else if(r.text().indexOf("票价更新功能")>0){var s=r.text().substring(r.text().indexOf("<pricedItinerary>"),r.text().indexOf("</pricedItinerary>")).replace("<pricedItinerary>",""),u=flightData.segments[0].firstflight.allprice[0].price,a="",f="",l=e(t).find("passengerType");s=JSON.parse(s),a=s[0].fareBreakDown[0].baseFareAmount,f=p.psg556+u+p.psg557+a+p.psg558,o.alertBox(f,p.psg559,p.psg560,!0,function(){Bt(s)},function(){flightParam=flightData.param,window.location.href=aHref})}else o.showAlertBox(r.text());typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n",p.psg521,!0,"WT.si_p",p.psg524,!0,"WT.error_msg",E.DECITY+"-"+E.ARCITY+"-"+E.DATE+"-"+r.text(),!0),e("#coupon-box .coupon-checked").length>0&&e("#conpunplay .checked").hasClass("flightprice")&&Ot.returnsegmentsData(Ot.oldseg)}else if(i.length>0)e("#loading").addClass("hide"),i.text().indexOf("黑名单")>-1?o.showAlertBox(p.psg417+p.psg426):o.showAlertBox(i.text()),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n",p.psg521,!0,"WT.si_p",p.psg524,!0,"WT.error_msg",E.DECITY+"-"+E.ARCITY+"-"+E.DATE+"-"+i.text(),!0),e("#coupon-box .coupon-checked").length>0&&e("#conpunplay .checked").hasClass("flightprice")&&Ot.returnsegmentsData(Ot.oldseg);else{var c=e(t).find("orderNo").text(),h=n==="en"?"&lang=en":"",d=W?"&WT.al_ordertype=upcabin":"",v=isviplogin&&vippsgid!=""&&vipinputval!=""?"&zsl="+discountvalue:"";if(c!==""){var m='<form action="/B2C40/uppPayment/jaxb/payment.ao" method="post" id="orderFormbox"><input type="hidden" name="orderNo" value="'+c+'"><input type="hidden" name="billType" value="O" ><input type="hidden" name="phone" value="'+e.trim(e("#contact-moblie").attr("mobile"))+'"><input type="hidden" name="contactName" value="'+e.trim(e("#contact_name").val())+'">';h!==""&&(m+='<input type="hidden" name="lang" value="en">'),v!==""&&(m+='<input type="hidden" name="zsl" value="'+discountvalue+'">'),d!==""&&(m+='<input type="hidden" name="WT.al_ordertype" value="'+upcabin+'">'),Ot.hasOwnProperty("couponcountvalue")&&Ot.couponcountvalue&&(m+='<input type="hidden" name="couponcountvalue" value="'+Ot.couponcountvalue+'">'),j&&(m+='<input type="hidden" name="wt_login" value="1">'),m+="</form>",e("#orderFormbox").length>0&&e("#orderFormbox").remove(),e("body").append(m),e("#orderFormbox").submit();return}e("#loading").addClass("hide"),o.showAlertBox(p.psg327),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n",p.psg521,!0,"WT.si_p",p.psg524,!0,"WT.error_msg",E.DECITY+"-"+E.ARCITY+"-"+E.DATE+"-"+p.psg327,!0),e("#coupon-box .coupon-checked").length>0&&e("#conpunplay .checked").hasClass("flightprice")&&Ot.returnsegmentsData(Ot.oldseg)}}else e("#loading").addClass("hide"),o.showAlertBox(p.psg327),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.si_n",p.psg521,!0,"WT.si_p",p.psg524,!0,"WT.error_msg",E.DECITY+"-"+E.ARCITY+"-"+E.DATE+"-"+p.psg327,!0),e("#coupon-box .coupon-checked").length>0&&e("#conpunplay .checked").hasClass("flightprice")&&Ot.returnsegmentsData(Ot.oldseg)}})},Ft={audltPrice:0,kqtaudltPrice:0,zxaudltPrice:0,oldaudltPrice:0,zxTotalPrice:0,totalPrice:0,backZXPRICE:[],backZXFUEL:[],KQTDATA:[],ZX_FARABASIS:[],ZX_FAREREFERENCE:[],KQT_FARABASIS:[],KQT_FAREREFERENCE:[],zx_excessTicketCount:[],cabin_array:[],KQT:!1,OLD_PRICE:[],ZX_PRICE:[],KQT_PRICE:[],OLDFUEL:[],ZXFUEL:[],KQTFUEL:[],KQTTAX:0,OLDSEAT:[],OLDTAX:0,ZXTAX:0,OLD_CABIN:[],BACK_ZX_PRICE:[],BACK_ZX_FULE:[],BACK_ZXTAX:0,OLD_FARABASIS:[],OLD_FAREREFERENCE:[],getPrice:function(){if(KQTCABIN.length<=0||KQTCABIN[0]==="--"||KQTCABIN[1]==="--"||undefined==KQTCABIN[0]||undefined==KQTCABIN[1])return;var t=KQTCABIN&&KQTCABIN.length>0?KQTCABIN[0]:"",n=KQTCABIN&&KQTCABIN.length>0?KQTCABIN[1]:"",r=""!=t?t.split("|"):undefined,i=""!=n?n.split("|"):undefined,s=[],u=[],a=0,f=0;Array.intersect=function(e,t){var n=0,r=0,i,s,o,u,a=new Array;while(n<e.length&&r<t.length)i=e[n].substring(0,1),o=e[n].substring(e[n].length-1,e[n].length),s=t[r].substring(0,1),u=t[r].substring(t[r].length-1,t[r].length),o=o==="A"?">9":o,u=u==="A"?">9":u,i<s?n++:i>s?r++:(a.push(e[n]+"|"+o+","+u),n++,r++);return a},s=Array.intersect(r,i),e.ajax({type:"POST",url:"/B2C40/query/jaxb/roundtrip/getPrice.ao?times=1&uuid="+uuid,data:{json:o.appendArray(ZX_PRICE_QUERY_PATAM)},async:!1,success:function(t){if(!(t.fareBasisInfo&&t.fareBasisInfo.hasOwnProperty("fareBasis")&&t.fareBasisInfo.hasOwnProperty("fareReference")&&t.fareBasisInfo.hasOwnProperty("roundTripPrice")&&t.fareBasisInfo.roundTripPrice.length>1))return;var n=t.fareBasisInfo;Ft.ZX_FARABASIS=n.fareBasis?n.fareBasis:undefined,Ft.ZX_FAREREFERENCE=n.fareReference?n.fareReference:undefined,Ft.ZX_frResultList=t.frResultList?t.frResultList:undefined;if(n.roundTripPrice&&n.fareBasis&&n.fareReference&&t.frResultList&&n.roundTripPrice.length>1){f=1;var r=!0,i=0;e.each(n.roundTripPrice,function(e,t){var e=Number(e);t.type=="ADT"?(r&&(Ft.ZX_PRICE[0]=t.price,Ft.audltPrice=t.price,Ft.BACK_ZX_PRICE[0]=t.price,Ft.ZXFUEL[0]=t.tax[0].taxPrice,Ft.BACK_ZX_FULE[0]=t.tax[0].taxPrice),Ft.ZXTAX=t.tax[1].taxPrice,Ft.BACK_ZXTAX=t.tax[1].taxPrice,i=0):t.type=="CNN"?(Ft.ZX_PRICE[1]=t.price,Ft.BACK_ZX_PRICE[1]=t.price,Ft.ZXFUEL[1]=t.tax[0].taxPrice,Ft.BACK_ZX_FULE[1]=t.tax[0].taxPrice,i=1):t.type=="INF"?(Ft.ZX_PRICE[2]=t.price,Ft.BACK_ZX_PRICE[2]=t.price,Ft.ZXFUEL[2]=t.tax[0].taxPrice,Ft.BACK_ZX_FULE[2]=t.tax[0].taxPrice,i=2):t.type=="JCP"?(Ft.ZX_PRICE[0]=t.price,Ft.audltPrice=t.price,Ft.BACK_ZX_PRICE[0]=t.price,Ft.ZXFUEL[0]=t.tax[0].taxPrice,Ft.BACK_ZX_FULE[0]=t.tax[0].taxPrice,r=!1,i=0):t.type=="GMP"&&(Ft.ZX_PRICE[0]=t.price,Ft.audltPrice=t.price,Ft.BACK_ZX_PRICE[0]=t.price,Ft.ZXFUEL[0]=t.tax[0].taxPrice,Ft.BACK_ZX_FULE[0]=t.tax[0].taxPrice,r=!1,i=0);for(var n=0,s=Ft.ZX_FARABASIS.length;n<s;n++)Ft.ZX_FARABASIS[n][i]=Ft.ZX_FARABASIS[n][e],Ft.ZX_FAREREFERENCE[n][i]=Ft.ZX_FAREREFERENCE[n][e]})}},error:function(){return}});if(undefined!=s&&s.length>0){var l=s.length,c=s[l-1],h=ZX_PRICE_QUERY_PATAM.concat(),p={};p.depresBookDesigCode=h[0].resBookDesigCode,p.arrresBookDesigCode=h[1].resBookDesigCode,p.zx_excessTicketCount=Ft.zx_excessTicketCount,h[0].resBookDesigCode=c.substring(0,1),h[1].resBookDesigCode=c.substring(0,1),Ft.zx_excessTicketCount=c.split("|")[1].split(","),e.ajax({type:"POST",url:"/B2C40/query/jaxb/roundtrip/getPrice.ao?times=2&uuid="+uuid,data:{json:o.appendArray(h)},async:!1,success:function(t){if(t.fareBasisInfo){var n=t.fareBasisInfo;Ft.KQT_FARABASIS=n.fareBasis?n.fareBasis:undefined,Ft.KQT_FAREREFERENCE=n.fareReference?n.fareReference:undefined,Ft.KQT_frResultList=t.frResultList?t.frResultList:undefined;if(n.roundTripPrice&&n.fareBasis&&n.fareReference&&t.frResultList&&n.roundTripPrice.length>1){a=1;var r=!0,i=0;e.each(n.roundTripPrice,function(e,t){t.type=="ADT"?(r&&(Ft.kqtaudltPrice=t.price,Ft.KQT_PRICE[0]=t.price,Ft.KQTFUEL[0]=t.tax[0].taxPrice),Ft.KQTTAX=t.tax[1].taxPrice,i=0):t.type=="CNN"?(Ft.KQT_PRICE[1]=t.price,Ft.KQTFUEL[1]=t.tax[0].taxPrice,i=1):t.type=="INF"?(Ft.KQT_PRICE[2]=t.price,Ft.KQTFUEL[2]=t.tax[0].taxPrice,i=2):t.type=="JCP"?(Ft.kqtaudltPrice=t.price,Ft.KQT_PRICE[0]=t.price,Ft.KQTFUEL[0]=t.tax[0].taxPrice,r=!1,i=0):t.type=="GMP"&&(Ft.kqtaudltPrice=t.price,Ft.KQT_PRICE[0]=t.price,Ft.KQTFUEL[0]=t.tax[0].taxPrice,r=!1,i=0);for(var n=0,s=Ft.KQT_FARABASIS.length;n<s;n++)Ft.KQT_FARABASIS[n][i]=Ft.KQT_FARABASIS[n][e],Ft.KQT_FAREREFERENCE[n][i]=Ft.KQT_FAREREFERENCE[n][e]})}else Ft.KQT=!1}else Ft.KQT=!1}})}Ft.zxaudltPrice=Ft.audltPrice;if(f==0&&a==0){h[0].resBookDesigCode=p.depresBookDesigCode,h[1].resBookDesigCode=p.arrresBookDesigCode,Ft.zx_excessTicketCount=p.zx_excessTicketCount;return}if(f==0&&Ft.ZX_PRICE.length<=0&&Ft.KQT_PRICE.length>0&&a==1)Ft.ZX_PRICE=Ft.KQT_PRICE,Ft.zxaudltPrice=Ft.kqtaudltPrice,Ft.KQT=!0,Ft.ZXTAX=Ft.KQTTAX,Ft.ZXFUEL=Ft.KQTFUEL,Ft.ZX_FARABASIS=Ft.KQT_FARABASIS,Ft.ZX_FAREREFERENCE=Ft.KQT_FAREREFERENCE,Ft.ZX_frResultList=Ft.KQT_frResultList;else if(f==1&&Ft.ZX_PRICE.length>0&&Ft.KQT_PRICE.length>0&&a==1){var d=parseInt(Ft.KQT_PRICE[0]),v=parseInt(Ft.BACK_ZX_PRICE[0]);d<v&&(Ft.KQT=!0,Ft.zxaudltPrice=Ft.kqtaudltPrice,Ft.ZX_PRICE=Ft.KQT_PRICE,Ft.ZXFUEL=Ft.KQTFUEL,Ft.ZXTAX=Ft.KQTTAX,Ft.ZX_FARABASIS=Ft.KQT_FARABASIS,Ft.ZX_FAREREFERENCE=Ft.KQT_FAREREFERENCE,Ft.ZX_frResultList=Ft.KQT_frResultList,excessTicketCount.info=Ft.zx_excessTicketCount)}else h[0].resBookDesigCode=p.depresBookDesigCode,h[1].resBookDesigCode=p.arrresBookDesigCode,Ft.zx_excessTicketCount=p.zx_excessTicketCount;Ft.ZXFUEL[1]||(Ft.ZXFUEL[1]=0),Ft.ZXFUEL[2]||(Ft.ZXFUEL[2]=0),Ft.ZX_PRICE[1]||(Ft.ZX_PRICE[1]=0),Ft.ZX_PRICE[2]||(Ft.ZX_PRICE[2]=0),Ft.ZX_channelrule=Ft.getchannelrule(Ft.ZX_frResultList[0]),Ft.setZxPriceBox(),Ft.ischangeShow()},getchannelrule:function(e){if(e){var t=null,n=flightData.segments[0].firstflight,i={depcity:n.depcity+"-"+n.arrcity,arrcity:n.arrcity+"-"+n.depcity,change:Ft.analysisrule(e.changeCharge.split("之后"),Number(Ft.ZX_PRICE[0])/2),refund:Ft.analysisrule(e.refundCharge.split("之后"),Ft.ZX_PRICE[0]),sign:r.flight.fl0025};return i}return!1},analysisrule:function(e,t){if(!e instanceof Array)return!1;var n=r.flight;if(e[0]==="静态维护"||!e[0])e[0]=n.fl0027,e[1]=n.fl0027;else if(e[1]==="静态维护"||!e[1])e[0]=n.fl0027,e[1]=n.fl0027;else for(var i=0;i<e.length;i++)e[i].indexOf("免费")>-1?e[i]=n.fl0028:/\d+%/.test(e[i])?(e[i]=Math.round(Number(e[i].match(/\d+%/)[0].replace("%",""))/100*Number(t)),e[i]="&yen;"+e[i]+n.fl0044):e[i].indexOf("不得退票")>-1?e[i]="&yen;"+t+n.fl0044:e[i].indexOf("不得变更")>-1?e[i]=n.fl0030:e[i]=n.fl0027;return e},ischangeShow:function(){var t=e("#zxprice_box");if(t.length>0&&Ft.hasOwnProperty("KQT_PRICE")&&Ft.hasOwnProperty("BACK_ZX_PRICE")&&Ft.KQT_PRICE.length>1&&Ft.BACK_ZX_PRICE.length>1){var n=parseInt(Ft.KQT_PRICE[0]),r=parseInt(Ft.BACK_ZX_PRICE[0]);g[1]>0&&(n+=Ft.KQT_PRICE[1],r+=Ft.BACK_ZX_PRICE[1]),g[2]>0&&(n+=Ft.KQT_PRICE[2],r+=Ft.BACK_ZX_PRICE[2]);if(n<=r)t.show();else{t.hide();var i=t.find(".coupon-checkbox");i.hasClass("coupon-checked")&&i.click()}}},countPrice:function(){var t=et(),n=g[0]*Ft.ZX_PRICE[0]+g[1]*Ft.ZX_PRICE[1]+g[2]*Ft.ZX_PRICE[2],r=g[0]*Ft.OLD_PRICE[0]+g[1]*Ft.OLD_PRICE[1]+g[2]*Ft.OLD_PRICE[2],i=g[0]*Ft.ZXFUEL[0]+g[1]*Ft.ZXFUEL[1]+g[2]*Ft.ZXFUEL[2],s=g[0]*FUEL[0]+g[1]*FUEL[1]+g[2]*FUEL[2],o=Ft.ZXTAX*g[0],u=TAX*g[0],a=t.insuraceTotal,f=0,l;g[0]?(f=n+i+o+a,l=r+s+u+a):f=0,this.zxTotalPrice=f,this.totalPrice=l,this.changedom(e("#zxprice_box .coupon-checkbox").hasClass("coupon-checked"))},eqPrice:function(e){return e<1?parseInt(this.ZX_PRICE[e]+this.ZXFUEL[e]+this.ZXTAX)<parseInt(this.OLD_PRICE[e]+FUEL[e]+TAX):parseInt(this.ZX_PRICE[e]+this.ZXFUEL[e])<parseInt(this.OLD_PRICE[e]+FUEL[e])},changedom:function(t){e("#price-total").find("i").remove(),t?e("#price-total").addClass("zxpricetotal").find("span").html("¥"+parseInt(Ft.totalPrice)).before("<i>¥"+parseInt(Ft.zxTotalPrice)+"</i>"):e("#price-total").removeClass("zxpricetotal").find("span").html("¥"+parseInt(Ft.totalPrice)),e("#zxprice_box .sellzxprice").html(parseInt(Ft.ZX_PRICE[0]))},checkexcessTicket:function(){var t=nt()-g[2],n=excessTicketCount.info,r=n[0].substring(n[0].length-1,n[0].length),i=n[1]?n[1].substring(n[1].length-1,n[0].length):undefined,s=!1;return i?r>i||r===i?excessTicketCount.excessNum=parseInt(i):excessTicketCount.excessNum=parseInt(r):excessTicketCount.excessNum=parseInt(r),excessTicketCount.excessNum<t?ISKQT?o.showAlertBox(p.psg531):o.showAlertBox(p.psg321):s=!0,e("DIV.tip-redsimple ").remove(),s},setZxPriceBox:function(){var t=e("#zxprice_box");if(this.ZX_PRICE.length>0&&this.eqPrice(0)){t.html(s.zxprice_box),this.countPrice(),this.changedom(!1);if(Ft.ZX_channelrule){var n=s.zxprice(Ft.ZX_channelrule);e("#zxprice_box .channelrule").poshytip({content:n,className:"tip-bluesimple2",alignTo:"target",alignX:"inner-right",offsetY:-5,offsetX:-30})}else e("#zxprice_box .channelrule").hide();e("#zxprice_box").find(".coupon-checkbox").on("click",function(){var t=e(this),n=e("#zxPrice"),i=e("#passenger-list > li"),u=!1,a=!1,f=null,l=null;if(t.hasClass("coupon-checked")){var c=Ft.OLD_PRICEARR;f=c[0][1]&&c[1][1],l=c[0][2]&&c[1][2]}else f=Ft.ZX_PRICE[1],l=Ft.ZX_PRICE[2];for(var h=0,d=i.length;h<d;h++)i.eq(h).attr("data-type")==1&&(u=!0),i.eq(h).attr("data-type")==2&&(a=!0);if(a)return o.alertBox(p.psg600,r.login.login32),!1;if(!S.child&&!f&&u)return o.alertBox(p.psg351.replace(/\{0\}/g,N[1]),p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),!1;if(!S.infant&&!l&&a)return o.alertBox(p.psg351.replace(/\{0\}/g,N[2]),p.psg352,p.psg353,!0,function(){var e=r.lang==="zh"?"cn":"en";location.href=location.protocol+"//www.csair.com/"+e+"/"}),!1;t.toggleClass("coupon-checked"),e("#disusealbediv").remove(),e("#disusealbediv2").remove();var v=t.hasClass("coupon-checked");n.attr("checked",v);if(v){e("#newupgrade-block").addClass("hide"),e("#newupgradeshow").append('<div id="disusealbediv" data-type="unnewupgrade"></div>'),e("#coupon-box .coupon-checkbox").removeClass("coupon-checked"),e("#coupon-block").addClass("hide"),e("#comconpunbox").addClass("hide"),e("#mer_coupon").append('<div id="disusealbediv2" data-type="unnewupgrade2"></div>'),e("#disusealbediv").poshytip({content:s[e("#disusealbediv").data("type")],className:"inter-tip-bluesimple",alignTo:"target",alignX:"inner-left",offsetY:-5,offsetX:-10}),e("#disusealbediv2").poshytip({content:s[e("#disusealbediv2").data("type")],className:"inter-tip-bluesimple",alignTo:"target",alignX:"inner-left",offsetY:-5,offsetX:-10});if(vippsgid.length>0&&vipinputval.length>0&&e("#isdiscount").css("display")!=="none"){var m=0;e.grep(olddataflight,function(e,t){m=Number(e.segOrder),flightData.segments[m].firstflight.price[0]=e.adult,flightData.segments[m].firstflight.farereference[0]=e.fareReference,flightData.segments[m].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]+=discountvalue}e("#isnondiscount").hide(),e("#isdiscount").hide(),flightData.segments[0].firstflight.cabinname=ZX_PRICE_QUERY_PATAM[0].resBookDesigCode,flightData.segments[1].firstflight.cabinname=ZX_PRICE_QUERY_PATAM[1].resBookDesigCode;var y=[Ft.ZXFUEL[0]*.5,Ft.ZXFUEL[1]*.5,Ft.ZXFUEL[2]*.5];flightData.segments[0].firstflight.fuel=y,flightData.segments[1].firstflight.fuel=y,flightData.segments[1].firstflight.tax=Ft.ZXTAX*.5,flightData.segments[0].firstflight.price=Ft.ZX_PRICE,flightData.segments[1].firstflight.price=[0,0,0],Ft.ZX_PRICE[1]?S.child=!1:S.child=!0,Ft.ZX_PRICE[2]?S.infant=!1:S.infant=!0,flightData.segments[0].firstflight.productType="LHCYH",flightData.segments[1].firstflight.productType="LHCYH",Ft.ZX_FARABASIS[0].splice(3),Ft.ZX_FAREREFERENCE[0].splice(3),flightData.segments[0].firstflight.farebasis=Ft.ZX_FARABASIS[0],flightData.segments[0].firstflight.farereference=Ft.ZX_FAREREFERENCE[0],Ft.ZX_FARABASIS[1]&&Ft.ZX_FARABASIS[1].splice(3),Ft.ZX_FAREREFERENCE[1]&&Ft.ZX_FAREREFERENCE[1].splice(3),flightData.segments[1].firstflight.farebasis=Ft.ZX_FARABASIS.length>1?Ft.ZX_FARABASIS[1]:Ft.ZX_FARABASIS[0],flightData.segments[1].firstflight.farereference=Ft.ZX_FARABASIS.length>1?Ft.ZX_FAREREFERENCE[1]:Ft.ZX_FAREREFERENCE[0],BEGINPRICE=Ft.ZX_PRICE,PRICE=Ft.ZX_PRICE,PRICE[0]=Ft.zxaudltPrice,TAX=Ft.ZXTAX,FUEL=Ft.ZXFUEL,ISKQT=Ft.KQT,e("#conpunshow .flightprice").each(function(){e(this).removeClass("checked").addClass("unzxselect").find(".conpunopc").html(p.psg343),t.hasClass("checked")&&t.removeClass("checked")}),Ft.checkexcessTicket()}else{BEGINPRICE=Ft.OLD_PRICE,PRICE=Ft.OLD_PRICE,PRICE[0]=Ft.oldaudltPrice,TAX=parseInt(J(Ft.OLDTAX)),FUEL=Ft.OLDFUELCount,ISKQT=!1;var b=Ft.OLD_CABIN;flightData.segments[0].firstflight.cabinname=b[0],flightData.segments[1].firstflight.cabinname=b[1],flightData.segments[0].firstflight.fuel=Ft.OLDFUEL[0],flightData.segments[1].firstflight.fuel=Ft.OLDFUEL[1],flightData.segments[0].firstflight.tax=Ft.OLDTAX[0],flightData.segments[1].firstflight.tax=Ft.OLDTAX[1],flightData.segments[0].firstflight.price=Ft.OLD_PRICEARR[0],flightData.segments[1].firstflight.price=Ft.OLD_PRICEARR[1],!Ft.OLD_PRICEARR[0][1]||!Ft.OLD_PRICEARR[1][1]?S.child=!0:S.child=!1,!Ft.OLD_PRICEARR[0][2]||!Ft.OLD_PRICEARR[1][2]?S.infant=!0:S.infant=!1,flightData.segments[0].firstflight.productType="",flightData.segments[1].firstflight.productType="",flightData.segments[0].firstflight.farebasis=Ft.OLD_FARABASIS[0],flightData.segments[1].firstflight.farebasis=Ft.OLD_FARABASIS[1],flightData.segments[0].firstflight.farereference=Ft.OLD_FAREREFERENCE[0],flightData.segments[1].firstflight.farereference=Ft.OLD_FAREREFERENCE[1],excessTicketCount.info=Ft.OLDSEAT;if(vippsgid.length>0&&vipinputval.length>0){var m=0;e.grep(newdataflight,function(e,t){m=Number(e.segOrder),flightData.segments[m].firstflight.price[0]=e.adult,flightData.segments[m].firstflight.farereference[0]=e.fareReference,flightData.segments[m].firstflight.farebasis[0]=e.owFareBasis}),PRICE[0]-=discountvalue,BEGINPRICE.length>0&&BEGINPRICE[0]&&(BEGINPRICE[0]=PRICE[0]),e("#isnondiscount").hide(),e("#isdiscount").show()}else e("#isnondiscount").show(),e("#isdiscount").hide();e("#conpunshow .flightprice").removeClass("unzxselect").find(".conpunopc").html("")}tt(g)})}}},It=function(t,n){var r=!1;e.ajax({url:"/B2C40/query/jaxb/userinfo/ismissing/isMember.ao",data:{userId:t},dataType:"json",type:"post",success:function(e){r=e.message,typeof n=="function"?n(r):n}})},qt=function(){e("body").unbind("QQuserLogged").bind("QQuserLogged",function(){var e={client_id:"101195994",url:"https://graph.qq.com/oauth2.0/authorize",name:"QQ",scope:"get_user_info"}}),e("body").unbind("WXuserLogged").bind("WXuserLogged",function(){var e={client_id:"wxb84b459d0ef05bf6",url:"https://open.weixin.qq.com/connect/qrconnect",name:"WX",scope:"snsapi_login"}})},Rt=function(){document.domain="csair.com",e("#protocolBox a").bind("click",function(t){t.preventDefault();var n=e(this),r=e(s.kownandrule({href:n.attr("href"),title:n.html().replace(/\《|\》/g,"")}));r.addClass("loading").on("click",".krclosed,.krsubmit",function(){e(this).closest(".knowandrulebox").remove()}),e("body").append(r);var i=e("#knowandrule");i.load(function(){var e=window.location.href.indexOf("b2c.csair.com")>0?"b2c.csair.com":"ec.test.csair.com";e=location.protocol+"//"+e,i.contents().find("head").append('<link type="text/css" rel="stylesheet" href="'+e+'/B2C40/static/main/css/knowandrule.css">');var t=i.contents().find(".check-in-list");n.data("show")&&(t.closest(".form-title").show(),t.on("click","li",function(){i.css({visibility:"hidden"}).closest(".knowandrulebox").addClass("loading")})),i.css({visibility:"visible"}).closest(".knowandrulebox").removeClass("loading")})})},Ut=function(t){var n=o.user.INFO,t=t||0,r=!0,i=e("#passenger-list .p-idType-sel").eq(t),s=i.data("options"),u=s.find(".option").clone(!0),a=e("#passenger-list .psg-name-input").eq(t),f=e("#passenger-list .psg-idType-input").eq(t);s.html(""),n.niid&&(e(u[0]).data("num",n.niid).appendTo(s),r&&a.val(n.userName||""),r&&f.val(n.niid),r=!1),n.ppid&&(e(u[1]).data("num",n.ppid).appendTo(s),r&&a.val(n.userEnName||""),r&&f.val(n.ppid),r=!1),n.otherid&&(e(u[2]).data("num",n.otherid).appendTo(s),r&&a.val(n.userName||n.userEnName||""),r&&f.val(n.otherid),r=!1),r?s.html(u):f.attr("disabled","disabled"),!n.niid&&i.data("options").find(".option").eq(0).click()},zt=function(){_t(),uuid=o.getSearch().id;var t=mt(uuid);if(t){H=at(),Q(),j=H==="nologin"?!0:!1,P?(e("#common-passengers").remove(),at()):(Et(),yt(H)),gt();var n=s.insurance_tpl({insuranceList:insurance.showList,pType:"0",psgId:"psg00000000",lang:r.lang});e("#passenger-block .psg-insurance").eq(0).html(n),Nt(),R=Y('["discountFlag"]');var i=!1;if(R.discountFlag.success){var u=R.discountFlag.result;u==="Y"&&(i=!0)}j&&(e(".psg-topTxt").show().html(p.psg542).find("a").attr("href","/B2C40/modules/bookingnew/manage/login.html?returnUrl="+location.href),e("#psg-bindMes").show().html(p.psg543)),i&&!codeshareFlag&&zzflag!==1&&!isnocz&&!D&&(!_||e.csairpreUrl(M)||ispreUrlsol)&&!j&&!isNaddN&&Ot.init(),!codeshareFlag&&zzflag!==1&&!isnocz&&!D&&!_&&!ispreUrlsol&&(Mt.init(),Mt.isbool=!0),b.contactor={},e("#contact-block").on("change",".input",function(){rt.call(e(this))}),segtype.toUpperCase()==="R"&&zzflag===0&&!isnocz&&!P&&!e.csairpreUrl(M)&&e.isReturnDiscount&&iszxPricebool&&Ft.getPrice(),e("#passenger-main").find(".helper-trigger").each(function(){if(e(this).data("type")==="insurance"||e(this).data("type")==="insurance_refund"){var t=e(this).data("index"),n=r.lang==="zh"?insurance.showList[t].detailDescUrlZH:insurance.showList[t].detailDescUrlEN;e(this).poshytip({content:s[e(this).data("type")]({url:n}),className:"tip-bluesimple2",alignTo:"target",alignX:"inner-right",offsetY:0,offsetX:-125})}else e(this).data("type")!=="coupon"&&e(this).data("type")!=="newupgrade"&&e(this).data("type")!=="zxprice"&&o.showtip(e(this),s[e(this).data("type")],"center","top")}),e("#alert_box").find("button").on("click",function(){e("#alert_box").addClass("hide")}).end().find(".close-w").on("click",function(){e("#alert_box").addClass("hide")}),e("body").unbind("userLogged").bind("userLogged",function(){o.user.INFO.userType==="1"&&(e("#login-dialog").addClass("hide"),P?(e("#common-passengers").remove(),at()):Et())}),e("#passenger-block").find(".input").val(""),e("#loadding_frame").attr("src",r.flight.fl0105),e("#contact-moblie").on("change",function(){var t=e(this).data("mobile")}),Rt(),new h({targetCls:"#email",parentCls:"."+e("#email").parent().attr("class"),inputValColor:"emailFont"}),e("#submitForm").on("click",function(){if(!e("#protocol-checkbox").hasClass("checked")){o.showAlertBox(p.psg328);return}if(P&&!ot())return!1;e("#passenger-block,#contact-block").find(".input").addClass("checkedInput").trigger("change"),e("#passenger-block").find(".psg-carry").each(function(){var t=e(this).closest(".psg-carryBy"),n=e(this).find(".psgs-carryByName").text();t.hasClass("show")&&n===""&&o.settip.call(e(this),p.psg329)});if(e("#passenger-block .error").length){o.showAlertBox(p.psg330);return}if(e("#contact-block .error").length){o.showAlertBox(p.psg330);return}if(!Ft.checkexcessTicket())return;j?ispreUrlsol?o.alertBox(p.psg068,p.psg227,p.psg353,!0,function(){jt()}):jt():(o.user.checklogined()?e("body").one("userChecked",function(){o.user.logged||ft()}):o.user.logged||ft(),o.user.INFO&&o.user.logged?ispreUrlsol?o.alertBox(p.psg068,p.psg227,p.psg353,!0,function(){jt()}):jt():(e("#login-dialog").removeClass("hide"),e("body").unbind("userLogged").bind("userLogged",function(){e("#login-dialog").addClass("hide"),ispreUrlsol?o.alertBox(p.psg068,p.psg227,p.psg353,!0,function(){jt()}):jt()})))}),o.user.INFO.userType!="1"&&o.user.INFO.userType!="2"&&(e(".refund-insurance").addClass("hide"),e(".refund-insurance").find("input[type=checkbox]").prop("checked",!1));var a=function(){e("#common-passengers").length!=0&&!wt&&setTimeout(a,100)};a(),P&&Ut()}},Wt=function(){try{var t=o.user.INFO.userId==undefined?"UNL":o.user.INFO.userId,n=JSON.parse(decodeURI(e.cookie("psgInfos")));if(n){if(n.userId!=t){e.cookie("psgInfos",null);return}e("#contact_name").val(n.contactInfo.name),e("#contact-moblie").val(n.contactInfo.phonehide),e("#contact-moblie").attr("mobile",n.contactInfo.phone),e(".psg-block[data-type=0]").each(function(t){Xt(e(this),"0",n.psgList,t)}),e(".psg-block[data-type=1]").each(function(t){Xt(e(this),"1",n.psgList,t)}),e(".psg-block[data-type=2]").each(function(t){Xt(e(this),"2",n.psgList,t)})}}catch(r){}},Xt=function(t,n,i,s){try{if(i[n][s]){var o=i[n][s];if(o==undefined)return;var u=t;o.id.indexOf("comm")>-1?(e("#"+o.id).trigger("click"),u=e(".psg-block[id="+o.id+"]")):(r.lang=="en"?u.find(".psg-name-input").eq(0).val(o.name):u.find(".p-name").eq(0).val(o.name),u.find(".p-idType-sel").data("options").find(".option[data-value="+o.cardType+"]").trigger("click"),u.find(".psg-idType-input").eq(0).val(o.cardId),u.find(".psg-birthday-input").eq(0).val(o.birthday)),u.find(".psgs-carryByName").eq(0).length>0&&u.find(".psgs-carryByName").eq(0).text(o.babyCarryBy),u.find(".check-box-icon").each(function(){var t=o["insuranc_"+e(this).attr("data-value")]!=undefined?o["insuranc_"+e(this).attr("data-value")]:!1;(t&&!e(this).prop("checked")||!t&&e(this).prop("checked"))&&e(this).trigger("click")})}}catch(a){}},Vt=function(){try{var t=o.user.INFO.userId==undefined?"UNL":o.user.INFO.userId,n=e("#contact-moblie").attr("mobile"),i={psgList:{0:[],1:[],2:[]},userId:t,contactInfo:{name:e("#contact_name").val(),phone:n,phonehide:n.replace(/(\d{3})(\d{4})(\d{4})/,n.substr(0,3)+"****"+n.substr(7,4))}},s={};e(".psg-block").each(function(){s={},s.id=e(this).attr("id"),s.type=e(this).attr("data-type"),r.lang=="en"?s.name=e(this).find(".psg-name-input").eq(0).val():s.name=e(this).find(".p-name").eq(0).val(),s.cardType=b[s.id].pIdType,s.cardId=e(this).find(".psg-idType-input").eq(0).val(),s.birthday=e(this).find(".psg-birthday-input").eq(0).val(),s.babyCarryBy=e(this).find(".psgs-carryByName").eq(0).text(),e(this).find(".check-box-icon").each(function(){s["insuranc_"+e(this).attr("data-value")]=e(this).prop("checked")}),i.psgList[s.type].push(s)}),e.cookie("psgInfos",encodeURI(JSON.stringify(i)))}catch(u){}};zt()})()}),define("main/modules/passenger/passenger",function(){}),define("searchBox",["require","exports","module","jquery","app","lang","UI"],function(e,t,n){var r=e("jquery"),i=e("app"),s=e("lang");e("UI");var o=s.flight;n.exports=function(){var e=/(flightSelectDirect.html|mileage.html|flightSelectDirectold.html)/.test(location.href)?!0:!1,t=location.pathname,n=null,s=window.location.href.indexOf("jCountry")>0&&window.location.href.indexOf("mileage")>0,u=s?r.csairUrl().b2cUrl+"/B2C40/modules/bookingnew/mileage/search.html?jCountry=us":r.csairUrl().hostUrl+"/";if(e)n=i.getSearch();else{n=i.getSearch(),/\/ow\//.test(t)?n.t="S":/\/rt\//.test(t)?n.t="R":/\/mo\//.test(t)?n.t="M":i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});if(/\/(\-?[a-zA-Z]{3}\-[a-zA-Z]{3})+\.html$/.test(t)){var a=t.split("/");a=a[a.length-1].replace(".html",""),a=a.split("-"),n.t=n.t==="M"&&a.length===2?"S":n.t;if(n.t==="S"||n.t==="R"){n.c1=a[0].toUpperCase(),n.c2=a[1].toUpperCase();var f=n.d;if(f)f=f.split("|"),n.d1=f[0].replace(/^(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3"),n.t==="R"&&(f[1]?n.d2=f[1].replace(/^(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3"):n.d2=i.getDateString(i.getDateWith(f[0],"+3d")));else{var l=i.getDateString(new Date);l=i.getDateString(i.getDateWith(l,"+1d")),n.d1=l,n.t==="R"&&(n.d2=i.getDateString(i.getDateWith(l,"+3d")))}}else if(a.length>=4&&a.length%2===0&&a.length<=10){var c=Number(a.length/2),h="",p=0,f=n.d;if(f&&f[0]){f=f.split("|");var d=null;for(var v=0;v<c;v++)h+=v===0?"":"|",d=f[v]?f[v]:i.getDateString(i.getDateWith(f[v-1],"+3d")).replace(/-/g,""),a[p++]+":"+a[p++]+":"+d;n.fl=h}else{var l=i.getDateString(new Date),d=i.getDateString(i.getDateWith(l,"+1d")).replace(/-/g,"");for(var v=0;v<c;v++)h+=v===0?"":"|",a[p++]+":"+a[p++]+":"+d,d=i.getDateString(i.getDateWith(d,"+3d")).replace(/-/g,"");n.fl=h}}else i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});if(n.n){var m=n.n.split("");n.at=Number(m[0])>0?m[0]:1,n.ct=Number(m[1])>=0?m[1]:0,n.it=Number(m[2])>=0?m[2]:0}else n.at=1,n.ct=0,n.it=0}else i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1})}var g=r.cookie("userType4logCookie");if(n&&n.t==="M")if(n.fl&&/^([A-Z]{3}\:[A-Z]{3}\:\d{8}\|?)+$/.exec(decodeURIComponent(n.fl))&&/^\d{1}$/.exec(n.at)&&/^\d{1}$/.exec(n.ct)&&/^\d{1}$/.exec(n.it)){var y=decodeURIComponent(n.fl).split("|");i.checkNumformat(n.at,n.ct,n.it)||i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});if(y&&y.length>=2&&y.length<=5){n.num=y.length;var b="",w="",E="",S=1;for(var v=0;v<y.length;v++){var x=y[v].split(":"),p=v+1;n["d"+p]=i.getDate(x[2]),n["c"+p]=x[0]+"-"+x[1],w=UI.getCityName(x[0]),E=UI.getCityName(x[1]),(!w||!E)&&i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});if(!UI.getCityGrp(x[0])||!UI.getCityGrp(x[1]))S=2;S>1&&g=="E2"&&i.AlertMsgBox(o.fl0111,function(){return window.location.href=u,!1});var T=i.getDateString(new Date);(!i.checkDateObj(n["d"+p])||n["d"+p]<T||v!==0&&n["d"+v]>n["d"+p])&&i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1}),n["n"+p]=w+"-"+E,b+=":WT.al_orgcity"+p+"("+x[0]+")",b+="WT.al_dstcity"+p+"("+x[1]+")",b+="WT.al_orgdate"+p+"("+i.getDate(x[2])+")"}r.cookie("WT.al_flight","WT.al_hctype("+n.t+"):"+"WT.al_adultnum("+n.at+"):"+"WT.al_childnum("+n.ct+"):"+"WT.al_infantnum("+n.it+")"+b,{domain:"csair.com",path:"/"}),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.targeturl",t,!1)}else i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1})}else i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});else if(!n||n.t!=="R"&&n.t!=="S")i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});else{var N=n.c1,C=n.c2,k=UI.getCityName(n.c1),L=UI.getCityName(n.c2);n.c1=N+"-"+C,n.n1=k+"-"+L,n.num=1,(!k||!L)&&i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});var S=1;if(!UI.getCityGrp(N)||!UI.getCityGrp(C))S=2;S>1&&g=="E2"&&i.AlertMsgBox(o.fl0111,function(){return window.location.href=u,!1});if(!(/^[A-Z]{3}$/.exec(N)&&/^[A-Z]{3}$/.exec(C)&&/^\d{4}\-\d{2}\-\d{2}$/.exec(n.d1)&&/^\d{1}$/.exec(n.at)&&/^\d{1}$/.exec(n.ct)&&/^\d{1}$/.exec(n.it)))return i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1}),!1;i.checkNumformat(n.at,n.ct,n.it)||i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1});var T=i.getDateString(new Date);(!i.checkDateObj(n.d1)||n.d2&&!i.checkDateObj(n.d2)||n.d1<T||n.d1>n.d2)&&i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1}),n.t==="R"&&(n.d2||i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1})),n.t==="R"&&!!n.d2&&(/^\d{4}\-\d{2}\-\d{2}$/.exec(n.d2)?(n.d2=n.d2,n.c2=C+"-"+N,n.n2=L+"-"+k,n.num=2):i.AlertMsgBox(o.fl0070,function(){return window.location.href=u,!1}));var b=n.d2?"WT.al_orgdate2("+n.d2+")":"";r.cookie("WT.al_flight","WT.al_hctype("+n.t+"):"+"WT.al_adultnum("+n.at+"):"+"WT.al_childnum("+n.ct+"):"+"WT.al_infantnum("+n.it+"):"+"WT.al_orgcity1("+n.c1.split("-")[0]+"):"+"WT.al_dstcity1("+n.c1.split("-")[1]+"):"+"WT.al_orgdate1("+n.d1+")"+b,{domain:"csair.com",path:"/"}),typeof dcsPageTrack=="function"&&dcsPageTrack("WT.targeturl",t,!1)}return n}});